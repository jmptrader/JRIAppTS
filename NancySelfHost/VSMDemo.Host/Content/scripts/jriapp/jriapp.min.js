var RIAPP;(function(a){a=a.consts||(a.consts={});a.DATA_ATTR={EL_VIEW_KEY:"data-elvwkey",DATA_BIND:"data-bind",DATA_VIEW:"data-view",DATA_EVENT_SCOPE:"data-scope",DATA_ITEM_KEY:"data-key",DATA_CONTENT:"data-content",DATA_COLUMN:"data-column",DATA_NAME:"data-name",DATA_FORM:"data-form"};a.ELVIEW_NM={DATAFORM:"dataform"};a.LOADER_GIF={SMALL:"loader2.gif",NORMAL:"loader.gif"}})(RIAPP||(RIAPP={}));
(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.utils||(a.utils={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.errors||(a.errors={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.converter||(a.converter={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.defaults||(a.defaults={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.parser||(a.parser={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.mvvm||(a.mvvm={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){};a._isElView=function(a){return!1}})(a.baseElView||(a.baseElView={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){};a._isBinding=function(a){return!1}})(a.binding||(a.binding={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){};a._isCollection=function(a){return!1};a._getItemByProp=function(a,c){return null}})(a.collection||(a.collection={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){};a._isTemplateElView=function(a){return!1}})(a.template||(a.template={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.baseContent||(a.baseContent={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){};a._setIsInsideTemplate=function(a){};a._isDataForm=function(a){return!1};a._isInsideDataForm=function(a){return!1};a._isInNestedForm=function(a,c,k){return!1};a._getParentDataForm=function(a,c){return null}})(a.dataform||(a.dataform={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.dynacontent||(a.dynacontent={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.datepicker||(a.datepicker={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.tabs||(a.tabs={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.listbox||(a.listbox={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.datadialog||(a.datadialog={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.datagrid||(a.datagrid={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.pager||(a.pager={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.stackpanel||(a.stackpanel={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));(function(a){(function(a){(function(a){a._isModuleLoaded=!1;a._initModule=function(a){}})(a.db||(a.db={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){var t=a.MOD.errors;(function(a){a[a.NONE=0]="NONE";a[a.NORMAL=1]="NORMAL";a[a.HIGH=2]="HIGH"})(a.DEBUG_LEVEL||(a.DEBUG_LEVEL={}));a.DebugLevel=a.DEBUG_LEVEL.NONE;a.startDebugger=function(){debugger};a.throwDummy=function(a){if(t._isModuleLoaded&&a&&!a.isDummy)throw t.DummyError.create(a);throw a;};a.checkIsDummy=function(a){return!!a&&!!a.isDummy};a.reThrow=function(c,p){if(p)a.throwDummy(c);else throw c;};var c=function(){function a(){}a.CreateList=function(){return{head:null,tail:null}};
a.CreateNode=function(a,c,g){return{fn:a,ns:c,next:null,context:g?g:null}};a.countNodes=function(a){if(!a)return 0;a=a.head;for(var c=0;a;)a=a.next,++c;return c};a.prependNode=function(a,c){c.next=a.head;a.head=c;a.tail||(a.tail=a.head)};a.appendNode=function(a,c){if(a.head){var g=a.tail;a.tail=c;g.next=c}else a.tail=c,a.head=c};a.removeNodes=function(a,c){if(!a)return null;for(var g=a.head,n=null,l,h=g,e=h?h.next:null;h;)"*"==c||h.ns==c?(l=h,h=n?n.next=e:g=e,e=h?h.next:null,l.next=null):(n=h,e=(h=
h.next)?h.next:null);a.head=g;a.tail=n?n:g};a.toArray=function(a){var c=[];if(!a)return c;for(a=a.head;a;)c.push(a),a=a.next;return c};return a}();a.ListHelper=c;c=function(){function a(){}a.clone=function(a){return 1===a.length?[a[0]]:Array.apply(null,a)};a.fromList=function(a){for(var c=Array(a.length),g=0,n=a.length;g<n;g++)c[g]=a[g];return c};a.fromCollection=function(c){return a.fromList(c)};a.distinct=function(a){var c={},g,n=a.length,l=[];for(g=0;g<n;g+=1)c[a[g]]=a[g];a=Object.keys(c);g=0;
for(n=a.length;g<n;g+=1)l.push(c[a[g]]);return l};return a}();a.ArrayHelper=c;c=function(){function c(){}c.getNewID=function(){var a=c._newID;c._newID+=1;return a};c.isNull=function(a){return null===a};c.isUndefined=function(a){return void 0===a};c.isNt=function(a){return null===a||void 0===a};c.isString=function(a){if(c.isNt(a))return!1;var k=/string/i;return"string"===typeof a?!0:"object"===typeof a?k.test(a.constructor.toString()):!1};c.isFunc=function(a){if(c.isNt(a))return!1;var k=/Function/;
return"function"===typeof a?k.test(a.constructor.toString()):!1};c.isBoolean=function(a){if(c.isNt(a))return!1;var k=/boolean/i;return"boolean"===typeof a?!0:"object"===typeof a?k.test(a.constructor.toString()):!1};c.isDate=function(a){if(c.isNt(a))return!1;var k=/date/i;return"date"===typeof a?!0:"object"===typeof a?k.test(a.constructor.toString()):!1};c.isNumber=function(a){if(c.isNt(a))return!1;var k=/Number/;return"number"===typeof a?!0:"object"===typeof a?k.test(a.constructor.toString()):!1};
c.isNumeric=function(a){return c.isNumber(a)||c.isString(a)&&!isNaN(Number(a))};c.endsWith=function(a,c){return a.substr(a.length-c.length)===c};c.startsWith=function(a,c){return a.substr(0,c.length)===c};c.fastTrim=function(a){return a.replace(/^\s+|\s+$/g,"")};c.trim=function(a,k){return k?c.ltrim(c.rtrim(a,k),k):c.fastTrim(a)};c.ltrim=function(a,c){return a.replace(new RegExp("^["+(c||"\\s")+"]+","g"),"")};c.rtrim=function(a,c){return a.replace(new RegExp("["+(c||"\\s")+"]+$","g"),"")};c.isArray=
function(a){return a?Array.isArray(a):!1};c.hasProp=function(a,k){if(!a)return!1;if(a.hasOwnProperty(k))return!0;if(Object===a)return!1;var g=Object.getPrototypeOf(a);return c.hasProp(g,k)};c.format=function(p){for(var k=[],g=1;g<arguments.length;g++)k[g-1]=arguments[g];for(var g="",n=0;;){var l=p.indexOf("{",n),h=p.indexOf("}",n);if(0>l&&0>h){g+=p.slice(n);break}if(0<h&&(h<l||0>l)){if("}"!==p.charAt(h+1))throw Error(c.format(a.ERRS.ERR_STRING_FORMAT_INVALID,p));g+=p.slice(n,h+1);n=h+2}else if(g+=
p.slice(n,l),n=l+1,"{"===p.charAt(n))g+="{",n++;else{if(0>h)throw Error(c.format(a.ERRS.ERR_STRING_FORMAT_INVALID,p));var l=p.substring(n,h),e=l.indexOf(":"),n=parseInt(0>e?l:l.substring(0,e),10);if(isNaN(n))throw Error(c.format(a.ERRS.ERR_STRING_FORMAT_INVALID,p));l=0>e?"":l.substring(e+1);n=k[n];if(void 0===n||null===n)n="";g=n.format?g+n.format(l):g+n.toString();n=h+1}}return g};c.setValue=function(c,k,g,n){var l=k.split("."),h;for(h=0;h<l.length-1;h+=1)c[l[h]]||(c[l[h]]={}),c=c[l[h]];l=l[l.length-
1];if(n&&void 0!==c[l])throw Error(a.baseUtils.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,k));c[l]=g};c.getValue=function(a,c){var g=c.split("."),n=a,l,h;for(l=0;l<g.length;l+=1){h=n[g[l]];if(void 0===h)return null;n=h}return h};c.removeValue=function(a,c){var g=c.split("."),n=a,l;l=null;for(l=0;l<g.length-1;l+=1){if(!n[g[l]])return null;n=n[g[l]]}g=g[g.length-1];l=n[g];void 0!==l&&delete n[g];return l};c.resolveOwner=function(a,c){var g=c.split("."),n,l,h=g.length;if(1==h)return a;l=a;for(n=0;n<h-
1;n+=1){l=l[g[n]];if(void 0===l)return;if(null===l)return null}return l};c._newID=0;return c}();a.baseUtils=c})(RIAPP||(RIAPP={}));
(function(a){var t=function(){function c(){this._isDestroyCalled=this._isDestroyed=!1;this._events=null}c.prototype._removeNsHandler=function(c,p){for(var k=Object.keys(c),g,n,l=0,h=k.length;l<h;++l)if(g=k[l],n=c[g])a.ListHelper.removeNodes(n,p),n.head||(c[g]=null)};c.prototype._getEventNames=function(){return["error","destroyed"]};c.prototype._addHandler=function(c,p,k,g,n){if(!this._isDestroyed){if(!a.baseUtils.isFunc(p))throw Error(a.ERRS.ERR_EVENT_INVALID_FUNC);if(!c)throw Error(a.baseUtils.format(a.ERRS.ERR_EVENT_INVALID,
c));null===this._events&&(this._events={});var l=this._events,h="*";k&&(h=""+k);k=l[c];p=a.ListHelper.CreateNode(p,h,g);k||(l[c]=k=a.ListHelper.CreateList());n?a.ListHelper.prependNode(k,p):a.ListHelper.appendNode(k,p)}};c.prototype._removeHandler=function(c,p){var k=this._events,g="*";if(k){p&&(g=""+p);var n;if(c){if(n=k[c])"*"==g?(a.ListHelper.removeNodes(n,g),k[c]=null):(a.ListHelper.removeNodes(n,g),n.head||(k[c]=null))}else this._removeNsHandler(k,g),"*"==g&&(this._events=null)}};c.prototype._raiseEvent=
function(c,p){var k=this._events;if(null!==k){if(void 0===k)throw Error("The object's instance is invalid. The object constructor has not been called!");if(c){"0*"!=c&&"0"==c.charAt(0)&&this._raiseEvent("0*",p);for(var k=a.ListHelper.toArray(k[c]),g,n=0;n<k.length;n++)g=k[n],g.fn.apply(g.context,[this,p])}}};c.prototype._checkEventName=function(c){var p=Object.getPrototypeOf(this),k;if(p.hasOwnProperty("__evMap"))k=p.__evMap;else{var g=this._getEventNames();k={};for(var n=0;n<g.length;n++)k[g[n]]=
!0;p.__evMap=k}if(!k[c])throw a.DebugLevel==a.DEBUG_LEVEL.HIGH&&a.startDebugger(),c=Error(a.baseUtils.format(a.ERRS.ERR_EVENT_INVALID,c)),this.handleError(c,this),c;};c.prototype._isHasProp=function(c){return a.baseUtils.hasProp(this,c)};c.prototype.handleError=function(c,p){if(a.global&&a.checkIsDummy(c))return!0;c.message||(c=Error(""+c));var k={error:c,source:p,isHandled:!1};this._raiseEvent("error",k);return k.isHandled};c.prototype.raisePropertyChanged=function(q){var p={property:q},k=q.split("."),
g=k[k.length-1];if(1<k.length){k=a.baseUtils.resolveOwner(this,q);if(a.DebugLevel>a.DEBUG_LEVEL.NONE&&a.baseUtils.isUndefined(k))throw a.DebugLevel==a.DEBUG_LEVEL.HIGH&&a.startDebugger(),Error(a.baseUtils.format(a.ERRS.ERR_PROP_NAME_INVALID,q));k instanceof c&&k.raiseEvent("0"+g,p)}else{if(a.DebugLevel>a.DEBUG_LEVEL.NONE&&!a.baseUtils.hasProp(this,g))throw a.DebugLevel==a.DEBUG_LEVEL.HIGH&&a.startDebugger(),Error(a.baseUtils.format(a.ERRS.ERR_PROP_NAME_INVALID,g));this.raiseEvent("0"+g,p)}};c.prototype.addHandler=
function(a,c,k,g,n){this._checkEventName(a);this._addHandler(a,c,k,g,n)};c.prototype.removeHandler=function(a,c){a&&this._checkEventName(a);this._removeHandler(a,c)};c.prototype.addOnDestroyed=function(a,c,k){this._addHandler("destroyed",a,c,k,!1)};c.prototype.removeOnDestroyed=function(a){this._removeHandler("destroyed",a)};c.prototype.addOnError=function(a,c,k){this._addHandler("error",a,c,k,!1)};c.prototype.removeOnError=function(a){this._removeHandler("error",a)};c.prototype.removeNSHandlers=
function(a){this._removeHandler(null,a)};c.prototype.raiseEvent=function(c,p){if(!c)throw Error(a.ERRS.ERR_EVENT_INVALID);"0"!=c.charAt(0)&&this._checkEventName(c);this._raiseEvent(c,p)};c.prototype.addOnPropertyChange=function(c,p,k,g){if(!c)throw Error(a.ERRS.ERR_PROP_NAME_EMPTY);if(a.DebugLevel>a.DEBUG_LEVEL.NONE&&"*"!=c&&!this._isHasProp(c))throw a.DebugLevel==a.DEBUG_LEVEL.HIGH&&a.startDebugger(),Error(a.baseUtils.format(a.ERRS.ERR_PROP_NAME_INVALID,c));this._addHandler("0"+c,p,k,g,!1)};c.prototype.removeOnPropertyChange=
function(c,p){if(c){if(a.DebugLevel>a.DEBUG_LEVEL.NONE&&"*"!=c&&!this._isHasProp(c))throw a.DebugLevel==a.DEBUG_LEVEL.HIGH&&a.startDebugger(),Error(a.baseUtils.format(a.ERRS.ERR_PROP_NAME_INVALID,c));c="0"+c}this._removeHandler(c,p)};c.prototype.getIsDestroyed=function(){return this._isDestroyed};c.prototype.getIsDestroyCalled=function(){return this._isDestroyCalled};c.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=this._isDestroyed=!0;try{this._raiseEvent("destroyed",{})}finally{this._removeHandler(null,
null)}}};return c}();a.BaseObject=t})(RIAPP||(RIAPP={}));var __extends=this&&this.__extends||function(a,t){function c(){this.constructor=a}for(var q in t)t.hasOwnProperty(q)&&(a[q]=t[q]);a.prototype=null===t?Object.create(t):(c.prototype=t.prototype,new c)};
(function(a){var t=a.MOD.utils,c=a.MOD.parser,q=a.MOD.defaults,p=a.MOD.datepicker;a.global=null;a.css_riaTemplate="ria-template";var k={load:"load",unload:"unload",initialized:"initialize",unresolvedBinding:"unresolvedBind"},g=function(g){function l(c,e){g.call(this);var b=this;if(a.global)throw Error(a.ERRS.ERR_GLOBAL_SINGLTON);if(!e)throw Error(a.ERRS.ERR_APP_NEED_JQUERY);this._window=c;this._appInst={};this._$=e;this._currentSelectable=null;this._userCode={};this._exports={};this._templateLoaders=
{};this._templateGroups={};this._promises=[];this._parser=null;this._isInitialized=this._isReady=!1;this._internal={initialize:function(){b._initialize()},trackSelectable:function(a){b._trackSelectable(a)},untrackSelectable:function(a){b._untrackSelectable(a)},registerApp:function(a){b._registerApp(a)},unregisterApp:function(a){b._unregisterApp(a)},destroyApps:function(){b._destroyApps()},registerObject:function(a,m,f){b._registerObject(a,m,f)},getObject:function(a,m){return b._getObject(a,m)},removeObject:function(a,
m){b._removeObject(a,m)},processTemplateSections:function(a){b._processTemplateSections(a)},loadTemplatesAsync:function(a,m){return b._loadTemplatesAsync(a,m)},registerTemplateLoader:function(a,m){b._registerTemplateLoader(a,m)},getTemplateLoader:function(a){return b._getTemplateLoader(a)},registerTemplateGroup:function(a,m){b._registerTemplateGroup(a,m)},getTemplateGroup:function(a){return b._getTemplateGroup(a)},waitForNotLoading:function(a,m){b._waitForNotLoading(a,m)},getConverter:function(a){return b._getConverter(a)},
onUnResolvedBinding:function(a,m,f,c){b._onUnResolvedBinding(a,m,f,c)}};this._onCreate()}__extends(l,g);l.prototype._onCreate=function(){var a=this;a.$(a.document).ready(function(c){a._waitQueue=new t.WaitQueue(a);a._isReady=!0;a._processTemplateSections(a.document);a.raiseEvent(k.load,{});setTimeout(function(){a.removeHandler(k.load,null)},0)});a.$(a.document).on("click.global",function(c){c.stopPropagation();a.currentSelectable=null});a.$(a.document).on("keydown.global",function(c){c.stopPropagation();
if(a._currentSelectable)a._currentSelectable.getISelectable().onKeyDown(c.which,c)});a.$(a.document).on("keyup.global",function(c){c.stopPropagation();if(a._currentSelectable)a._currentSelectable.getISelectable().onKeyUp(c.which,c)});a.$(a.window).unload(function(){a.raiseEvent(k.unload,{})});a.window.onerror=function(a,b,d){if(a&&-1<a.toString().indexOf("DUMMY_ERROR"))return!0;alert("Error: "+a+"\nURL: "+b+"\nLine Number: "+d);return!1}};l.prototype._processTemplateSection=function(c,e){var b=this;
a.ArrayHelper.fromList(c.querySelectorAll(l._TEMPLATE_SELECTOR)).forEach(function(a){var m=b.document.createElement("div"),f=a.getAttribute("id"),c=b.utils.createDeferred();a.removeAttribute("id");m.appendChild(a);c.resolve(m.innerHTML);e&&(f=e.appName+"."+f);b._registerTemplateLoader(f,{fn_loader:function(){return c.promise()}})})};l.prototype._registerTemplateLoaderCore=function(c,e){a.baseUtils.setValue(this._templateLoaders,c,e,!1)};l.prototype._getTemplateLoaderCore=function(c){return a.baseUtils.getValue(this._templateLoaders,
c)};l.prototype._getEventNames=function(){var a=g.prototype._getEventNames.call(this);return Object.keys(k).map(function(a,b,d){return k[a]}).concat(a)};l.prototype._addHandler=function(a,c,b,d,m){var f=this;a==k.load&&f._isReady||a==k.initialized&&f._isInitialized?setTimeout(function(){c.apply(f,[f,{}])},0):g.prototype._addHandler.call(this,a,c,b,d,m)};l.prototype._initialize=function(){if(!this._isInitialized){var h=this,e,b;b="utils";if(e=t._isModuleLoaded)h._utils=new t.Utils;b="parser";if(e=
c._isModuleLoaded)h._parser=new c.Parser;b="defaults";if(e=q._isModuleLoaded)h._defaults=new q.Defaults;b="datepicker";(e=p._isModuleLoaded)&&h._defaults&&(h._defaults.datepicker=h.getType("IDatepicker"));if(!e)throw Error(a.baseUtils.format(a.ERRS.ERR_MODULE_NOT_REGISTERED,b));this._isInitialized=!0;h.raiseEvent(k.initialized,{});setTimeout(function(){h.removeHandler(k.initialized,null)},0)}};l.prototype._trackSelectable=function(a){var c=this,b=c.utils,d=a.getISelectable(),m=d.getContainerEl();
c.$(m).on("click."+d.getUniqueID(),function(d){d.stopPropagation();b.isContained(d.target,m)&&(c.currentSelectable=a)})};l.prototype._untrackSelectable=function(a){var c=a.getISelectable(),b=c.getContainerEl();this.$(b).off("click."+c.getUniqueID());this.currentSelectable===a&&(this.currentSelectable=null)};l.prototype._registerApp=function(a){this._appInst[a.appName]||(this._appInst[a.appName]=a)};l.prototype._unregisterApp=function(a){this._appInst[a.appName]&&(delete this._appInst[a.appName],delete this._templateLoaders[a.appName],
delete this._templateGroups[a.appName])};l.prototype._destroyApps=function(){var a=this;this.utils.forEachProp(this._appInst,function(c){a._appInst[c].destroy()})};l.prototype._registerObject=function(c,e,b){a.baseUtils.setValue(c.getExports(),e,b,!0)};l.prototype._getObject=function(c,e){return a.baseUtils.getValue(c.getExports(),e)};l.prototype._removeObject=function(c,e){return a.baseUtils.removeValue(c.getExports(),e)};l.prototype._processTemplateSections=function(c){var e=this;a.ArrayHelper.fromList(c.querySelectorAll(l._TEMPLATES_SELECTOR)).forEach(function(a){e._processTemplateSection(a,
null);e.utils.removeNode(a)})};l.prototype._loadTemplatesAsync=function(a,c){var b=this,d=a(),m=b.isLoading;b._promises.push(d);b.isLoading!==m&&b.raisePropertyChanged("isLoading");var f=b.utils.createDeferred();d.then(function(a){b.utils.removeFromArray(b._promises,d);try{var m=b.document.createElement("div");m.innerHTML=a;b._processTemplateSection(m,c);f.resolve()}catch(h){b.handleError(h,b),f.reject()}b.isLoading||b.raisePropertyChanged("isLoading")},function(a){b.utils.removeFromArray(b._promises,
d);b.isLoading||b.raisePropertyChanged("isLoading");f.reject();a&&a.message?b.handleError(a,b):a&&a.responseText?b.handleError(Error(a.responseText),b):b.handleError(Error("Failed to load templates"),b)});return f.promise()};l.prototype._registerTemplateLoader=function(c,e){e=this.utils.extend(!1,{fn_loader:null,groupName:null},e);if(!e.groupName&&!this.utils.check.isFunction(e.fn_loader))throw Error(a.baseUtils.format(a.ERRS.ERR_ASSERTION_FAILED,"fn_loader is Function"));var b=this._getTemplateLoaderCore(c);
if(b){if(!b.fn_loader&&b.groupName&&!e.groupName&&e.fn_loader)return this._registerTemplateLoaderCore(c,e);throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_ALREADY_REGISTERED,c));}return this._registerTemplateLoaderCore(c,e)};l.prototype._getTemplateLoader=function(c){var e=this,b=e._getTemplateLoaderCore(c);if(!b)return null;if(!b.fn_loader&&b.groupName){var d=e._getTemplateGroup(b.groupName);if(!d)throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_GROUP_NOTREGISTERED,b.groupName));return function(){d.promise||
(d.promise=e._loadTemplatesAsync(d.fn_loader,d.app));var b=e.utils.createDeferred();d.promise.done(function(){try{d.promise=null;d.names.forEach(function(b){d.app&&(b=d.app.appName+"."+b);var m=e._getTemplateLoaderCore(b);if(!m||!m.fn_loader)throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_NOTREGISTERED,b));});var f=e._getTemplateLoaderCore(c);if(!f||!f.fn_loader)throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_NOTREGISTERED,c));delete e._templateGroups[f.groupName];f.fn_loader().done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)})}catch(z){b.reject(z)}});
d.promise.fail(function(a){d.promise=null;b.reject(a)});return b.promise()}}return b.fn_loader};l.prototype._registerTemplateGroup=function(c,e){var b=this,d=b.utils.extend(!1,{fn_loader:null,url:null,names:null,app:null,promise:null},e);d.url&&!d.fn_loader&&(d.fn_loader=function(){return b.utils.performAjaxGet(d.url)});a.baseUtils.setValue(b._templateGroups,c,d,!0);d.names.forEach(function(a){d.app&&(a=d.app.appName+"."+a);b._registerTemplateLoader(a,{groupName:c,fn_loader:null})})};l.prototype._getTemplateGroup=
function(c){return a.baseUtils.getValue(this._templateGroups,c)};l.prototype._waitForNotLoading=function(a,c){this._waitQueue.enQueue({prop:"isLoading",groupName:null,predicate:function(a){return!a},action:a,actionArgs:c})};l.prototype._getConverter=function(c){var e=this._getObject(this,"converters."+c);if(!e)throw Error(this.utils.format(a.ERRS.ERR_CONVERTER_NOTREGISTERED,c));return e};l.prototype._onUnResolvedBinding=function(a,c,b,d){this.raiseEvent(k.unresolvedBinding,{bindTo:a,root:c,path:b,
propName:d})};l.prototype._getInternal=function(){return this._internal};l.prototype.addOnLoad=function(a,c,b){this._addHandler(k.load,a,c,b,!1)};l.prototype.addOnUnLoad=function(a,c,b){this._addHandler(k.unload,a,c,b,!1)};l.prototype.addOnInitialize=function(a,c,b){this._addHandler(k.initialized,a,c,b,!1)};l.prototype.addOnUnResolvedBinding=function(a,c,b){this._addHandler(k.unresolvedBinding,a,c,b,!1)};l.prototype.removeOnUnResolvedBinding=function(a){this._removeHandler(k.unresolvedBinding,a)};
l.prototype.getExports=function(){return this._exports};l.prototype.findApp=function(a){return this._appInst[a]};l.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._waitQueue&&(this._waitQueue.destroy(),this._waitQueue=null),this._promises=[],this._removeHandler(),this._destroyApps(),this._exports={},this._templateLoaders={},this._templateGroups={},this._parser=null,this.$(this.document).off(".global"),a.global=null,this.window.onerror=null,g.prototype.destroy.call(this))};
l.prototype.registerType=function(a,c){return this._registerObject(this,"types."+a,c)};l.prototype.getType=function(a){return this._getObject(this,"types."+a)};l.prototype.registerConverter=function(c,e){var b="converters."+c;if(this._getObject(this,b))throw Error(a.global.utils.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,c));this._registerObject(this,b,e)};l.prototype.registerElView=function(c,e){var b="elvws."+c;if(this._getObject(this,b))throw Error(a.global.utils.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,
c));this._registerObject(this,b,e)};l.prototype.getImagePath=function(a){return this.defaults.imagesPath+a};l.prototype.loadTemplates=function(a){var c=this;this._loadTemplatesAsync(function(){return c.utils.performAjaxGet(a)},null)};l.prototype.toString=function(){return"Global"};Object.defineProperty(l.prototype,"parser",{get:function(){return this._parser},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"isLoading",{get:function(){return 0<this._promises.length},enumerable:!0,
configurable:!0});Object.defineProperty(l.prototype,"$",{get:function(){return this._$},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"window",{get:function(){return this._window},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"document",{get:function(){return this._window.document},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"currentSelectable",{get:function(){return this._currentSelectable},set:function(a){this._currentSelectable!==a&&
(this._currentSelectable=a,this.raisePropertyChanged("currentSelectable"))},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"defaults",{get:function(){return this._defaults},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"utils",{get:function(){return this._utils},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"UC",{get:function(){return this._userCode},enumerable:!0,configurable:!0});l.vesion="2.7.7";l._TEMPLATES_SELECTOR=["section.",a.css_riaTemplate].join("");
l._TEMPLATE_SELECTOR='*[data-role="template"]';return l}(a.BaseObject);a.Global=g;a.global=new g(window,jQuery)})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=a.baseUtils,p=function(){function b(){}b.isHTML=function(a){if(b.isNt(a))return!1;var m=/html/i;return"object"===typeof a?m.test(a.constructor.toString()):!1};b.isObject=function(a){if(b.isNt(a))return!1;var m=/object/i;return"object"===typeof a?m.test(a.constructor.toString()):!1};b.isSimpleObject=function(a){return b.isNt(a)?!1:b.isObject(a)&&Object.prototype===Object.getPrototypeOf(a)};b.isRegExp=function(a){if(b.isNt(a))return!1;var m=/regexp/i;return"function"===
typeof a?m.test(a.constructor.toString()):!1};b.isBoolString=function(a){return b.isNt(a)?!1:"true"==a||"false"==a};b.isBaseObj=function(d){return!!d&&d instanceof a.BaseObject};b.isEditable=function(d){return!!d&&d instanceof a.BaseObject&&!!d.beginEdit&&!!d.endEdit&&!!d.cancelEdit&&a.global.utils.hasProp(d,"isEditing")};b.isSubmittable=function(d){return!!d&&!!d.submitChanges&&!!d.rejectChanges&&a.global.utils.hasProp(d,"isCanSubmit")};b.isErrorNotification=function(a){if(!a||!b.isFunction(a.getIErrorNotification))return!1;
a=a.getIErrorNotification();return!!a&&b.isFunction(a.getIErrorNotification)};b.isNull=q.isNull;b.isUndefined=q.isUndefined;b.isNt=q.isNt;b.isFunction=q.isFunc;b.isString=q.isString;b.isArray=q.isArray;b.isBoolean=q.isBoolean;b.isDate=q.isDate;b.isNumber=q.isNumber;b.isNumeric=q.isNumeric;return b}();c.Checks=p;var k=function(){function a(){}a.formatNumber=function(a,b,f,c){a=(a+"").replace(/[^0-9+-Ee.]/g,"");var e=isFinite(+a)?+a:0;a=isFinite(+b)?Math.abs(b):0;c=void 0===c?",":c;f=void 0===f?".":
f;var h=[""],h=function(a,d){var b=Math.pow(10,d);return""+Math.round(a*b)/b};p.isNt(b)?(h=(""+e).split("."),a=2):h=(a?h(e,a):""+Math.round(e)).split(".");var e="",y=h[0].length;if(3<y){for(b=0;b<y;b+=1)e+=h[0].charAt(b),b<y-1&&0===(y-b-1)%3&&(e+=c);h[0]=e}(h[1]||"").length<a&&(h[1]=h[1]||"",h[1]+=Array(a-h[1].length+1).join("0"));return h.join(f)};a.stripNonNumeric=function(a){a+="";for(var b=/^\d|\.|-$/,f="",c=0;c<a.length;c++)b.test(a.charAt(c))&&("."==a.charAt(c)&&-1!=f.indexOf(".")||"-"==a.charAt(c)&&
0!=f.length||(f+=a.charAt(c)));return f};a.endsWith=q.endsWith;a.startsWith=q.startsWith;a.trim=q.trim;return a}();c.StringUtils=k;var g=function(){function b(){}b.checkNumRange=function(b,m){var f=m.split(",");if(f[0]&&b<parseFloat(f[0]))throw Error(q.format(a.ERRS.ERR_FIELD_RANGE,b,m));if(f[1]&&b>parseFloat(f[1]))throw Error(q.format(a.ERRS.ERR_FIELD_RANGE,b,m));};b._dtRangeToDate=function(a){a=a.split("-");return new Date(parseInt(a[0],10),parseInt(a[1],10)-1,parseInt(a[2],10))};b.checkDateRange=
function(d,m){var f=m.split(",");if(f[0]&&d<b._dtRangeToDate(f[0]))throw Error(q.format(a.ERRS.ERR_FIELD_RANGE,d,m));if(f[1]&&d>b._dtRangeToDate(f[1]))throw Error(q.format(a.ERRS.ERR_FIELD_RANGE,d,m));};return b}();c.Validations=g;c.valueUtils={valueToDate:function(b,d,m){if(!b)return null;b=""+b;var f=b.split("-");if(7!=f.length)throw Error(q.format(a.ERRS.ERR_PARAM_INVALID,"val",b));b=new Date(parseInt(f[0],10),parseInt(f[1],10)-1,parseInt(f[2],10),parseInt(f[3],10),parseInt(f[4],10),parseInt(f[5],
10),f[6]?parseInt(f[6],10):0);f=a.global.utils.get_timeZoneOffset();switch(d){case 0:break;case 1:b.setMinutes(b.getMinutes()+m);b.setMinutes(b.getMinutes()-f);break;case 2:b.setMinutes(b.getMinutes()-f);break;default:throw Error(q.format(a.ERRS.ERR_PARAM_INVALID,"dtcnv",d));}return b},dateToValue:function(b,d,m){if(null===b)return null;if(!p.isDate(b))throw Error(q.format(a.ERRS.ERR_PARAM_INVALID,"dt",b));var f=a.global.utils.get_timeZoneOffset();switch(d){case 0:break;case 1:b.setMinutes(b.getMinutes()+
f);b.setMinutes(b.getMinutes()-m);break;case 2:b.setMinutes(b.getMinutes()+f);break;default:throw Error(q.format(a.ERRS.ERR_PARAM_INVALID,"dtcnv",d));}return""+b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate()+"-"+b.getHours()+"-"+b.getMinutes()+"-"+b.getSeconds()+"-"+b.getMilliseconds()},compareVals:function(a,d,m){if(null===a&&null!==d||null!==a&&null===d)return!1;switch(m){case 6:case 7:case 8:return p.isDate(a)&&p.isDate(d)?a.getTime()===d.getTime():!1;default:return a===d}},stringifyValue:function(b,
d,m,f){var e=null;if(p.isNt(b))return e;var h=!1;switch(m){case 0:e=p.isDate(b)?c.valueUtils.dateToValue(b,d,f):p.isArray(b)?JSON.stringify(b):p.isString(b)?b:JSON.stringify(b);h=!0;break;case 1:case 9:p.isString(b)&&(e=b,h=!0);break;case 2:p.isBoolean(b)&&(e=JSON.stringify(b),h=!0);break;case 3:case 4:case 5:p.isNumber(b)&&(e=JSON.stringify(b),h=!0);break;case 6:case 7:case 8:p.isDate(b)&&(e=c.valueUtils.dateToValue(b,d,f),h=!0);break;case 10:p.isArray(b)&&(e=JSON.stringify(b),h=!0);break;default:throw Error(q.format(a.ERRS.ERR_PARAM_INVALID,
"dataType",m));}if(!h)throw Error(q.format(a.ERRS.ERR_FIELD_WRONG_TYPE,b,m));return e},parseValue:function(b,d,m,f){var e=null;if(void 0===b||null===b)return e;switch(d){case 0:e=b;break;case 1:case 9:e=b;break;case 2:e=a.global.utils.parseBool(b);break;case 3:e=parseInt(b,10);break;case 4:case 5:e=parseFloat(b);break;case 6:case 7:case 8:e=c.valueUtils.valueToDate(b,m,f);break;case 10:e=JSON.parse(b);break;default:throw Error(q.format(a.ERRS.ERR_PARAM_INVALID,"dataType",d));}return e}};var n=function(b){function d(){b.call(this);
this._objs=[]}__extends(d,b);d.create=function(){return new d};d.prototype.addObj=function(a){0>this._objs.indexOf(a)&&this._objs.push(a)};d.prototype.removeObj=function(b){a.global.utils.removeFromArray(this._objs,b)};d.prototype.getObjs=function(){return this._objs};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._objs.forEach(function(a){a.getIsDestroyCalled()||a.destroy()}),this._objs=[],b.prototype.destroy.call(this))};d.prototype.toString=function(){return"LifeTimeScope"};
return d}(a.BaseObject);c.LifeTimeScope=n;var l=function(a){function d(){a.call(this);this._objId="prw"+q.getNewID();this._objs=[]}__extends(d,a);d.create=function(){return new d};d.prototype.addPropWatch=function(a,b,d){a.addOnPropertyChange(b,function(a,b){d(b.property)},this.uniqueID);0>this._objs.indexOf(a)&&this._objs.push(a)};d.prototype.addWatch=function(a,b,d){a.addOnPropertyChange("*",function(a,m){-1<b.indexOf(m.property)&&d(m.property)},this.uniqueID);0>this._objs.indexOf(a)&&this._objs.push(a)};
d.prototype.removeWatch=function(a){a.removeNSHandlers(this.uniqueID)};d.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var d=this;this._objs.forEach(function(a){d.removeWatch(a)});this._objs=[];a.prototype.destroy.call(this)}};d.prototype.toString=function(){return"PropWatcher "+this._objId};Object.defineProperty(d.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});return d}(a.BaseObject);c.PropWatcher=l;var h=function(b){function d(a){b.call(this);
this._objId="wq"+q.getNewID();this._owner=a;this._queue={}}__extends(d,b);d.create=function(a){return new d(a)};d.prototype._checkQueue=function(a,b){if(this._owner&&!this._owner.getIsDestroyCalled()){var d=this,c=this._queue[a],e;if(c&&0!=c.length){var h,v=null,B=null,D=[],E=[],F=[];for(h=0;h<c.length;h+=1)if(e=c[h],e.predicate(b))if(e.group||0!=D.length)e.group&&(B||(B=e.group),B===e.group&&D.push(e));else{v=e;break}if(v)E.push(v),F.push(v);else for(;0<D.length;)e=D.pop(),v||(v=e),v.lastWins?0==
E.length&&E.push(e):E.push(e),F.push(e);try{if(0<E.length){for(h=c.length;0<h;)--h,-1<F.indexOf(c[h])&&c.splice(h,1);E.forEach(function(a){try{a.action.apply(d._owner,a.args)}catch(b){d._owner.handleError(b,d)}})}}finally{0==c.length&&(delete this._queue[a],this._owner.removeOnPropertyChange(a,this.uniqueID))}}}};d.prototype.enQueue=function(b){b=a.global.utils.extend(!1,{prop:"",groupName:null,predicate:null,action:null,actionArgs:[],lastWins:!1,syncCheck:!1},b);var d=this;if(this._owner){var c=
b.prop,e=this._queue[c];e||(e=[],this._queue[c]=e,this._owner.addOnPropertyChange(c,function(a,b){setTimeout(function(){d.getIsDestroyCalled()||d._checkQueue(c,d._owner[c])},0)},d.uniqueID));e.push({predicate:b.predicate,action:b.action,group:b.groupName,lastWins:b.lastWins,args:b.actionArgs?b.actionArgs:[]});b.syncCheck?d._checkQueue(c,d._owner[c]):setTimeout(function(){d.getIsDestroyCalled()||d._checkQueue(c,d._owner[c])},0)}};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=
!0,this._owner.removeNSHandlers(this.uniqueID),this._queue={},this._owner=null,b.prototype.destroy.call(this))};d.prototype.toString=function(){return"WaitQueue "+this._objId};Object.defineProperty(d.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0});return d}(a.BaseObject);c.WaitQueue=h;var e=function(){function b(){this.slice=Array.prototype.slice;this.get_timeZoneOffset=
function(){var a=(new Date).getTimezoneOffset();return function(){return a}}();this.format=q.format;this.uuid=function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return function(b,f){var c,e=[],h=Math.random;f=f||a.length;if(b)for(c=0;c<b;c+=1)e[c]=a[0|h()*f];else{var y;e[8]=e[13]=e[18]=e[23]="-";e[14]="4";for(c=0;36>c;c+=1)e[c]||(y=0|16*h(),e[c]=a[19==c?y&3|8:y&15])}return e.join("")}}()}b.create=function(){return new b};Object.defineProperty(b.prototype,"check",
{get:function(){return p},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"str",{get:function(){return k},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"validation",{get:function(){return g},enumerable:!0,configurable:!0});b.prototype.getNewID=function(){return q.getNewID()};b.prototype.isContained=function(a,b){if(!a)return!1;for(;a=a.parentNode;)if(a===b)return!0;return!1};b.prototype.parseBool=function(b){if(p.isBoolean(b))return b;var m=q.trim(b).toLowerCase();
if("false"===m)return!1;if("true"===m)return!0;throw Error(this.format(a.ERRS.ERR_PARAM_INVALID,"bool_value",b));};b.prototype.round=function(a,b){return parseFloat(a.toFixed(b))};b.prototype.performAjaxCall=function(b,c,f,e,h,g){var y=new XMLHttpRequest;y.open("POST",b,f);var v=this.createDeferred();y.responseType="text";y.onload=function(a){200==this.status&&v.resolve(this.response)};y.onerror=function(a){v.reject(Error(a.target.status))};y.ontimeout=function(){v.reject(Error("The request for "+
b+" timed out."))};y.timeout=1E3*a.global.defaults.ajaxTimeOut;y.setRequestHeader("Content-Type","application/json; charset=utf-8");y.send(c);c=v.promise();e&&c.done(function(a){e.call(g,a)});h&&c.fail(function(a){h.call(g,a)});return c};b.prototype.performAjaxGet=function(b){var c=new XMLHttpRequest;c.open("GET",b,!0);var f=this.createDeferred();c.responseType="text";c.onload=function(a){200==this.status&&f.resolve(this.response)};c.onerror=function(a){f.reject(Error(a.target.status))};c.ontimeout=
function(){f.reject(Error("The request for "+b+" timed out."))};c.timeout=1E3*a.global.defaults.ajaxTimeOut;c.send(null);return f.promise()};b.prototype.extend=function(a,b,f){return a?this.cloneObj(f,b):this.mergeObj(f,b)};b.prototype.removeNode=function(a){if(a){var b=a.parentNode;b&&b.removeChild(a)}};b.prototype.insertAfter=function(a,b){var f=a.parentNode;f.lastChild===a?f.appendChild(b):f.insertBefore(b,a.nextSibling)};b.prototype.getProps=function(a){return Object.getOwnPropertyNames(a)};b.prototype.forEachProp=
function(a,b){Object.getOwnPropertyNames(a).forEach(b)};b.prototype.hasProp=function(a,b){return q.hasProp(a,b)};b.prototype.createDeferred=function(){return a.global.$.Deferred()};b.prototype.isDeferredPending=function(a){return"pending"==a.state()};b.prototype.cloneObj=function(a,b){var f,c,e;if(!a)return a;if(this.check.isArray(a))for(e=a.length,f=Array(e),c=0;c<e;c+=1)f[c]=this.cloneObj(a[c],null);else if(this.check.isSimpleObject(a)){f=b||{};var h,g=Object.getOwnPropertyNames(a);e=g.length;for(c=
0;c<e;c+=1)h=g[c],f[h]=this.cloneObj(a[h],null)}else return a;return f};b.prototype.shallowCopy=function(a){return this.mergeObj(a,{})};b.prototype.mergeObj=function(a,b){b||(b={});if(!a)return b;for(var c=Object.getOwnPropertyNames(a),e,h=0,g=c.length;h<g;h+=1)e=c[h],b[e]=a[e];return b};b.prototype.removeFromArray=function(a,b){var c=a.indexOf(b);-1<c&&a.splice(c,1);return c};b.prototype.insertIntoArray=function(a,b,c){a.splice(c,0,b)};b.prototype.getErrorNotification=function(a){return a?a._aspect&&
p.isErrorNotification(a._aspect)?a._aspect.getIErrorNotification():p.isErrorNotification(a)?a.getIErrorNotification():null:null};b.prototype.getEditable=function(a){return a?a._aspect&&p.isEditable(a._aspect)?a._aspect:p.isEditable(a)?a:null:null};b.prototype.getSubmittable=function(a){return a?a._aspect&&p.isSubmittable(a._aspect)?a._aspect:p.isSubmittable(a)?a:null:null};b.prototype.destroyJQueryPlugin=function(a,b){if(a.data(b))a[b]("destroy")};return b}();c.Utils=e;a.global.registerType("PropWatcher",
l);a.global.registerType("LifeTimeScope",n);a.global.registerType("WaitQueue",h);c._isModuleLoaded=!0})(t.utils||(t.utils={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=function(a){function c(g){a.call(this);this._message=g;this._isDummy=!1;this._origError=null}__extends(c,a);c.create=function(a){return new c(a)};c.prototype.toString=function(){return this._message};Object.defineProperty(c.prototype,"message",{get:function(){return this._message},set:function(a){this._message=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isDummy",{get:function(){return this._isDummy},set:function(a){this._isDummy=
a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"origError",{get:function(){return this._origError},set:function(a){this._origError=a},enumerable:!0,configurable:!0});return c}(a.BaseObject);c.BaseError=q;var p=function(a){function c(g){a.call(this,"DUMMY_ERROR");this.origError=g;this.isDummy=!0}__extends(c,a);c.create=function(a){return new c(a)};return c}(q);c.DummyError=p;q=function(c){function g(g,l){var h=a.ERRS.ERR_VALIDATION+"\r\n",e=0;g.forEach(function(b){0<e&&(h+="\r\n");
h=b.fieldName?h+" "+a.localizable.TEXT.txtField+": "+b.fieldName+" -> "+b.errors.join(", "):h+b.errors.join(", ");e+=1});c.call(this,h);this._errors=g;this._item=l}__extends(g,c);Object.defineProperty(g.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"errors",{get:function(){return this._errors},enumerable:!0,configurable:!0});return g}(q);c.ValidationError=q;c._isModuleLoaded=!0})(t.errors||(t.errors={}))})(a.MOD||(a.MOD={}))})(RIAPP||
(RIAPP={}));
(function(a){(function(t){(function(c){c.NUM_CONV={None:0,Integer:1,Decimal:2,Float:3,SmallInt:4};var q=function(){function b(){}b.prototype.convertToSource=function(a,b,d){return a};b.prototype.convertToTarget=function(b,d,c){return a.global.utils.check.isNt(b)?null:b};return b}();c.BaseConverter=q;var q=new q,p=function(){function b(){}b.prototype.convertToSource=function(b,d,c){if(!b)return null;d=a.global.defaults;var e=d.datepicker;return e?e.parseDate(b):g.convertToSource(b,d.dateFormat,c)};
b.prototype.convertToTarget=function(b,d,c){if(a.global.utils.check.isNt(b))return"";d=a.global.defaults;var e=d.datepicker;return e?e.formatDate(b):g.convertToTarget(b,d.dateFormat,c)};b.prototype.toString=function(){return"DateConverter"};return b}();c.DateConverter=p;var p=new p,k=function(){function b(){}b.prototype.convertToSource=function(b,d,c){if(!b)return null;d=moment(b,d);if(!d.isValid())throw Error(a.global.utils.format(a.ERRS.ERR_CONV_INVALID_DATE,b));return d.toDate()};b.prototype.convertToTarget=
function(b,d,c){return a.global.utils.check.isNt(b)?"":moment(b).format(d)};b.prototype.toString=function(){return"DateTimeConverter"};return b}();c.DateTimeConverter=k;var g=new k,k=function(){function b(){}b.prototype.convertToSource=function(b,d,e){e=a.global.utils;if(a.global.utils.check.isNt(b))return null;var h=a.global.defaults,g=h.decimalPoint,y=4,v=b.replace(h.thousandSep,""),v=v.replace(g,"."),v=a.global.utils.str.stripNonNumeric(v);if(""===v)return null;g=null;switch(d){case c.NUM_CONV.SmallInt:g=
parseInt(v,10);break;case c.NUM_CONV.Integer:g=parseInt(v,10);break;case c.NUM_CONV.Decimal:y=h.decPrecision;g=e.round(parseFloat(v),y);break;case c.NUM_CONV.Float:g=parseFloat(v);break;default:g=Number(v)}if(!e.check.isNumber(g))throw Error(e.format(a.ERRS.ERR_CONV_INVALID_NUM,b));return g};b.prototype.convertToTarget=function(b,d,e){e=a.global.utils;if(e.check.isNt(b))return"";var h=a.global.defaults,g=h.decimalPoint,y=h.thousandSep;switch(d){case c.NUM_CONV.Integer:return e.str.formatNumber(b,
0,g,y);case c.NUM_CONV.Decimal:return d=h.decPrecision,e.str.formatNumber(b,d,g,y);case c.NUM_CONV.SmallInt:return e.str.formatNumber(b,0,g,"");case c.NUM_CONV.Float:return e.str.formatNumber(b,null,g,y);default:return e.str.formatNumber(b,null,g,y)}};b.prototype.toString=function(){return"NumberConverter"};return b}();c.NumberConverter=k;var n=new k,k=function(){function a(){}a.prototype.convertToSource=function(a,b,d){return n.convertToSource(a,c.NUM_CONV.Integer,d)};a.prototype.convertToTarget=
function(a,b,d){return n.convertToTarget(a,c.NUM_CONV.Integer,d)};a.prototype.toString=function(){return"IntegerConverter"};return a}();c.IntegerConverter=k;var k=new k,l=function(){function a(){}a.prototype.convertToSource=function(a,b,d){return n.convertToSource(a,c.NUM_CONV.SmallInt,d)};a.prototype.convertToTarget=function(a,b,d){return n.convertToTarget(a,c.NUM_CONV.SmallInt,d)};a.prototype.toString=function(){return"SmallIntConverter"};return a}();c.SmallIntConverter=l;var l=new l,h=function(){function a(){}
a.prototype.convertToSource=function(a,b,d){return n.convertToSource(a,c.NUM_CONV.Decimal,d)};a.prototype.convertToTarget=function(a,b,d){return n.convertToTarget(a,c.NUM_CONV.Decimal,d)};a.prototype.toString=function(){return"DecimalConverter"};return a}();c.DecimalConverter=h;var h=new h,e=function(){function a(){}a.prototype.convertToSource=function(a,b,d){return n.convertToSource(a,c.NUM_CONV.Float,d)};a.prototype.convertToTarget=function(a,b,d){return n.convertToTarget(a,c.NUM_CONV.Float,d)};
a.prototype.toString=function(){return"FloatConverter"};return a}();c.FloatConverter=e;var e=new e,b=function(){function a(){}a.prototype.convertToSource=function(a,b,d){return!a};a.prototype.convertToTarget=function(a,b,d){return!a};return a}();c.NotConverter=b;a.global.registerConverter("BaseConverter",q);a.global.registerConverter("dateConverter",p);a.global.registerConverter("dateTimeConverter",g);a.global.registerConverter("numberConverter",n);a.global.registerConverter("integerConverter",k);
a.global.registerConverter("smallIntConverter",l);a.global.registerConverter("decimalConverter",h);a.global.registerConverter("floatConverter",e);a.global.registerConverter("notConverter",new b);c._isModuleLoaded=!0})(t.converter||(t.converter={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=function(c){function k(){c.call(this);this._datepicker=null;this._dateFormat="DD.MM.YYYY";this._dateTimeFormat="DD.MM.YYYY HH:mm:ss";this._timeFormat="HH:mm:ss";this._imagesPath="/Scripts/jriapp/img/";this._decimalPoint=",";this._thousandSep=" ";this._decPrecision=2;this._ajaxTimeOut=600}__extends(k,c);k.prototype.toString=function(){return"Defaults"};Object.defineProperty(k.prototype,"ajaxTimeOut",{get:function(){return this._ajaxTimeOut},set:function(a){this._ajaxTimeOut!==
a&&(this._ajaxTimeOut=a,this.raisePropertyChanged("ajaxTimeOut"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"dateFormat",{get:function(){return this._dateFormat},set:function(a){this._dateFormat!==a&&(this._dateFormat=a,this.raisePropertyChanged("dateFormat"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"timeFormat",{get:function(){return this._timeFormat},set:function(a){this._timeFormat!==a&&(this._timeFormat=a,this.raisePropertyChanged("timeFormat"))},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"dateTimeFormat",{get:function(){return this._dateTimeFormat},set:function(a){this._dateTimeFormat!==a&&(this._dateTimeFormat=a,this.raisePropertyChanged("dateTimeFormat"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"datepicker",{get:function(){return this._datepicker},set:function(a){this._datepicker!==a&&(this._datepicker=a,this.raisePropertyChanged("datepicker"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"imagesPath",{get:function(){return this._imagesPath},set:function(c){c||(c="");this._imagesPath!==c&&(a.baseUtils.endsWith(c,"/")?this._imagesPath=c:this._imagesPath=c+"/",this.raisePropertyChanged("imagesPath"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"decimalPoint",{get:function(){return this._decimalPoint},set:function(a){this._decimalPoint!==a&&(this._decimalPoint=a,this.raisePropertyChanged("decimalPoint"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"thousandSep",{get:function(){return this._thousandSep},set:function(a){this._thousandSep!==a&&(this._thousandSep=a,this.raisePropertyChanged("thousandSep"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"decPrecision",{get:function(){return this._decPrecision},set:function(a){this._decPrecision!==a&&(this._decPrecision=a,this.raisePropertyChanged("decPrecision"))},enumerable:!0,configurable:!0});return k}(a.BaseObject);c.Defaults=q;c._isModuleLoaded=!0})(t.defaults||(t.defaults=
{}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=a.MOD.collection,p;a.global.addOnInitialize(function(a,c){p=a.utils});var k=function(){function a(){}a.prototype._getKeyVals=function(c){var l,h,e,b=[],d={key:"",val:""},m=!0,f=a.__valueDelimeter1,z=a.__valueDelimeter2,A=a.__keyValDelimeter,k=function(a){a.val&&(p.check.isNumeric(a.val)?a.val=Number(a.val):p.check.isBoolString(a.val)&&(a.val=p.parseBool(a.val)));b.push(a)};for(l=0;l<c.length;l+=1){h=c.charAt(l);if("'"==h||'"'==h)e?e==h&&(e=null):e=h;e||
"{"!==h||m?e||h!==A?e||h!==f&&h!==z?m?d.key+=h:d.val+=h:m=!1:d.key&&(k(d),d={key:"",val:""},m=!0):(h=c.substr(l),h=this.getBraceParts(h,!0)[0],d.val+=h,l+=h.length-1)}d.key&&k(d);b.forEach(function(a){a.key=p.str.trim(a.key);p.check.isString(a.val)&&(a.val=p.str.trim(a.val));""===a.val&&p.str.startsWith(a.key,"this.")&&(a.val=a.key.substr(5),a.key="targetPath")});return b=b.filter(function(a){return""!==a.val})};a.prototype.getPathParts=function(c){var l=[];(c?c.split("."):[]).forEach(function(c){var e;
(e=c.match(a.__indexedPropRX))?(c=e[1],e=e[2],l.push(c),l.push("["+e+"]")):l.push(c)});return l};a.prototype.resolveProp=function(a,c){return c?p.str.startsWith(c,"[")?(c=this.trimQuotes(this.trimBrackets(c)),q._isCollection(a)?q._getItemByProp(a,c):p.check.isArray(a)?a[parseInt(c,10)]:a[c]):a[c]:a};a.prototype.setPropertyValue=function(a,c,h){p.str.startsWith(c,"[")?(c=this.trimQuotes(this.trimBrackets(c)),p.check.isArray(a)?a[parseInt(c,10)]=h:a[c]=h):a[c]=h};a.prototype.resolveBindingSource=function(a,
c){if(a){if(0===c.length)return a;if(0<c.length)return this.resolveBindingSource(this.resolveProp(a,c[0]),c.slice(1));throw Error("Invalid operation");}};a.prototype.resolvePath=function(a,c){if(!c)return a;for(var h=this.getPathParts(c),e=a,b=h.length-1,d=0;d<b;d+=1)if(e=this.resolveProp(e,h[d]),!e)return;return this.resolveProp(e,h[b])};a.prototype.getBraceParts=function(a,c){var h,e="",b,d,m=0,f=[];for(h=0;h<a.length;h+=1){b=a.charAt(h);if("'"===b||'"'===b)d?d===b&&(d=null):d=b;if(d||"{"!==b)if(d||
"}"!==b)0<m&&(e+=b);else{if(--m,e+=b,0===m&&(f.push(e),e="",c))break}else m+=1,e+=b}return f};a.prototype.trimOuterBraces=function(c){return p.str.trim(c.replace(a.__trimOuterBracesRX,""))};a.prototype.trimQuotes=function(c){return p.str.trim(c.replace(a.__trimQuotsRX,""))};a.prototype.trimBrackets=function(c){return p.str.trim(c.replace(a.__trimBracketsRX,""))};a.prototype.isWithOuterBraces=function(a){return p.str.startsWith(a,"{")&&p.str.endsWith(a,"}")};a.prototype.parseOption=function(a){var c=
{},h=this;a=p.str.trim(a);h.isWithOuterBraces(a)&&(a=h.trimOuterBraces(a));h._getKeyVals(a).forEach(function(a){var b=p.check.isString(a.val);b&&h.isWithOuterBraces(a.val)?c[a.key]=h.parseOption(a.val):c[a.key]=b?h.trimQuotes(a.val):a.val});return c};a.prototype.parseOptions=function(a){var c=[],h=this;a=p.str.trim(a);var e=[a];h.isWithOuterBraces(a)&&(e=h.getBraceParts(a,!1));e.forEach(function(a){c.push(h.parseOption(a))});return c};a.prototype.toString=function(){return"Parser"};a.__trimOuterBracesRX=
/^([{]){0,1}|([}]){0,1}$/g;a.__trimQuotsRX=/^(['"])+|(['"])+$/g;a.__trimBracketsRX=/^(\[)+|(\])+$/g;a.__indexedPropRX=/(^\w+)\s*\[\s*['"]?\s*([^'"]+)\s*['",]?\s*\]/i;a.__valueDelimeter1=":";a.__valueDelimeter2="=";a.__keyValDelimeter=",";return a}();c.Parser=k;c._isModuleLoaded=!0})(t.parser||(t.parser={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=function(c){function g(g,l,h){c.call(this);this._action=g;this._thisObj=l?l:null;this._canExecute=h;this._objId="cmd"+a.baseUtils.getNewID()}__extends(g,c);g.prototype._getEventNames=function(){var a=c.prototype._getEventNames.call(this);return["canExecute_changed"].concat(a)};g.prototype.addOnCanExecuteChanged=function(a,c,h){this._addHandler("canExecute_changed",a,c,h)};g.prototype.removeOnCanExecuteChanged=function(a){this._removeHandler("canExecute_changed",
a)};g.prototype.canExecute=function(a,c){return this._canExecute?this._canExecute.apply(this._thisObj,[a,c]):!0};g.prototype.execute=function(a,c){this._action&&this._action.apply(this._thisObj,[a,c])};g.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._canExecute=this._thisObj=this._action=null,c.prototype.destroy.call(this))};g.prototype.raiseCanExecuteChanged=function(){this.raiseEvent("canExecute_changed",{})};g.prototype.toString=function(){return"Command"};return g}(a.BaseObject);
c.Command=q;var p=function(c){function g(g){c.call(this);this._app=g;this._objId="vm"+a.baseUtils.getNewID()}__extends(g,c);g.prototype.handleError=function(a,g){var h=c.prototype.handleError.call(this,a,g);return h?h:this._app.handleError(a,g)};g.prototype.toString=function(){return"BaseViewModel"};g.prototype.destroy=function(){this._app=null;c.prototype.destroy.call(this)};Object.defineProperty(g.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,
"$",{get:function(){return a.global.$},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return g}(a.BaseObject);c.BaseViewModel=p;a.global.registerType("Command",q);a.global.registerType("BaseViewModel",p);c._isModuleLoaded=!0})(t.mvvm||(t.mvvm={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){function q(b,d,f,v){f={content:{text:d},style:{classes:f?c.css.toolTipError:c.css.toolTip},position:{my:"top left",at:v?v:"bottom right",viewport:a.global.$(a.global.window),adjust:{method:"flip",x:0,y:0}},hide:{event:"unfocus click mouseleave",leave:!0}};b.data("qtip")?d?b.qtip("option","content.text",d):b.qtip("destroy",!0):d&&b.qtip(f)}var p=a.consts,k=a.MOD.mvvm,g=a.localizable.VALIDATE,n;a.global.addOnInitialize(function(a,b){n=a.utils});c._isElView=function(a){return!!a&&
a instanceof l};c.fn_addToolTip=q;k=function(a){function b(c,d,f){a.call(this,c,d,f)}__extends(b,a);return b}(k.Command);c.PropChangedCommand=k;c.css={toolTip:"qtip",toolTipError:"qtip-red",fieldError:"ria-field-error",commandLink:"ria-command-link",disabled:"disabled",opacity:"opacity",color:"color",fontSize:"font-size"};c.PROP_NAME={isVisible:"isVisible",validationErrors:"validationErrors",toolTip:"toolTip",css:"css",isEnabled:"isEnabled",value:"value",command:"command",disabled:"disabled",commandParam:"commandParam",
isBusy:"isBusy",delay:"delay",checked:"checked",color:"color",rows:"rows",cols:"cols",wrap:"wrap",text:"text",html:"html",preventDefault:"preventDefault",imageSrc:"imageSrc",href:"href",isExpanded:"isExpanded",fontSize:"fontSize",borderColor:"borderColor",borderStyle:"borderStyle",width:"width",height:"height",src:"src"};var l=function(b){function d(c,f,v){b.call(this);this._app=c;this._el=f;this._oldDisplay=this._$el=null;this._objId="elv"+a.baseUtils.getNewID();this._propChangedCommand=null;c._getInternal().setElView(this._el,
this);this._errors=null;this._toolTip=v.tip;this._css=v.css;this._init(v);this._applyToolTip()}__extends(d,b);d.prototype._applyToolTip=function(){this._toolTip&&this._setToolTip(this.$el,this._toolTip)};d.prototype._init=function(a){this._css&&this.$el.addClass(this._css)};d.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this._$el,c=this._el;a&&a.off("."+this._objId);try{this._$el=this._el=this.toolTip=this.validationErrors=this._propChangedCommand=null}finally{this._app._getInternal().setElView(c,
null),this._app=null}b.prototype.destroy.call(this)}};d.prototype.invokePropChanged=function(a){a={property:a};this._propChangedCommand&&this._propChangedCommand.execute(this,a)};d.prototype._getErrorTipInfo=function(a){var b=["<b>",g.errorInfo,"</b>","<br/>"];a.forEach(function(a){var u="";a.errors.forEach(function(a){u=u+" "+a});b.push(u);u=""});return b.join("")};d.prototype._setFieldError=function(a){var b=this.$el;a?b.addClass(c.css.fieldError):b.removeClass(c.css.fieldError)};d.prototype._updateErrorUI=
function(a,b){if(a){var c=this.$el;b&&0<b.length?(q(c,this._getErrorTipInfo(b),!0),this._setFieldError(!0)):(this._setToolTip(c,this.toolTip),this._setFieldError(!1))}};d.prototype.handleError=function(a,c){var d=b.prototype.handleError.call(this,a,c);return d?d:this._app.handleError(a,c)};d.prototype._setToolTip=function(a,b,c){q(a,b,c)};d.prototype.toString=function(){return"BaseElView"};Object.defineProperty(d.prototype,"$el",{get:function(){this._el&&!this._$el&&(this._$el=a.global.$(this._el));
return this._$el},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isVisible",{get:function(){return"none"!==this.el.style.display},set:function(a){a=!!a;a!==this.isVisible&&(a?this.el.style.display=this._oldDisplay?this._oldDisplay:"":(this._oldDisplay=this.el.style.display,
this.el.style.display="none"),this.raisePropertyChanged(c.PROP_NAME.isVisible))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"propChangedCommand",{get:function(){return this._propChangedCommand},set:function(a){a!==this._propChangedCommand&&(this._propChangedCommand=a,this.invokePropChanged("*"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"validationErrors",{get:function(){return this._errors},set:function(a){a!==this._errors&&(this._errors=a,this.raisePropertyChanged(c.PROP_NAME.validationErrors),
this._updateErrorUI(this._el,this._errors))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"dataNameAttr",{get:function(){return this._el.getAttribute(p.DATA_ATTR.DATA_NAME)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"toolTip",{get:function(){return this._toolTip},set:function(a){this._toolTip!=a&&(this._toolTip=a,this._setToolTip(this.$el,a),this.raisePropertyChanged(c.PROP_NAME.toolTip))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"css",{get:function(){return this._css},set:function(a){var b=this.$el;this._css!=a&&(this._css&&b.removeClass(this._css),(this._css=a)&&b.addClass(this._css),this.raisePropertyChanged(c.PROP_NAME.css))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return d}(a.BaseObject);c.BaseElView=l;var h=function(a){function b(c,d,f){a.call(this,c,d,f)}__extends(b,a);b.prototype.toString=function(){return"InputElView"};
Object.defineProperty(b.prototype,"isEnabled",{get:function(){return!this.el.disabled},set:function(a){a=!!a;a!==this.isEnabled&&(this.el.disabled=!a,this.raisePropertyChanged(c.PROP_NAME.isEnabled))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){var a=this.el;return a?a.value:""},set:function(a){if(this._el){var b=this.el,d=b.value;a=null===a?"":""+a;
d!==a&&(b.value=a,this.raisePropertyChanged(c.PROP_NAME.value))}},enumerable:!0,configurable:!0});return b}(l);c.InputElView=h;var e=function(a){function b(c,d,f){a.call(this,c,d,f);this._commandParam=this._command=null;this.isEnabled||this.$el.addClass("disabled")}__extends(b,a);b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._command&&this._command.removeNSHandlers(this._objId),this.commandParam=this.command=null,a.prototype.destroy.call(this))};b.prototype.invokeCommand=
function(){var a=this,b=a.command,c=a.commandParam;b&&b.canExecute(a,c)&&setTimeout(function(){b.canExecute(a,c)&&b.execute(a,c)},0)};b.prototype._onCommandChanged=function(){this.raisePropertyChanged(c.PROP_NAME.command)};b.prototype._onCanExecuteChanged=function(a,b){this.isEnabled=a.canExecute(this,this.commandParam)};b.prototype._setCommand=function(a){a!==this._command&&(this._command&&this._command.removeNSHandlers(this._objId),(this._command=a)?(this._command.addOnCanExecuteChanged(this._onCanExecuteChanged,
this._objId,this),this.isEnabled=this._command.canExecute(this,this.commandParam)):this.isEnabled=!1,this._onCommandChanged())};b.prototype.toString=function(){return"CommandElView"};Object.defineProperty(b.prototype,"isEnabled",{get:function(){return!this.$el.prop(c.PROP_NAME.disabled)},set:function(a){a!==this.isEnabled&&(this.$el.prop(c.PROP_NAME.disabled,!a),a?this.$el.removeClass(c.css.disabled):this.$el.addClass(c.css.disabled),this.raisePropertyChanged(c.PROP_NAME.isEnabled))},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"command",{get:function(){return this._command},set:function(a){this._setCommand(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"commandParam",{get:function(){return this._commandParam},set:function(a){a!==this._commandParam&&(this._commandParam=a,this.raisePropertyChanged(c.PROP_NAME.commandParam))},enumerable:!0,configurable:!0});return b}(l);c.CommandElView=e;k=function(b){function d(a,c,f){b.call(this,a,c,f)}__extends(d,
b);d.prototype._init=function(c){b.prototype._init.call(this,c);var d;d=c.img?c.img:p.LOADER_GIF.NORMAL;this._delay=400;this._timeOut=null;n.check.isNt(c.delay)||(this._delay=parseInt(""+c.delay));this._loaderPath=a.global.getImagePath(d);this._$loader=a.global.$(new Image);this._$loader.css({position:"absolute",display:"none",zIndex:"10000"});this._$loader.prop("src",this._loaderPath);this._$loader.appendTo(this.el);this._isBusy=!1};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=
!0,this._timeOut&&(clearTimeout(this._timeOut),this._timeOut=null),this._$loader.remove(),this._$loader=null,b.prototype.destroy.call(this))};d.prototype.toString=function(){return"BusyElView"};Object.defineProperty(d.prototype,"isBusy",{get:function(){return this._isBusy},set:function(b){var d=this,f=function(){d._timeOut=null;d._$loader.show();d._$loader.position({of:a.global.$(d.el)})};b!==d._isBusy&&(d._isBusy=b,d._isBusy?(d._timeOut&&(clearTimeout(d._timeOut),d._timeOut=null),0<d._delay?d._timeOut=
setTimeout(f,d._delay):f()):d._timeOut?(clearTimeout(d._timeOut),d._timeOut=null):d._$loader.hide(),d.raisePropertyChanged(c.PROP_NAME.isBusy))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"delay",{get:function(){return this._delay},set:function(a){a!==this._delay&&(this._delay=a,this.raisePropertyChanged(c.PROP_NAME.delay))},enumerable:!0,configurable:!0});return d}(l);c.BusyElView=k;var b=function(b){function d(){b.apply(this,arguments)}__extends(d,b);d.prototype._init=function(a){var c=
this;b.prototype._init.call(this,a);this._val=this.el.checked;this.$el.on("change."+this._objId,function(a){a.stopPropagation();c.checked=this.checked})};d.prototype._setFieldError=function(b){var d=this.$el;b?(b=a.global.$("<div></div>").addClass(c.css.fieldError),d.wrap(b)):0<d.parent("."+c.css.fieldError).length&&d.unwrap()};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.$el.off("."+this._objId),b.prototype.destroy.call(this))};d.prototype.toString=function(){return"CheckBoxElView"};
Object.defineProperty(d.prototype,"checked",{get:function(){return this._val},set:function(a){var b=this.el;null!==a&&(a=!!a);a!==this._val&&(this._val=a,b&&(b.checked=!!this._val),null===this._val?this.$el.css(c.css.opacity,.33):this.$el.css(c.css.opacity,1),this.raisePropertyChanged(c.PROP_NAME.checked))},enumerable:!0,configurable:!0});return d}(h);c.CheckBoxElView=b;var d=function(b){function d(){b.apply(this,arguments)}__extends(d,b);d.prototype._init=function(a){var d=this;b.prototype._init.call(this,
a);this._val=this.el.checked;this._cbxVal=null==this._val?1:this._val?2:0;this.$el.on("change."+this._objId,function(a){a.stopPropagation();switch(d._cbxVal){case 0:d._cbxVal=1;break;case 1:d._cbxVal=2;break;default:d._cbxVal=0}d.checked=1==d._cbxVal?null:2==d._cbxVal?!0:!1})};d.prototype._setFieldError=function(b){var d=this.$el;b?(b=a.global.$("<div></div>").addClass(c.css.fieldError),d.wrap(b)):0<d.parent("."+c.css.fieldError).length&&d.unwrap()};d.prototype.destroy=function(){this._isDestroyed||
(this._isDestroyCalled=!0,this.$el.off("."+this._objId),b.prototype.destroy.call(this))};d.prototype.toString=function(){return"CheckBoxThreeStateElView"};Object.defineProperty(d.prototype,"checked",{get:function(){return this._val},set:function(a){var b=this.$el;if(a!==this._val){this._val=a;switch(this._val){case null:b.prop("indeterminate",!0);this._cbxVal=1;break;case !0:b.prop("indeterminate",!1);b.prop("checked",!0);this._cbxVal=2;break;default:b.prop("indeterminate",!1),b.prop("checked",!1),
this._cbxVal=0}this.raisePropertyChanged(c.PROP_NAME.checked)}},enumerable:!0,configurable:!0});return d}(h);c.CheckBoxThreeStateElView=d;var m=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(b){var d=this;a.prototype._init.call(this,b);var f=this.$el;f.on("change."+this._objId,function(a){a.stopPropagation();d.raisePropertyChanged(c.PROP_NAME.value)});f.on("keypress."+this._objId,function(a){a.stopPropagation();var b={keyCode:a.which,value:a.target.value,
isCancel:!1};d.raiseEvent("keypress",b);b.isCancel&&a.preventDefault()});if(b.updateOnKeyUp)f.on("keyup."+this._objId,function(a){a.stopPropagation();d.raisePropertyChanged(c.PROP_NAME.value)})};b.prototype._getEventNames=function(){var b=a.prototype._getEventNames.call(this);return["keypress"].concat(b)};b.prototype.addOnKeyPress=function(a,b){this._addHandler("keypress",a,b)};b.prototype.removeOnKeyPress=function(a){this._removeHandler("keypress",a)};b.prototype.toString=function(){return"TextBoxElView"};
Object.defineProperty(b.prototype,"color",{get:function(){return this.$el.css("color")},set:function(a){var b=this.$el,d=b.css(c.css.color);a!==d&&(b.css(c.css.color,a),this.raisePropertyChanged(c.PROP_NAME.color))},enumerable:!0,configurable:!0});return b}(h);c.TextBoxElView=m;var f=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype.toString=function(){return"HiddenElView"};return b}(h);c.HiddenElView=f;var z=function(a){function b(d,c,f){a.call(this,d,c,f)}__extends(b,a);
b.prototype._init=function(b){a.prototype._init.call(this,b);var d=this;b.rows&&(this.rows=b.rows);b.cols&&(this.cols=b.cols);b.wrap&&(this.wrap=b.wrap);var f=this.$el;f.on("change."+this._objId,function(a){a.stopPropagation();d.raisePropertyChanged(c.PROP_NAME.value)});f.on("keypress."+this._objId,function(a){a.stopPropagation();var b={keyCode:a.which,value:a.target.value,isCancel:!1};d.raiseEvent("keypress",b);b.isCancel&&a.preventDefault()});if(b.updateOnKeyUp)f.on("keyup."+this._objId,function(a){a.stopPropagation();
d.raisePropertyChanged(c.PROP_NAME.value)})};b.prototype._getEventNames=function(){var b=a.prototype._getEventNames.call(this);return["keypress"].concat(b)};b.prototype.addOnKeyPress=function(a,b){this._addHandler("keypress",a,b)};b.prototype.removeOnKeyPress=function(a){this._removeHandler("keypress",a)};b.prototype.toString=function(){return"TextAreaElView"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"value",{get:function(){var a=this.el;return a?a.value:""},set:function(a){if(this._el){var b=this.el,d=b.value;a=null===a?"":""+a;d!==a&&(b.value=a,this.raisePropertyChanged(c.PROP_NAME.value))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isEnabled",{get:function(){return!this.el.disabled},set:function(a){a=!!a;a!==this.isEnabled&&(this.el.disabled=!a,this.raisePropertyChanged(c.PROP_NAME.isEnabled))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"rows",
{get:function(){var a=this.el;return a?a.rows:1},set:function(a){var b=this.el;if(b){var d=b.rows;a=a?a:1;d!==a&&(b.rows=a,this.raisePropertyChanged(c.PROP_NAME.rows))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"cols",{get:function(){var a=this.el;return a?a.cols:1},set:function(a){var b=this.el;if(b){var d=b.cols;a=a?a:1;d!==a&&(b.cols=a,this.raisePropertyChanged(c.PROP_NAME.cols))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"wrap",{get:function(){var a=
this.el;return a?a.wrap:"off"},set:function(a){var b=this.el;if(b){var d=b.wrap;a=a?a:"off";0>["hard","off","soft"].indexOf(a)&&(a="off");d!==a&&(b.wrap=a,this.raisePropertyChanged(c.PROP_NAME.wrap))}},enumerable:!0,configurable:!0});return b}(l);c.TextAreaElView=z;h=function(b){function d(){b.apply(this,arguments)}__extends(d,b);d.prototype._init=function(a){var d=this;b.prototype._init.call(this,a);this._val=this.el.checked;this.$el.on("change."+this._objId,function(a){a.stopPropagation();d.checked=
this.checked;d._updateGroup()})};d.prototype._updateGroup=function(){var b=this.el.getAttribute("name"),d=this;if(b){var c=this.el.parentElement;if(c){var d=this,u=d.el;a.global.$('input[type="radio"][name="'+b+'"]',c).each(function(a,b){if(u!==this){var c=d.app._getInternal().getElView(this);c&&(c.checked=this.checked)}})}}};d.prototype._setFieldError=function(b){var d=this.$el;b?(b=a.global.$("<div></div>").addClass(c.css.fieldError),d.wrap(b)):0<d.parent("."+c.css.fieldError).length&&d.unwrap()};
d.prototype.toString=function(){return"RadioElView"};Object.defineProperty(d.prototype,"checked",{get:function(){return this._val},set:function(a){var b=this.el;null!==a&&(a=!!a);a!==this._val&&(this._val=a,b&&(b.checked=!!this._val),null===this._val?this.$el.css("opacity",.33):this.$el.css(c.css.opacity,1),this.raisePropertyChanged(c.PROP_NAME.checked))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"value",{get:function(){return this.el.value},set:function(a){var b=this.el;if(b){var d=
""+a;null===a&&(d="");d!==b.value&&(b.value=d,this.raisePropertyChanged(c.PROP_NAME.value))}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"name",{get:function(){return this.el.name},enumerable:!0,configurable:!0});return d}(h);c.RadioElView=h;var A=function(a){function b(d,c,f){this._preventDefault=!1;a.call(this,d,c,f)}__extends(b,a);b.prototype._init=function(b){a.prototype._init.call(this,b);var d=this,c=this.$el;b.preventDefault&&(this._preventDefault=!0);c.on("click."+this._objId,
function(a){d._onClick(a)})};b.prototype._onClick=function(a){this._preventDefault&&a.preventDefault();this.invokeCommand()};b.prototype.toString=function(){return"ButtonElView"};Object.defineProperty(b.prototype,"value",{get:function(){return this._el?this.$el.val():""},set:function(a){if(this._el){var b=this.$el.val();a=null===a?"":""+a;b!==a&&(this.$el.val(a),this.raisePropertyChanged(c.PROP_NAME.value))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"text",{get:function(){return this._el?
this.$el.text():""},set:function(a){if(this._el){var b=this.$el.text();a=null===a?"":""+a;b!==a&&(this.$el.text(a),this.raisePropertyChanged(c.PROP_NAME.text))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"html",{get:function(){return this._el?this.$el.html():""},set:function(a){if(this._el){var b=this.$el.html();a=null===a?"":""+a;b!==a&&(this.$el.html(a),this.raisePropertyChanged(c.PROP_NAME.html))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"preventDefault",
{get:function(){return this._preventDefault},set:function(a){this._preventDefault!==a&&(this._preventDefault=a,this.raisePropertyChanged(c.PROP_NAME.preventDefault))},enumerable:!0,configurable:!0});return b}(e);c.ButtonElView=A;e=function(b){function d(a,c,f){this._image=this._imageSrc=null;this._preventDefault=!1;b.call(this,a,c,f)}__extends(d,b);d.prototype._init=function(a){b.prototype._init.call(this,a);var d=this,f=this.$el;a.imageSrc&&(this.imageSrc=a.imageSrc);a.preventDefault&&(this._preventDefault=
!0);f.addClass(c.css.commandLink);f.on("click."+this._objId,function(a){d._onClick(a)})};d.prototype._onClick=function(a){this._preventDefault&&a.preventDefault();this.invokeCommand()};d.prototype._updateImage=function(b){var d=this.$el,c=this;this._imageSrc!==b&&(this._imageSrc=b,this._image&&!b&&(a.global.$(this._image).remove(),this._image=null),b&&(this._image?this._image.src=b:(c.html=null,b=a.global.$(new Image).attr("src",b).mouseenter(function(b){c.isEnabled&&a.global.$(this).css("opacity",
.5)}).mouseout(function(b){c.isEnabled&&a.global.$(this).css("opacity",1)}).appendTo(d),this._image=b.get(0))))};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.$el.removeClass(c.css.commandLink),this.imageSrc=null,b.prototype.destroy.call(this))};d.prototype.toString=function(){return"AnchorElView"};Object.defineProperty(d.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"imageSrc",{get:function(){return this._imageSrc},
set:function(a){this._$el&&this._imageSrc!==a&&(this._updateImage(a),this.raisePropertyChanged(c.PROP_NAME.imageSrc))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"html",{get:function(){return this._el?this.$el.html():""},set:function(a){if(this._el){var b=this.$el.html();a=null===a?"":""+a;b!==a&&(this.$el.html(a),this.raisePropertyChanged(c.PROP_NAME.html))}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"text",{get:function(){return this._el?this.$el.text():
""},set:function(a){if(this._el){var b=this.$el.text();a=null===a?"":""+a;b!==a&&(this.$el.text(a),this.raisePropertyChanged(c.PROP_NAME.text))}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"href",{get:function(){return this._el?this.el.href:""},set:function(a){if(this._el){var b=this.href;a=null===a?"":""+a;b!==a&&(this.el.href=a,this.raisePropertyChanged(c.PROP_NAME.href))}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"preventDefault",{get:function(){return this._preventDefault},
set:function(a){this._preventDefault!==a&&(this._preventDefault=a,this.raisePropertyChanged(c.PROP_NAME.preventDefault))},enumerable:!0,configurable:!0});return d}(e);c.AnchorElView=e;var C=function(b){function d(){b.apply(this,arguments)}__extends(d,b);d.prototype._init=function(d){this._expandedsrc=d.expandedsrc||a.global.getImagePath("collapse.jpg");this._collapsedsrc=d.collapsedsrc||a.global.getImagePath("expand.jpg");this._isExpanded=!!d.isExpanded;b.prototype._init.call(this,{imageSrc:this._isExpanded?
this._expandedsrc:this._collapsedsrc})};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._collapsedsrc=this._expandedsrc=null,this._isExpanded=!1,b.prototype.destroy.call(this))};d.prototype._onCommandChanged=function(){b.prototype._onCommandChanged.call(this);this.invokeCommand()};d.prototype._onClick=function(a){this._isExpanded=!this._isExpanded;b.prototype._onClick.call(this,a)};d.prototype.invokeCommand=function(){this.imageSrc=this._isExpanded?this._expandedsrc:
this._collapsedsrc;b.prototype.invokeCommand.call(this)};d.prototype.toString=function(){return"ExpanderElView"};Object.defineProperty(d.prototype,"isExpanded",{get:function(){return this._isExpanded},set:function(a){this._isExpanded!==a&&(this._isExpanded=a,this.invokeCommand(),this.raisePropertyChanged(c.PROP_NAME.isExpanded))},enumerable:!0,configurable:!0});return d}(e);c.ExpanderElView=C;var y=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype.toString=function(){return"SpanElView"};
Object.defineProperty(b.prototype,"text",{get:function(){return this.$el.text()},set:function(a){var b=this.$el,d=b.text();a=null===a?"":""+a;d!==a&&(b.text(a),this.raisePropertyChanged(c.PROP_NAME.text),this.raisePropertyChanged(c.PROP_NAME.value))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){return this.text},set:function(a){this.text=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"html",{get:function(){return this.el.innerHTML},
set:function(a){var b=this.el.innerHTML;a=null===a?"":""+a;b!==a&&(this.el.innerHTML=a,this.raisePropertyChanged(c.PROP_NAME.html))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"color",{get:function(){return this.$el.css("color")},set:function(a){var b=this.$el,d=b.css(c.css.color);a!==d&&(b.css(c.css.color,a),this.raisePropertyChanged(c.PROP_NAME.color))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"fontSize",{get:function(){return this.$el.css("font-size")},
set:function(a){var b=this.$el,d=b.css(c.css.fontSize);a!==d&&(b.css(c.css.fontSize,a),this.raisePropertyChanged(c.PROP_NAME.fontSize))},enumerable:!0,configurable:!0});return b}(l);c.SpanElView=y;var v=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype.toString=function(){return"BlockElView"};Object.defineProperty(b.prototype,"borderColor",{get:function(){return this.$el.css("border-top-color")},set:function(a){var b=this.$el,d=b.css("border-top-color");a!==d&&(b.css("border-color",
a),this.raisePropertyChanged(c.PROP_NAME.borderColor))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"borderStyle",{get:function(){return this.$el.css("border-top-style")},set:function(a){var b=this.$el,d=b.css("border-top-style");a!==d&&(b.css("border-style",a),this.raisePropertyChanged(c.PROP_NAME.borderStyle))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"width",{get:function(){return this.$el.width()},set:function(a){var b=this.$el,d=b.width();a!==d&&
(b.width(a),this.raisePropertyChanged(c.PROP_NAME.width))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"height",{get:function(){return this.$el.height()},set:function(a){var b=this.$el,d=b.height();a!==d&&(b.height(a),this.raisePropertyChanged(c.PROP_NAME.height))},enumerable:!0,configurable:!0});return b}(y);c.BlockElView=v;var B=function(a){function b(d,c,f){a.call(this,d,c,f)}__extends(b,a);b.prototype.toString=function(){return"ImgElView"};Object.defineProperty(b.prototype,
"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"src",{get:function(){return this.el.src},set:function(a){this.el.src!==a&&(this.el.src=a,this.raisePropertyChanged(c.PROP_NAME.src))},enumerable:!0,configurable:!0});return b}(l);c.ImgElView=B;a.global.registerElView("busy_indicator",k);a.global.registerElView("input:checkbox",b);a.global.registerElView("threeState",d);a.global.registerElView("input:text",m);a.global.registerElView("input:hidden",
f);a.global.registerElView("textarea",z);a.global.registerElView("input:radio",h);a.global.registerElView("input:button",A);a.global.registerElView("input:submit",A);a.global.registerElView("button",A);a.global.registerElView("a",e);a.global.registerElView("abutton",e);a.global.registerElView("expander",C);a.global.registerElView("span",y);a.global.registerElView("div",v);a.global.registerElView("section",v);a.global.registerElView("block",v);a.global.registerElView("img",B);c._isModuleLoaded=!0})(t.baseElView||
(t.baseElView={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=a.MOD.baseElView,p=a.MOD.errors;c._isBinding=function(a){return!!a&&a instanceof h};c.bindModeMap={};c.bindModeMap.OneTime=0;c.bindModeMap.OneWay=1;c.bindModeMap.TwoWay=2;c.bindModeMap.BackWay=3;var k=a.global,g=a.baseUtils,n,l;k.addOnInitialize(function(a,b){n=a.utils;l=a.parser});c.getBindingOptions=function(a,b,d,m){var f={mode:1,converterParam:null,converter:null,targetPath:null,sourcePath:null,target:null,source:null,isSourceFixed:!1},h=b.source,g=
b.target;!b.sourcePath&&b.to?f.sourcePath=b.to:b.sourcePath&&(f.sourcePath=b.sourcePath);b.targetPath&&(f.targetPath=b.targetPath);b.converterParam&&(f.converterParam=b.converterParam);b.mode&&(f.mode=c.bindModeMap[b.mode]);b.converter&&(n.check.isString(b.converter)?f.converter=a.getConverter(b.converter):f.converter=b.converter);g?n.check.isString(g)?f.target="this"==g?d:l.resolveBindingSource(a,l.getPathParts(g)):f.target=g:f.target=d;h?(f.isSourceFixed=!0,n.check.isString(h)?f.source="this"==
h?d:l.resolveBindingSource(a,l.getPathParts(h)):f.source=h):f.source=m;return f};var h=function(e){function b(b,m){e.call(this);var f=n.extend(!1,{target:null,source:null,targetPath:null,sourcePath:null,mode:1,converter:null,converterParam:null,isSourceFixed:!1},b);n.check.isString(f.mode)&&(f.mode=c.bindModeMap[f.mode]);if(!n.check.isString(f.targetPath))throw a.DebugLevel==a.DEBUG_LEVEL.HIGH&&a.startDebugger(),Error(g.format(a.ERRS.ERR_BIND_TGTPATH_INVALID,f.targetPath));if(n.check.isUndefined(f.mode))throw a.DebugLevel==
a.DEBUG_LEVEL.HIGH&&a.startDebugger(),Error(g.format(a.ERRS.ERR_BIND_MODE_INVALID,f.mode));if(!f.target)throw Error(a.ERRS.ERR_BIND_TARGET_EMPTY);if(!n.check.isBaseObj(f.target))throw Error(a.ERRS.ERR_BIND_TARGET_INVALID);this._appName=m;this._state=null;this._mode=f.mode;this._converter=f.converter||k._getInternal().getConverter("BaseConverter");this._converterParam=f.converterParam;this._srcPath=l.getPathParts(f.sourcePath);this._tgtPath=l.getPathParts(f.targetPath);if(1>this._tgtPath.length)throw Error(n.format(a.ERRS.ERR_BIND_TGTPATH_INVALID,
f.targetPath));this._isSourceFixed=!!f.isSourceFixed;this._pathItems={};this._objId="bnd"+a.baseUtils.getNewID();this._ignoreTgtChange=this._ignoreSrcChange=!1;this._target=this._source=this._targetObj=this._sourceObj=null;this.target=f.target;this.source=f.source;(f=n.getErrorNotification(this._sourceObj))&&f.getIsHasErrors()&&this._onSrcErrorsChanged(f)}__extends(b,e);b._isDestroyed=function(a){var b=!1;n.check.isBaseObj(a)&&(b=a.getIsDestroyCalled());return b};b.prototype._onSrcErrorsChanged=function(a,
b){var c=[],e=this._targetObj,h=this._sourceObj,g=this._srcPath;e&&q._isElView(e)&&(h&&0<g.length&&(c=a.getFieldErrors(g[g.length-1])),e.validationErrors=c)};b.prototype._getTgtChangedFn=function(a,b,c,e,h){return function(g,y){var v=l.resolveProp(b,c);0<e.length&&a._setPathItem(null,1,h,e);a._parseTgtPath(v,e,h)}};b.prototype._getSrcChangedFn=function(a,b,c,e,h){return function(g,y){var v=l.resolveProp(b,c);0<e.length&&a._setPathItem(null,0,h,e);a._parseSrcPath(v,e,h)}};b.prototype._parseSrcPath=
function(a,b,c){this._sourceObj=null;0===b.length?this._sourceObj=a:this._parseSrcPath2(a,b,c);3===this._mode?this._sourceObj&&this._updateSource():this._targetObj&&this._updateTarget()};b.prototype._parseSrcPath2=function(b,c,f){var e=!!b&&n.check.isBaseObj(b);e&&(b.addOnDestroyed(this._onSrcDestroyed,this._objId,this),this._setPathItem(b,0,f,c));if(1<c.length){if(e&&b.addOnPropertyChange(c[0],this._getSrcChangedFn(this,b,c[0],c.slice(1),f+1),this._objId),b)if(b=k.parser.resolveProp(b,c[0]))this._parseSrcPath2(b,
c.slice(1),f+1);else if(g.isUndefined(b)&&(a.DebugLevel==a.DEBUG_LEVEL.HIGH&&a.startDebugger(),a.DebugLevel>a.DEBUG_LEVEL.NONE))k._getInternal().onUnResolvedBinding(0,this.source,this._srcPath.join("."),c[0])}else b&&1==c.length&&(f=!0,a.DebugLevel!=a.DEBUG_LEVEL.NONE&&(f=e?b._isHasProp(c[0]):g.hasProp(b,c[0])),f?(!e||1!==this._mode&&2!==this._mode||b.addOnPropertyChange(c[0],this._updateTarget,this._objId,this),(c=n.getErrorNotification(b))&&c.addOnErrorsChanged(this._onSrcErrorsChanged,this._objId,
this),this._sourceObj=b):(a.DebugLevel==a.DEBUG_LEVEL.HIGH&&a.startDebugger(),k._getInternal().onUnResolvedBinding(0,this.source,this._srcPath.join("."),c[0])))};b.prototype._parseTgtPath=function(a,b,c){this._targetObj=null;0===b.length?this._targetObj=a:this._parseTgtPath2(a,b,c);3===this._mode?this._sourceObj&&this._updateSource():this._targetObj&&this._updateTarget()};b.prototype._parseTgtPath2=function(b,c,f){var e=!!b&&n.check.isBaseObj(b);e&&(b.addOnDestroyed(this._onTgtDestroyed,this._objId,
this),this._setPathItem(b,1,f,c));if(1<c.length){if(e&&b.addOnPropertyChange(c[0],this._getTgtChangedFn(this,b,c[0],c.slice(1),f+1),this._objId,this),b)if(b=k.parser.resolveProp(b,c[0]))this._parseTgtPath2(b,c.slice(1),f+1);else if(g.isUndefined(b)&&(a.DebugLevel==a.DEBUG_LEVEL.HIGH&&a.startDebugger(),a.DebugLevel>a.DEBUG_LEVEL.NONE))k._getInternal().onUnResolvedBinding(1,this.target,this._tgtPath.join("."),c[0])}else b&&1===c.length&&(f=!0,a.DebugLevel!=a.DEBUG_LEVEL.NONE&&(f=e?b._isHasProp(c[0]):
g.hasProp(b,c[0])),f?(!e||2!==this._mode&&3!==this._mode||b.addOnPropertyChange(c[0],this._updateSource,this._objId,this),this._targetObj=b):(a.DebugLevel==a.DEBUG_LEVEL.HIGH&&a.startDebugger(),k._getInternal().onUnResolvedBinding(1,this.target,this._tgtPath.join("."),c[0])))};b.prototype._setPathItem=function(b,c,f,e){for(var h,g=f+e.length,y=f;y<g;y+=1){switch(c){case 0:h="s"+y;break;case 1:h="t"+y;break;default:throw Error(a.baseUtils.format(a.ERRS.ERR_PARAM_INVALID,"bindingTo",c));}if(e=this._pathItems[h])this._cleanUpObj(e),
delete this._pathItems[h];b&&y==f&&(this._pathItems[h]=b)}};b.prototype._cleanUpObj=function(a){a&&(a.removeNSHandlers(this._objId),(a=n.getErrorNotification(a))&&a.removeOnErrorsChanged(this._objId))};b.prototype._onTgtDestroyed=function(a,b){this._isDestroyCalled||this._setTarget(null)};b.prototype._onSrcDestroyed=function(a,b){var c=this;c._isDestroyCalled||(a===c.source?c._setSource(null):(c._setPathItem(null,0,0,c._srcPath),setTimeout(function(){c._isDestroyCalled||c._bindToSource()},0)))};b.prototype._bindToSource=
function(){this._parseSrcPath(this.source,this._srcPath,0)};b.prototype._bindToTarget=function(){this._parseTgtPath(this.target,this._tgtPath,0)};b.prototype._updateTarget=function(b,c){if(!this._ignoreSrcChange&&!this._isDestroyCalled){this._ignoreTgtChange=!0;try{var f=this._converter.convertToTarget(this.sourceValue,this._converterParam,this._sourceObj);void 0!==f&&(this.targetValue=f)}catch(e){3===this._mode&&this._updateSource(),a.reThrow(e,this.handleError(e,this))}finally{this._ignoreTgtChange=
!1}}};b.prototype._updateSource=function(a,b){if(!this._ignoreTgtChange&&!this._isDestroyCalled){this._ignoreSrcChange=!0;try{var c=this._converter.convertToSource(this.targetValue,this._converterParam,this._sourceObj);void 0!==c&&(this.sourceValue=c)}catch(e){if(!(e instanceof p.ValidationError&&q._isElView(this._targetObj)||(this._ignoreSrcChange=!1,3!=this._mode&&this._updateTarget(),this.handleError(e,this))))throw e;}finally{this._ignoreSrcChange=!1}}};b.prototype._setTarget=function(b){if(this._state)this._state.target=
b;else if(this._target!==b){if(this._targetObj){this._ignoreTgtChange=!0;try{this.targetValue=null}finally{this._ignoreTgtChange=!1}}this._setPathItem(null,1,0,this._tgtPath);if(b&&!n.check.isBaseObj(b))throw Error(a.ERRS.ERR_BIND_TARGET_INVALID);this._target=b;this._bindToTarget();if(this._target&&!this._targetObj)throw Error(n.format(a.ERRS.ERR_BIND_TGTPATH_INVALID,this._tgtPath.join(".")));}};b.prototype._setSource=function(a){this._state?this._state.source=a:this._source!==a&&(this._setPathItem(null,
0,0,this._srcPath),this._source=a,this._bindToSource())};b.prototype.handleError=function(a,b){var c=e.prototype.handleError.call(this,a,b);return c?c:this._appName?k.findApp(this._appName).handleError(a,b):k.handleError(a,b)};b.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this;n.forEachProp(this._pathItems,function(b){a._cleanUpObj(a._pathItems[b])});this._pathItems={};this._setSource(null);this._setTarget(null);this._target=this._source=this._targetObj=this._sourceObj=
this._tgtPath=this._srcPath=this._converterParam=this._converter=this._state=null;e.prototype.destroy.call(this)}};b.prototype.toString=function(){return"Binding"};Object.defineProperty(b.prototype,"bindingID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"target",{get:function(){return this._target},set:function(a){this._setTarget(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"source",{get:function(){return this._source},
set:function(a){this._setSource(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"targetPath",{get:function(){return this._tgtPath},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sourcePath",{get:function(){return this._srcPath},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sourceValue",{get:function(){return 0===this._srcPath.length?this._sourceObj:this._sourceObj?k.parser.resolveProp(this._sourceObj,this._srcPath[this._srcPath.length-
1]):void 0},set:function(a){0!==this._srcPath.length&&this._sourceObj&&(b._isDestroyed(this._sourceObj)||k.parser.setPropertyValue(this._sourceObj,this._srcPath[this._srcPath.length-1],a))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"targetValue",{get:function(){return this._targetObj?k.parser.resolveProp(this._targetObj,this._tgtPath[this._tgtPath.length-1]):void 0},set:function(a){0!=this._tgtPath.length&&this._targetObj&&(b._isDestroyed(this._targetObj)||k.parser.setPropertyValue(this._targetObj,
this._tgtPath[this._tgtPath.length-1],a))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"converter",{get:function(){return this._converter},set:function(a){this._converter=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"converterParam",{get:function(){return this._converterParam},set:function(a){this._converterParam=a},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"isSourceFixed",{get:function(){return this._isSourceFixed},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isDisabled",{get:function(){return!!this._state},set:function(a){a=!!a;if(this.isDisabled!=a)if(a){a={source:this._source,target:this._target};try{this.source=this.target=null}finally{this._state=a}}else a=this._state,this._state=null,this._setTarget(a.target),this._setSource(a.source)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"appName",{get:function(){return this._appName},enumerable:!0,configurable:!0});return b}(a.BaseObject);c.Binding=h;c._isModuleLoaded=!0})(t.binding||(t.binding={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){var c;(function(q){var p=a.consts,k=a.MOD.binding,g=a.MOD.baseElView,n=a.MOD.mvvm;q.css={templateContainer:"ria-template-container"};var l,h=a.global;h.addOnInitialize(function(a,b){l=a.utils});c._isTemplateElView=function(a){return!!a&&a instanceof b};var e=function(b){function e(a){b.call(this);this._options=a=l.extend(!1,{app:null,templateID:null,dataContext:null,templEvents:null,isDisabled:!1},a);this._lfTime=this._loadedElem=null;this._templElView=void 0;this._busyTimeOut=
this._promise=null;this._el=h.document.createElement("div");this._el.className=q.css.templateContainer;a.templateID&&this._loadTemplate()}__extends(e,b);e.prototype._getBindings=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),b=[],c=0,d=a.length;c<d;c+=1)k._isBinding(a[c])&&b.push(a[c]);return b};e.prototype._getElViews=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),b=[],c=0,d=a.length;c<d;c+=1)g._isElView(a[c])&&b.push(a[c]);return b};e.prototype._getTemplateElView=
function(){if(!this._lfTime||null===this._templElView)return null;if(this._templElView)return this._templElView;for(var a=null,b=this._getElViews(),d=0,e=b.length;d<e;d+=1)if(c._isTemplateElView(b[d])){a=b[d];break}return this._templElView=a};e.prototype._getTemplateEvents=function(){var a=this._getTemplateElView(),b=this._options.templEvents;return a&&b?[a,b]:a?[a]:b?[b]:[]};e.prototype._loadTemplateElAsync=function(b){var c=this;b=this.app.getTemplateLoader(b);var d=l.createDeferred();b?b().then(function(a){var b=
h.document.createElement("div");b.innerHTML=a;d.resolve(b.firstElementChild)},function(b){d.reject(Error(l.format(a.ERRS.ERR_TEMPLATE_ID_INVALID,c.templateID)))}):d.reject(Error(l.format(a.ERRS.ERR_TEMPLATE_ID_INVALID,c.templateID)));return d};e.prototype._appendIsBusy=function(a){var b=this;this._busyTimeOut=setTimeout(function(){b._busyTimeOut&&!b._isDestroyCalled&&(b._busyTimeOut=null,(new g.BusyElView(b.app,a,{img:p.LOADER_GIF.SMALL,delay:0})).isBusy=!0)},400)};e.prototype._removeIsBusy=function(a){this._busyTimeOut&&
(clearTimeout(this._busyTimeOut),this._busyTimeOut=null);(a=this.app._getInternal().getElView(a))&&a instanceof g.BusyElView&&a.destroy()};e.prototype._loadTemplate=function(){var b=this.templateID,c;try{this._promise&&(this._promise.reject("cancel"),this._promise=null),this._loadedElem&&this._unloadTemplate(),b&&(c=this._loadTemplateElAsync(b),this._waitLoad(c,l.isDeferredPending(c)))}catch(d){this.handleError(d,this),a.throwDummy(d)}};e.prototype._waitLoad=function(a,b){var c=this,d,e=c.el;c._promise=
d=l.createDeferred();a.then(function(a){d.resolve(a)},function(a){d.reject(a)});b&&(c._appendIsBusy(e),d.then(function(){c._removeIsBusy(e)},function(a){"cancel"==a&&c._removeIsBusy(e)}));d.then(function(a){c._onLoadOK(e,a)},function(a){c._onLoadFail(a)})};e.prototype._onLoadOK=function(b,c){var d,e,m;if(!this._isDestroyCalled)try{if(this._promise=null,this._loadedElem&&!c)this._unloadTemplate();else{this._loadedElem=c;e=this._getTemplateEvents();m=e.length;for(d=0;d<m;d+=1)e[d].templateLoading(this);
b.appendChild(c);this._lfTime=this.app._getInternal().bindTemplateElements(c);this._updateBindingSource();e=this._getTemplateEvents();m=e.length;for(d=0;d<m;d+=1)e[d].templateLoaded(this)}}catch(v){this.handleError(v,this),a.throwDummy(v)}};e.prototype._onLoadFail=function(b){if(!this._isDestroyCalled&&(this._promise=null,"cancel"!=b)){var c;b&&(b.message?c=b:b.statusText?c=Error(b.statusText):l.check.isString(b)&&(c=Error(b)));c||(c=Error(l.format(a.ERRS.ERR_TEMPLATE_ID_INVALID,this.templateID)));
this.handleError(c,this)}};e.prototype._updateBindingSource=function(){var a,b,c,d=this._getBindings();a=0;for(b=d.length;a<b;a+=1)c=d[a],c.isSourceFixed||(c.source=this.dataContext)};e.prototype._unloadTemplate=function(){var a,b=this._getTemplateEvents(),c=b.length;try{if(this._el)for(a=0;a<c;a+=1)b[a].templateUnLoading(this)}finally{this._cleanUp()}};e.prototype._cleanUp=function(){this._lfTime&&(this._lfTime.destroy(),this._lfTime=null);this._templElView=null;this._loadedElem&&h.$(this._loadedElem).remove();
this._loadedElem=null;this._isDestroyCalled&&this._el&&(h.$(this._el).remove(),this._el=null)};e.prototype.handleError=function(a,c){var e=b.prototype.handleError.call(this,a,c);return e?e:this.app.handleError(a,c)};e.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._busyTimeOut&&(clearTimeout(this._busyTimeOut),this._busyTimeOut=null),this._promise&&(this._promise.reject("cancel"),this._promise=null),this._unloadTemplate(),this._options={},b.prototype.destroy.call(this))};
e.prototype.findElByDataName=function(a){return h.$(this._el).find(["*[",p.DATA_ATTR.DATA_NAME,'="',a,'"]'].join("")).toArray()};e.prototype.findElViewsByDataName=function(a){a=this.findElByDataName(a);var b=[],c=this.app._getInternal();a.forEach(function(a){(a=c.getElView(a))&&b.push(a)});return b};e.prototype.toString=function(){return"Template"};Object.defineProperty(e.prototype,"loadedElem",{get:function(){return this._loadedElem},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"dataContext",{get:function(){return this._options.dataContext},set:function(a){this.dataContext!==a&&(this._options.dataContext=a,this.raisePropertyChanged("dataContext"),this._updateBindingSource())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"templateID",{get:function(){return this._options.templateID},set:function(a){this.templateID!==a&&(this._options.templateID=a,this._loadTemplate(),this.raisePropertyChanged("templateID"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"app",{get:function(){return this._options.app},enumerable:!0,configurable:!0});return e}(a.BaseObject);q.Template=e;n=function(a){function b(c,e,m){a.call(this,c,e,m)}__extends(b,a);return b}(n.Command);q.TemplateCommand=n;var b=function(b){function c(a,e,m){this._template=null;this._isEnabled=!0;b.call(this,a,e,m)}__extends(c,b);c.prototype.templateLoading=function(a){};c.prototype.templateLoaded=
function(b){var c=this._commandParam;try{this._template=b,this._commandParam={template:b,isLoaded:!0},this.invokeCommand(),this._commandParam=c,this.raisePropertyChanged("template")}catch(d){this.handleError(d,this),a.throwDummy(d)}};c.prototype.templateUnLoading=function(a){var b=this._commandParam;try{this._commandParam={template:a,isLoaded:!1},this.invokeCommand()}catch(c){this.handleError(c,this)}finally{this._commandParam=b,this._template=null}this.raisePropertyChanged("template")};c.prototype.toString=
function(){return"TemplateElView"};Object.defineProperty(c.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(a){this._isEnabled!==a&&(this._isEnabled=a,this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});return c}(g.CommandElView);q.TemplateElView=b;h.registerType("Template",e);h.registerElView("template",b);q._isModuleLoaded=!0})(c=t.template||
(t.template={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=a.MOD.utils,p=a.MOD.baseElView,k=a.MOD.binding,g=a.MOD.template,n,l;a.global.addOnInitialize(function(a,b){n=a.utils;l=a.parser});c.css={content:"ria-content-field",required:"ria-required-field"};c.parseContentAttr=function(a){var b={name:null,templateInfo:null,bindingInfo:null,displayInfo:null,fieldName:null,options:null};a=l.parseOptions(a);if(0===a.length)return b;a=a[0];!a.template&&a.fieldName?(b.bindingInfo={target:null,source:null,targetPath:null,
sourcePath:a.fieldName,mode:"OneWay",converter:null,converterParam:null},b.displayInfo=a.css,b.fieldName=a.fieldName,a.name&&(b.name=a.name),a.options&&(b.options=a.options),void 0!==a.readOnly&&(b.readOnly=n.parseBool(a.readOnly))):a.template&&(b.templateInfo=a.template,delete a.template);return b};var h=function(b){function d(e,f){b.call(this);f=n.extend(!1,{app:null,parentEl:null,options:null,dataContext:null,isEditing:!1},f);this._el=null;this._app=e;this._parentEl=f.parentEl;this._isEditing=
!!f.isEditing;this._dataContext=f.dataContext;this._options=f.contentOptions;this._isReadOnly=!!this._options.readOnly;this._target=this._lfScope=null;a.global.$(this._parentEl).addClass(c.css.content);this.init();this.render()}__extends(d,b);d.prototype.handleError=function(a,c){var d=b.prototype.handleError.call(this,a,c);return d?d:this._app.handleError(a,c)};d.prototype.init=function(){};d.prototype.updateCss=function(){var b=this._options.displayInfo,d=a.global.$(this._parentEl),e=this.getFieldInfo();
this._isEditing&&this.getIsCanBeEdited()?(b&&(b.editCss&&d.addClass(b.editCss),b.displayCss&&d.removeClass(b.displayCss)),e&&!e.isNullable&&d.addClass(c.css.required)):b&&(b.displayCss&&d.addClass(b.displayCss),b.editCss&&d.removeClass(b.editCss),e&&!e.isNullable&&d.removeClass(c.css.required))};d.prototype.getIsCanBeEdited=function(){if(this._isReadOnly)return!1;var a=this.getFieldInfo();return a?!!n.getEditable(this._dataContext)&&!a.isReadOnly&&2!=a.fieldType:!1};d.prototype.createTargetElement=
function(){var b;b=a.global.document;var c={name:null,options:null};this._isEditing&&this.getIsCanBeEdited()?(b=b.createElement("input"),b.setAttribute("type","text"),c.options=this._options.options):b=b.createElement("span");this.updateCss();this._el=b;return this.getElementView(this._el,c)};d.prototype.getBindingOption=function(a,b,c,d){a=k.getBindingOptions(this.app,a,b,c);this.isEditing&&this.getIsCanBeEdited()?a.mode=2:a.mode=1;d&&(a.targetPath=d);return a};d.prototype.getBindings=function(){if(!this._lfScope)return[];
for(var a=this._lfScope.getObjs(),b=[],c=0,d=a.length;c<d;c+=1)k._isBinding(a[c])&&b.push(a[c]);return b};d.prototype.updateBindingSource=function(){var a,b,c,d=this.getBindings();a=0;for(b=d.length;a<b;a+=1)c=d[a],c.isSourceFixed||(c.source=this._dataContext)};d.prototype.cleanUp=function(){this._lfScope&&(this._lfScope.destroy(),this._lfScope=null);this._el&&(n.removeNode(this._el),this._el=null);this._target=null};d.prototype.getElementView=function(a,b){var c=this.app._getInternal().getElView(a);
return c?c:this.app._getInternal().createElementView(a,b)};d.prototype.getFieldInfo=function(){return this._options.fieldInfo};d.prototype.render=function(){try{this.cleanUp();var b=this._options.bindingInfo;if(b){this._target=this.createTargetElement();this._lfScope=new q.LifeTimeScope;this._target&&this._lfScope.addObj(this._target);var c=this.getBindingOption(b,this._target,this._dataContext,"value");this._parentEl.appendChild(this._el);this._lfScope.addObj(this.app.bind(c))}}catch(d){a.reThrow(d,
this.handleError(d,this))}};d.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var d=this._options.displayInfo,e=a.global.$(this._parentEl);e.removeClass(c.css.content);e.removeClass(c.css.required);d&&d.displayCss&&e.removeClass(d.displayCss);d&&d.editCss&&e.removeClass(d.editCss);this.cleanUp();this._app=this._options=this._dataContext=this._parentEl=null;b.prototype.destroy.call(this)}};d.prototype.toString=function(){return"BindingContent"};Object.defineProperty(d.prototype,
"parentEl",{get:function(){return this._parentEl},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isEditing",{get:function(){return this._isEditing},set:function(a){this._isEditing!==a&&(this._isEditing=a,this.render())},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"dataContext",{get:function(){return this._dataContext},set:function(a){this._dataContext!==
a&&(this._dataContext=a,this.updateBindingSource())},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return d}(a.BaseObject);c.BindingContent=h;var e=function(b){function d(e,f){b.call(this);f=n.extend(!1,{app:null,parentEl:null,options:null,dataContext:null,isEditing:!1},f);this._app=e;this._templateID=null;this._parentEl=f.parentEl;this._isEditing=f.isEditing;this._dataContext=f.dataContext;this._templateInfo=
f.contentOptions.templateInfo;this._template=null;a.global.$(this._parentEl).addClass(c.css.content);this.render()}__extends(d,b);d.prototype.handleError=function(a,c){var d=b.prototype.handleError.call(this,a,c);return d?d:this._app.handleError(a,c)};d.prototype.templateLoading=function(a){};d.prototype.templateLoaded=function(a){};d.prototype.templateUnLoading=function(a){this._parentEl.removeChild(a.el)};d.prototype.getTemplateID=function(){if(!this._templateInfo)throw Error(a.ERRS.ERR_TEMPLATE_ID_INVALID);
var b=this._templateInfo,c=b.displayID;this._isEditing&&b.editID&&(c=b.editID);c||(c=b.editID);if(!c)throw Error(a.ERRS.ERR_TEMPLATE_ID_INVALID);return c};d.prototype.createTemplate=function(){return new g.Template({app:this.app,templateID:this._templateID,dataContext:this._dataContext,templEvents:this})};d.prototype.render=function(){try{var b=this.getTemplateID();this._templateID!==b&&(this.cleanUp(),this._templateID=b,this._template=this.createTemplate(),this._parentEl.appendChild(this._template.el))}catch(c){a.reThrow(c,
this.handleError(c,this))}};d.prototype.cleanUp=function(){this._template&&(this._template.destroy(),this._templateID=this._template=null)};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,a.global.$(this._parentEl).removeClass(c.css.content),this.cleanUp(),this._app=this._templateInfo=this._dataContext=this._parentEl=null,b.prototype.destroy.call(this))};d.prototype.toString=function(){return"TemplateContent"};Object.defineProperty(d.prototype,"app",{get:function(){return this._app},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"parentEl",{get:function(){return this._parentEl},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isEditing",{get:function(){return this._isEditing},set:function(a){this._isEditing!==a&&(this._isEditing=a,this.render())},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"dataContext",
{get:function(){return this._dataContext},set:function(a){this._dataContext!==a&&(this._dataContext=a,this._template&&(this._template.dataContext=this._dataContext))},enumerable:!0,configurable:!0});return d}(a.BaseObject);c.TemplateContent=e;var b=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.prototype.init=function(){this._target=this.createTargetElement();var a=this._options.bindingInfo;a&&(this.updateCss(),this._lfScope=new q.LifeTimeScope,a=this.getBindingOption(a,this._target,
this._dataContext,"checked"),a.mode=2,this._lfScope.addObj(this.app.bind(a)))};c.prototype.cleanUp=function(){};c.prototype.createCheckBoxView=function(){var b=a.global.document.createElement("input");b.setAttribute("type","checkbox");return new p.CheckBoxElView(this.app,b,{})};c.prototype.createTargetElement=function(){var a=this._target;a||(a=this.createCheckBoxView(),this._el=a.el);this._parentEl.appendChild(this._el);return a};c.prototype.updateCss=function(){b.prototype.updateCss.call(this);
var a=this._el;this.isEditing&&this.getIsCanBeEdited()?a.disabled&&(a.disabled=!1):a.disabled||(a.disabled=!0)};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._lfScope&&(this._lfScope.destroy(),this._lfScope=null),this._target&&(this._target.destroy(),this._target=null),b.prototype.destroy.call(this))};c.prototype.render=function(){this.cleanUp();this.updateCss()};c.prototype.toString=function(){return"BoolContent"};return c}(h);c.BoolContent=b;var d=function(b){function c(d,
e){if("datepicker"!=e.contentOptions.name)throw Error(n.format(a.ERRS.ERR_ASSERTION_FAILED,"contentOptions.name == 'datepicker'"));b.call(this,d,e)}__extends(c,b);c.prototype.getBindingOption=function(a,c,d,e){a=b.prototype.getBindingOption.call(this,a,c,d,e);a.converter=this.app.getConverter("dateConverter");return a};c.prototype.createTargetElement=function(){var b;b=a.global.document;var c={name:null,options:null};this.isEditing&&this.getIsCanBeEdited()?(b=b.createElement("input"),b.setAttribute("type",
"text"),c.options=this._options.options,c.name="datepicker"):b=b.createElement("span");this.updateCss();this._el=b;return this.getElementView(this._el,c)};c.prototype.toString=function(){return"DateContent"};return c}(h);c.DateContent=d;var m=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.prototype.getBindingOption=function(c,d,e,f){c=b.prototype.getBindingOption.call(this,c,d,e,f);c.converter=this.app.getConverter("dateTimeConverter");d=this.getFieldInfo();e=a.global.defaults;
switch(d.dataType){case 6:c.converterParam=e.dateTimeFormat;break;case 7:c.converterParam=e.dateFormat;break;case 8:c.converterParam=e.timeFormat;break;default:c.converterParam=null}return c};c.prototype.toString=function(){return"DateTimeContent"};return c}(h);c.DateTimeContent=m;var f=function(b){function c(){b.apply(this,arguments)}__extends(c,b);Object.defineProperty(c.prototype,"_allowedKeys",{get:function(){c.__allowedKeys||(c.__allowedKeys=[0,8,127,37,39,35,36,9,27,13]);return c.__allowedKeys},
enumerable:!0,configurable:!0});c.prototype.getBindingOption=function(a,c,d,e){a=b.prototype.getBindingOption.call(this,a,c,d,e);switch(this.getFieldInfo().dataType){case 3:a.converter=this.app.getConverter("integerConverter");break;case 4:a.converter=this.app.getConverter("decimalConverter");break;default:a.converter=this.app.getConverter("floatConverter")}return a};c.prototype.render=function(){b.prototype.render.call(this);var a=this;a._target instanceof p.TextBoxElView&&a._target.addOnKeyPress(function(b,
c){c.isCancel=!a.previewKeyPress(c.keyCode,c.value)})};c.prototype.previewKeyPress=function(b,c){var d=String.fromCharCode(b),e=a.global.defaults;return-1<"~@#$%^&*()+=_".indexOf(d)?!1:-1<this._allowedKeys.indexOf(b)||"-"===d&&0===c.length?!0:d===e.decimalPoint?0===c.length?!1:0>c.indexOf(d):d===e.thousandSep?!0:-1<"1234567890".indexOf(d)};c.prototype.toString=function(){return"NumberContent"};c.__allowedKeys=null;return c}(h);c.NumberContent=f;var z=function(a){function b(){a.apply(this,arguments)}
__extends(b,a);Object.defineProperty(b.prototype,"_allowedKeys",{get:function(){b.__allowedKeys||(b.__allowedKeys=[0,8,127,37,39,35,36,9,27,13]);return b.__allowedKeys},enumerable:!0,configurable:!0});b.prototype.render=function(){a.prototype.render.call(this);var b=this,c=b.getFieldInfo();b._target instanceof p.TextBoxElView&&b._target.addOnKeyPress(function(a,d){d.isCancel=!b.previewKeyPress(c,d.keyCode,d.value)})};b.prototype.previewKeyPress=function(a,b,c){return-1<this._allowedKeys.indexOf(b)?
!0:!(0<a.maxLength&&c.length>=a.maxLength)};b.prototype.toString=function(){return"StringContent"};b.__allowedKeys=null;return b}(h);c.StringContent=z;var A=function(b){function c(d,e){if("multyline"!=e.contentOptions.name)throw Error(n.format(a.ERRS.ERR_ASSERTION_FAILED,"contentOptions.name == 'multyline'"));b.call(this,d,e)}__extends(c,b);Object.defineProperty(c.prototype,"_allowedKeys",{get:function(){c.__allowedKeys||(c.__allowedKeys=[0,8,127,37,39,35,36,9,27,13]);return c.__allowedKeys},enumerable:!0,
configurable:!0});c.prototype.createTargetElement=function(){var b,c={name:null,options:null};this.isEditing&&this.getIsCanBeEdited()?(b=a.global.document.createElement("textarea"),c.options=this._options.options,c.name=null):b=a.global.document.createElement("div");this.updateCss();this._el=b;return this.getElementView(this._el,c)};c.prototype.render=function(){b.prototype.render.call(this);var a=this,c=a.getFieldInfo();a._target instanceof p.TextAreaElView&&a._target.addOnKeyPress(function(b,d){d.isCancel=
!a.previewKeyPress(c,d.keyCode,d.value)})};c.prototype.previewKeyPress=function(a,b,c){return-1<this._allowedKeys.indexOf(b)?!0:!(0<a.maxLength&&c.length>=a.maxLength)};c.prototype.toString=function(){return"MultyLineContent"};c.__allowedKeys=null;return c}(h);c.MultyLineContent=A;var C=function(){function c(a,b){this._app=a;this._nextFactory=b}c.prototype.getContentType=function(c){if(c.templateInfo)return e;if(!c.bindingInfo)throw Error(n.format(a.ERRS.ERR_PARAM_INVALID,"options","bindingInfo"));
var v=c.fieldInfo;switch(v.dataType){case 0:v=h;break;case 1:v="multyline"==c.name?A:z;break;case 2:v=b;break;case 3:v=f;break;case 4:case 5:v=f;break;case 6:case 8:v=m;break;case 7:v="datepicker"==c.name?d:m;break;case 9:case 10:v=h;break;default:throw Error(n.format(a.ERRS.ERR_FIELD_DATATYPE,v.dataType));}!v&&this._nextFactory&&(v=this._nextFactory.getContentType(c));if(!v)throw Error(a.ERRS.ERR_BINDING_CONTENT_NOT_FOUND);return v};c.prototype.createContent=function(a){return new (this.getContentType(a.contentOptions))(this.app,
a)};c.prototype.isExternallyCachable=function(a){return!1};Object.defineProperty(c.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return c}();c.ContentFactory=C;var y=function(){function a(b){this._list=[];this._factory=null;this.addFactory(function(a){return new C(b,a)})}a.prototype.addFactory=function(a){this._list.push(a)};a.prototype.init=function(){var a=null;this._list.forEach(function(b){a=b(a)});this._factory=a};a.prototype.getContentType=function(a){this._factory||
this.init();return this._factory.getContentType(a)};a.prototype.createContent=function(a){this._factory||this.init();return this._factory.createContent(a)};a.prototype.isExternallyCachable=function(a){this._factory||this.init();return this._factory.isExternallyCachable(a)};return a}();c.FactoryList=y;c._isModuleLoaded=!0})(t.baseContent||(t.baseContent={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){var c;(function(q){function p(b,c){var d=c.filter(function(a){return a.fieldName==b});if(!d||1!=d.length)throw Error(e.format(a.ERRS.ERR_ASSERTION_FAILED,"arrProps.length == 1"));return d[0]}function k(a,b){function c(a,b,d){if(5==b.fieldType){if(d(a,b),b.nested&&0<b.nested.length){var e,f,m=b.nested.length;for(f=0;f<m;f+=1)e=b.nested[f],5==e.fieldType?c(a+"."+e.fieldName,e,d):d(a+"."+e.fieldName,e)}}else d(a,b)}c(a.fieldName,a,b)}var g=a.MOD.utils,n=a.MOD.errors.ValidationError,
l=g.valueUtils,h=a.baseUtils,e;a.global.addOnInitialize(function(a,b){e=a.utils});c._isCollection=function(a){return a instanceof m};c._getItemByProp=function(a,b){if(a instanceof A)return a.getItemByKey(b);if(a instanceof m)a.getItemByPos(parseInt(b,10));else return null};q.fn_getPropertyByName=p;q.fn_traverseField=k;var b=function(b){function c(a){b.call(this);this.__key=null;this.__isEditing=!1;this._collection=a;this._status=0;this._saveVals=null;this._vals={};this._notEdited=!0}__extends(c,b);
Object.defineProperty(c.prototype,"_isEditing",{get:function(){return this.__isEditing},set:function(a){this.__isEditing!=a&&(this.__isEditing=a,this.raisePropertyChanged("isEditing"))},enumerable:!0,configurable:!0});c.prototype._getEventNames=function(){var a=b.prototype._getEventNames.call(this);return["errors_changed"].concat(a)};c.prototype._onErrorsChanged=function(a){this.raiseEvent("errors_changed",a)};c.prototype.handleError=function(a,c){var d=b.prototype.handleError.call(this,a,c);return d?
d:this.collection.handleError(a,c)};c.prototype._beginEdit=function(){var b=this.collection;if(b.isEditing){var c=b._getInternal().getEditingItem();if(c._aspect===this)return!1;try{c._aspect.endEdit(),c._aspect.getIsHasErrors()&&(this.handleError(new n(c._aspect.getAllErrors(),c),c),c._aspect.cancelEdit())}catch(d){b=this.handleError(d,c),c._aspect.cancelEdit(),a.reThrow(d,b)}}if(!this.key)return!1;this._isEditing=!0;this._saveVals=e.cloneObj(this._vals);this.collection.currentItem=this.getItem();
return!0};c.prototype._endEdit=function(){if(!this.__isEditing)return!1;var a=this.collection;if(this.getIsHasErrors())return!1;a._getInternal().removeAllErrors(this.getItem());var b=this._validateAll();0<b.length&&a._getInternal().addErrors(this.getItem(),b);if(this.getIsHasErrors())return!1;this._isEditing=!1;this._saveVals=null;return!0};c.prototype._cancelEdit=function(){if(!this._isEditing)return!1;var a=this.collection,b=this.isNew,c=this,d=this._saveVals;this._vals=this._saveVals;this._saveVals=
null;a._getInternal().removeAllErrors(this.getItem());a.getFieldNames().forEach(function(a){d[a]!==c._vals[a]&&c.raisePropertyChanged(a)});this._isEditing=!1;b&&this._notEdited&&a.removeItem(this.getItem());return!0};c.prototype._validate=function(){return this.collection._getInternal().validateItem(this.getItem())};c.prototype._skipValidate=function(a,b){return!1};c.prototype._validateField=function(b){var c,d=this.getFieldInfo(b),e=null;try{c=h.getValue(this._vals,b);if(this._skipValidate(d,c))return e;
if(this.isNew){if(null===c&&!d.isNullable&&!d.isReadOnly&&!d.isAutoGenerated)throw Error(a.ERRS.ERR_FIELD_ISNOT_NULLABLE);}else if(null===c&&!d.isNullable&&!d.isReadOnly)throw Error(a.ERRS.ERR_FIELD_ISNOT_NULLABLE);}catch(f){e={fieldName:b,errors:[f.message]}}b=this.collection._getInternal().validateItemField(this.getItem(),b);e&&b?e.errors=e.errors.concat(b.errors):b&&(e=b);return e};c.prototype._validateAll=function(){var a=this,b=[];this.collection.getFieldInfos().forEach(function(c){k(c,function(c,
d){if(5!=d.fieldType){var e=a._validateField(c);e&&b.push(e)}})});var c=a._validate();c&&b.push(c);return b};c.prototype._checkVal=function(b,c){var d=c,f=a.ERRS;if(this._skipValidate(b,c))return d;if(b.isReadOnly&&(!b.allowClientDefault||!this.isNew))throw Error(f.ERR_FIELD_READONLY);if((null===c||e.check.isString(c)&&!c)&&!b.isNullable)throw Error(f.ERR_FIELD_ISNOT_NULLABLE);if(null===c)return c;switch(b.dataType){case 0:break;case 9:case 1:if(!e.check.isString(c))throw Error(e.format(f.ERR_FIELD_WRONG_TYPE,
c,"String"));if(0<b.maxLength&&c.length>b.maxLength)throw Error(e.format(f.ERR_FIELD_MAXLEN,b.maxLength));b.isNullable&&""===c&&(d=null);if(b.regex&&!(new RegExp(b.regex,"i")).test(c))throw Error(e.format(f.ERR_FIELD_REGEX,c));break;case 10:if(!e.check.isArray(c))throw Error(e.format(f.ERR_FIELD_WRONG_TYPE,c,"Array"));if(0<b.maxLength&&c.length>b.maxLength)throw Error(e.format(f.ERR_FIELD_MAXLEN,b.maxLength));break;case 2:if(!e.check.isBoolean(c))throw Error(e.format(f.ERR_FIELD_WRONG_TYPE,c,"Boolean"));
break;case 3:case 4:case 5:if(!e.check.isNumber(c))throw Error(e.format(f.ERR_FIELD_WRONG_TYPE,c,"Number"));b.range&&e.validation.checkNumRange(Number(c),b.range);break;case 6:case 7:if(!e.check.isDate(c))throw Error(e.format(f.ERR_FIELD_WRONG_TYPE,c,"Date"));b.range&&e.validation.checkDateRange(c,b.range);break;case 8:if(!e.check.isDate(c))throw Error(e.format(f.ERR_FIELD_WRONG_TYPE,c,"Time"));break;default:throw Error(e.format(f.ERR_PARAM_INVALID,"dataType",b.dataType));}return d};c.prototype._resetIsNew=
function(){};c.prototype._onAttaching=function(){};c.prototype._onAttach=function(){};c.prototype.raiseErrorsChanged=function(a){this._onErrorsChanged(a)};c.prototype.getFieldInfo=function(a){return this.collection.getFieldInfo(a)};c.prototype.getFieldNames=function(){return this.collection.getFieldNames()};c.prototype.getErrorString=function(){var a=this.collection._getInternal().getErrors(this.getItem());if(!a)return"";var b=[];e.forEachProp(a,function(c){b.push(h.format("{0}: {1}",c,a[c]))});return b.join("|")};
c.prototype.submitChanges=function(){var a=e.createDeferred();a.reject();return a.promise()};c.prototype.rejectChanges=function(){};c.prototype.beginEdit=function(){var a=this.collection;if(!this._beginEdit())return!1;a._getInternal().onEditing(this.getItem(),!0,!1);return!0};c.prototype.endEdit=function(){var a=this.collection;if(!this._endEdit())return!1;a._getInternal().onEditing(this.getItem(),!1,!1);this._notEdited=!1;return!0};c.prototype.cancelEdit=function(){var a=this.collection;if(!this._cancelEdit())return!1;
a._getInternal().onEditing(this.getItem(),!1,!0);return!0};c.prototype.deleteItem=function(){var a=this.collection;if(!this.key)return!1;var b={item:this.getItem(),isCancel:!1};a._getInternal().onItemDeleting(b);if(b.isCancel)return!1;a.removeItem(this.getItem());return!0};c.prototype.getIsHasErrors=function(){return!!this.collection._getInternal().getErrors(this.getItem())};c.prototype.addOnErrorsChanged=function(a,b,c){this._addHandler("errors_changed",a,b,c)};c.prototype.removeOnErrorsChanged=
function(a){this._removeHandler("errors_changed",a)};c.prototype.getFieldErrors=function(a){var b=this.collection._getInternal().getErrors(this.getItem());if(!b)return[];var c=a;a||(a="*");if(!b[a])return[];"*"==a&&(c=null);return[{fieldName:c,errors:b[a]}]};c.prototype.getAllErrors=function(){var a=this.collection._getInternal().getErrors(this.getItem());if(!a)return[];var b=[];e.forEachProp(a,function(c){var d=null;"*"!==c&&(d=c);b.push({fieldName:d,errors:a[c]})});return b};c.prototype.getIErrorNotification=
function(){return this};c.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this._collection,c=this.getItem();a&&!a.getIsClearing()&&c&&c._key&&a.removeItem(c);c&&!c.getIsDestroyCalled()&&c.destroy();this._saveVals=this.__key=null;this._vals={};this._isEditing=!1;this._collection=null;b.prototype.destroy.call(this)}};c.prototype.toString=function(){return"ItemAspect"};c.prototype.getItem=function(){throw Error("Not implemented");};Object.defineProperty(c.prototype,
"isCanSubmit",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isNew",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isDeleted",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"key",{get:function(){return this.__key},set:function(a){null!==a&&(a=""+a);this.__key=
a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"collection",{get:function(){return this._collection},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isUpdating",{get:function(){var a=this.collection;return a?a.isUpdating:!1},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isEditing",{get:function(){return this.__isEditing},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isHasChanges",{get:function(){return 0!==this._status},
enumerable:!0,configurable:!0});return c}(a.BaseObject);q.ItemAspect=b;var d={begin_edit:"begin_edit",end_edit:"end_edit",fill:"fill",collection_changed:"coll_changed",item_deleting:"item_deleting",item_adding:"item_adding",item_added:"item_added",validate:"validate",current_changing:"current_changing",page_changing:"page_changing",errors_changed:"errors_changed",status_changed:"status_changed",clearing:"clearing",cleared:"cleared",commit_changes:"commit_changes"},m=function(b){function c(){b.call(this);
var a=this;this._options={enablePaging:!1,pageSize:50};this._isUpdating=this._isClearing=this._isLoading=!1;this._EditingItem=null;this._perms={canAddRow:!0,canEditRow:!0,canDeleteRow:!0,canRefreshRow:!1};this._pageIndex=this._totalCount=0;this._items=[];this._itemsByKey={};this._currentPos=-1;this._newKey=0;this._fieldMap={};this._fieldInfos=[];this._errors={};this._ignoreChangeErrors=!1;this._pkInfo=null;this._waitQueue=new g.WaitQueue(this);this._internal={getEditingItem:function(){return a._getEditingItem()},
getStrValue:function(b,c){return a._getStrValue(b,c)},onEditing:function(b,c,d){a._onEditing(b,c,d)},onCommitChanges:function(b,c,d,e){a._onCommitChanges(b,c,d,e)},validateItem:function(b){return a._validateItem(b)},validateItemField:function(b,c){return a._validateItemField(b,c)},addErrors:function(b,c){a._addErrors(b,c)},addError:function(b,c,d){a._addError(b,c,d)},removeError:function(b,c){a._removeError(b,c)},removeAllErrors:function(b){a._removeAllErrors(b)},getErrors:function(b){return a._getErrors(b)},
onErrorsChanged:function(b){a._onErrorsChanged(b)},onItemDeleting:function(b){return a._onItemDeleting(b)}}}__extends(c,b);c.getEmptyFieldInfo=function(a){return{fieldName:a,isPrimaryKey:0,dataType:0,isNullable:!0,maxLength:-1,isReadOnly:!1,isAutoGenerated:!1,allowClientDefault:!1,dateConversion:0,fieldType:1,isNeedOriginal:!1,range:null,regex:null,nested:null,dependentOn:null,fullName:null}};c.prototype._getEventNames=function(){var a=b.prototype._getEventNames.call(this);return Object.keys(d).map(function(a,
b,c){return d[a]}).concat(a)};c.prototype.handleError=function(c,d){var e=b.prototype.handleError.call(this,c,d);return e?e:a.global.handleError(c,d)};c.prototype.addOnClearing=function(a,b,c,e){this._addHandler(d.clearing,a,b,c,e)};c.prototype.removeOnClearing=function(a){this._removeHandler(d.clearing,a)};c.prototype.addOnCleared=function(a,b,c,e){this._addHandler(d.cleared,a,b,c,e)};c.prototype.removeOnCleared=function(a){this._removeHandler(d.cleared,a)};c.prototype.addOnFill=function(a,b,c,e){this._addHandler(d.fill,
a,b,c,e)};c.prototype.removeOnFill=function(a){this._removeHandler(d.fill,a)};c.prototype.addOnCollChanged=function(a,b,c,e){this._addHandler(d.collection_changed,a,b,c,e)};c.prototype.removeOnCollChanged=function(a){this._removeHandler(d.collection_changed,a)};c.prototype.addOnValidate=function(a,b,c,e){this._addHandler(d.validate,a,b,c,e)};c.prototype.removeOnValidate=function(a){this._removeHandler(d.validate,a)};c.prototype.addOnItemDeleting=function(a,b,c,e){this._addHandler(d.item_deleting,
a,b,c,e)};c.prototype.removeOnItemDeleting=function(a){this._removeHandler(d.item_deleting,a)};c.prototype.addOnItemAdding=function(a,b,c,e){this._addHandler(d.item_adding,a,b,c,e)};c.prototype.removeOnItemAdding=function(a){this._removeHandler(d.item_adding,a)};c.prototype.addOnItemAdded=function(a,b,c,e){this._addHandler(d.item_added,a,b,c,e)};c.prototype.removeOnItemAdded=function(a){this._removeHandler(d.item_added,a)};c.prototype.addOnCurrentChanging=function(a,b,c,e){this._addHandler(d.current_changing,
a,b,c,e)};c.prototype.removeOnCurrentChanging=function(a){this._removeHandler(d.current_changing,a)};c.prototype.addOnPageChanging=function(a,b,c,e){this._addHandler(d.page_changing,a,b,c,e)};c.prototype.removeOnPageChanging=function(a){this._removeHandler(d.page_changing,a)};c.prototype.addOnErrorsChanged=function(a,b,c,e){this._addHandler(d.errors_changed,a,b,c,e)};c.prototype.removeOnErrorsChanged=function(a){this._removeHandler(d.errors_changed,a)};c.prototype.addOnBeginEdit=function(a,b,c,e){this._addHandler(d.begin_edit,
a,b,c,e)};c.prototype.removeOnBeginEdit=function(a){this._removeHandler(d.begin_edit,a)};c.prototype.addOnEndEdit=function(a,b,c,e){this._addHandler(d.end_edit,a,b,c,e)};c.prototype.removeOnEndEdit=function(a){this._removeHandler(d.end_edit,a)};c.prototype.addOnCommitChanges=function(a,b,c,e){this._addHandler(d.commit_changes,a,b,c,e)};c.prototype.removeOnCommitChanges=function(a){this._removeHandler(d.commit_changes,a)};c.prototype.addOnStatusChanged=function(a,b,c,e){this._addHandler(d.status_changed,
a,b,c,e)};c.prototype.removeOnStatusChanged=function(a){this._removeHandler(d.status_changed,a)};c.prototype.addOnPageIndexChanged=function(a,b,c){this.addOnPropertyChange("pageIndex",a,b,c)};c.prototype.addOnPageSizeChanged=function(a,b,c){this.addOnPropertyChange("pageSize",a,b,c)};c.prototype.addOnTotalCountChanged=function(a,b,c){this.addOnPropertyChange("totalCount",a,b,c)};c.prototype.addOnCurrentChanged=function(a,b,c){this.addOnPropertyChange("currentItem",a,b,c)};c.prototype._getPKFieldInfos=
function(){if(this._pkInfo)return this._pkInfo;var a=this._fieldMap,b=[];e.forEachProp(a,function(c){0<a[c].isPrimaryKey&&b.push(a[c])});b.sort(function(a,b){return a.isPrimaryKey-b.isPrimaryKey});return this._pkInfo=b};c.prototype._onCurrentChanging=function(b){try{this.endEdit()}catch(c){a.reThrow(c,this.handleError(c,this))}this.raiseEvent(d.current_changing,{newCurrent:b})};c.prototype._onCurrentChanged=function(){this.raisePropertyChanged("currentItem")};c.prototype._onCountChanged=function(){this.raisePropertyChanged("count")};
c.prototype._onEditingChanged=function(){this.raisePropertyChanged("isEditing")};c.prototype._onItemStatusChanged=function(a,b){this.raiseEvent(d.status_changed,{item:a,oldStatus:b,key:a._key})};c.prototype._onFillStart=function(a){this.raiseEvent(d.fill,a)};c.prototype._onFillEnd=function(a){this.raiseEvent(d.fill,a)};c.prototype._onCollectionChanged=function(a){this.raiseEvent(d.collection_changed,a)};c.prototype._onItemAdding=function(b){b={item:b,isCancel:!1};this.raiseEvent(d.item_adding,b);
b.isCancel&&a.throwDummy(Error("operation canceled"))};c.prototype._onItemAdded=function(a){this.raiseEvent(d.item_added,{item:a,isAddNewHandled:!1})};c.prototype._createNew=function(){throw Error("_createNew Not implemented");};c.prototype._attach=function(b,c){if(this._itemsByKey[b._key])throw Error(a.ERRS.ERR_ITEM_IS_ATTACHED);try{this.endEdit()}catch(d){a.reThrow(d,this.handleError(d,this))}var f;b._aspect._onAttaching();e.check.isNt(c)?(f=this._items.length,this._items.push(b)):(f=c,e.insertIntoArray(this._items,
b,f));this._itemsByKey[b._key]=b;this._onCollectionChanged({changeType:1,items:[b],pos:[f]});b._aspect._onAttach();this.raisePropertyChanged("count");this._onCurrentChanging(b);this._currentPos=f;this._onCurrentChanged();return f};c.prototype._onRemoved=function(a,b){try{this._onCollectionChanged({changeType:0,items:[a],pos:[b]})}finally{this.raisePropertyChanged("count")}};c.prototype._onPageSizeChanged=function(){};c.prototype._onPageChanging=function(){var b={page:this.pageIndex,isCancel:!1};this._raiseEvent(d.page_changing,
b);if(!b.isCancel)try{this.endEdit()}catch(c){a.reThrow(c,this.handleError(c,this))}return!b.isCancel};c.prototype._onPageChanged=function(){};c.prototype._setCurrentItem=function(b){var c=this._currentPos;if(b){if(!b._key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);var d,e;if(!this.getItemByKey(b._key))throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);d=this.getItemByPos(c);e=this._items.indexOf(b);if(0>e)throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);if(c!==e||d!==b)this._onCurrentChanging(b),this._currentPos=e,
this._onCurrentChanged()}else-1!==c&&(this._onCurrentChanging(null),this._currentPos=-1,this._onCurrentChanged())};c.prototype._destroyItems=function(){this._items.forEach(function(a){a._aspect.destroy()})};c.prototype._isHasProp=function(c){return h.startsWith(c,"[")?(c=a.global.parser.resolveProp(this,c),!h.isUndefined(c)):b.prototype._isHasProp.call(this,c)};c.prototype._getEditingItem=function(){return this._EditingItem};c.prototype._getStrValue=function(a,b){var c=b.dateConversion,d=e.get_timeZoneOffset();
return l.stringifyValue(a,c,b.dataType,d)};c.prototype._onEditing=function(a,b,c){this._isUpdating||(b?(this._EditingItem=a,this.raiseEvent(d.begin_edit,{item:a})):(this._EditingItem=null,this.raiseEvent(d.end_edit,{item:a,isCanceled:c})),this._onEditingChanged())};c.prototype._onCommitChanges=function(a,b,c,e){this.raiseEvent(d.commit_changes,{item:a,isBegin:b,isRejected:c,status:e})};c.prototype._validateItem=function(a){a={item:a,fieldName:null,errors:[]};this.raiseEvent(d.validate,a);return a.errors&&
0<a.errors.length?{fieldName:null,errors:a.errors}:null};c.prototype._validateItemField=function(a,b){var c={item:a,fieldName:b,errors:[]};this.raiseEvent(d.validate,c);return c.errors&&0<c.errors.length?{fieldName:b,errors:c.errors}:null};c.prototype._addErrors=function(a,b){var c=this;this._ignoreChangeErrors=!0;try{b.forEach(function(b){c._addError(a,b.fieldName,b.errors)})}finally{this._ignoreChangeErrors=!1}this._onErrorsChanged(a)};c.prototype._addError=function(a,b,c){b||(b="*");e.check.isArray(c)&&
0<c.length?(this._errors[a._key]||(this._errors[a._key]={}),this._errors[a._key][b]=c,this._ignoreChangeErrors||this._onErrorsChanged(a)):this._removeError(a,b)};c.prototype._removeError=function(a,b){var c=this._errors[a._key];c&&(b||(b="*"),c[b]&&(delete c[b],0===e.getProps(c).length&&delete this._errors[a._key],this._onErrorsChanged(a)))};c.prototype._removeAllErrors=function(a){this._errors[a._key]&&(delete this._errors[a._key],this._onErrorsChanged(a))};c.prototype._getErrors=function(a){return this._errors[a._key]};
c.prototype._onErrorsChanged=function(a){this.raiseEvent(d.errors_changed,{item:a});a._aspect.raiseErrorsChanged({})};c.prototype._onItemDeleting=function(a){this.raiseEvent(d.item_deleting,a);return!a.isCancel};c.prototype._getInternal=function(){return this._internal};c.prototype.getFieldInfo=function(b){var c=b.split("."),d=this._fieldMap[c[0]];if(1==c.length)return d;if(5==d.fieldType){for(b=1;b<c.length;b+=1)d=p(c[b],d.nested);return d}throw Error(h.format(a.ERRS.ERR_PARAM_INVALID,"fieldName",
b));};c.prototype.getFieldNames=function(){return this.getFieldInfos().map(function(a){return a.fieldName})};c.prototype.getIsClearing=function(){return this._isClearing};c.prototype.getFieldInfos=function(){return this._fieldInfos};c.prototype.cancelEdit=function(){this.isEditing&&this._EditingItem._aspect.cancelEdit()};c.prototype.endEdit=function(){var a;this.isEditing&&(a=this._EditingItem,!a._aspect.endEdit()&&a._aspect.getIsHasErrors()&&(this.handleError(new n(a._aspect.getAllErrors(),a),a),
this.cancelEdit()))};c.prototype.getItemsWithErrors=function(){var a=this,b=[];e.forEachProp(this._errors,function(c){c=a.getItemByKey(c);b.push(c)});return b};c.prototype.addNew=function(){var b,c;b=this._createNew();this._onItemAdding(b);this._attach(b,null);try{this.currentItem=b,b._aspect.beginEdit(),this._onItemAdded(b)}catch(d){c=this.handleError(d,this),b._aspect.cancelEdit(),a.reThrow(d,c)}return b};c.prototype.getItemByPos=function(a){return 0>a||a>=this._items.length?null:this._items[a]};
c.prototype.getItemByKey=function(b){if(!b)throw Error(a.ERRS.ERR_KEY_IS_EMPTY);return this._itemsByKey[""+b]};c.prototype.findByPK=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];if(0===arguments.length)return null;var b=this._getPKFieldInfos(),c=[],d=[],d=1===a.length&&e.check.isArray(a[0])?a[0]:a;if(d.length!==b.length)return null;for(var a=0,f=b.length;a<f;a+=1)c.push(this._getStrValue(d[a],b[a]));b=c.join(";");return this.getItemByKey(b)};c.prototype.moveFirst=function(a){if(0===
this._currentPos)return!1;var b=this.getItemByPos(0);if(!b)return!1;if(a&&b._aspect.isDeleted)return this.moveNext(!0);this._onCurrentChanging(b);this._currentPos=0;this._onCurrentChanged();return!0};c.prototype.movePrev=function(a){var b=-1,c=this._currentPos,d=this.getItemByPos(c);d&&(b=c,--b);d=this.getItemByPos(b);if(!d)return!1;if(a&&d._aspect.isDeleted)return this._currentPos=b,this.movePrev(!0);this._onCurrentChanging(d);this._currentPos=b;this._onCurrentChanged();return!0};c.prototype.moveNext=
function(a){var b=-1,c=this._currentPos,d=this.getItemByPos(c);d&&(b=c+1);d=this.getItemByPos(b);if(!d)return!1;if(a&&d._aspect.isDeleted)return this._currentPos=b,this.moveNext(!0);this._onCurrentChanging(d);this._currentPos=b;this._onCurrentChanged();return!0};c.prototype.moveLast=function(a){var b=this._items.length-1;if(this._currentPos===b)return!1;var c=this.getItemByPos(b);if(!c)return!1;if(a&&c._aspect.isDeleted)return this.movePrev(!0);this._onCurrentChanging(c);this._currentPos=b;this._onCurrentChanged();
return!0};c.prototype.goTo=function(a){if(this._currentPos===a)return!1;var b=this.getItemByPos(a);if(!b)return!1;this._onCurrentChanging(b);this._currentPos=a;this._onCurrentChanged();return!0};c.prototype.forEach=function(a,b){this._items.forEach(a,b)};c.prototype.removeItem=function(b){if(!b._key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);if(this._itemsByKey[b._key]){var c=e.removeFromArray(this._items,b);if(0>c)throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);delete this._itemsByKey[b._key];delete this._errors[b._key];
this._onRemoved(b,c);b._key=null;b._aspect.removeNSHandlers(null);b=this.getItemByPos(c);var d=this._currentPos;d===c&&(b||(this._currentPos=d-1),this._onCurrentChanged());d>c&&(this._currentPos=d-1,this._onCurrentChanged())}};c.prototype.getIsHasErrors=function(){return this._errors?0<e.getProps(this._errors).length:!1};c.prototype.sort=function(a,b){return this.sortLocal(a,b)};c.prototype.sortLocal=function(a,b){var c=1;1===b&&(c=-1);return this.sortLocalByFunc(function(b,d){var e=0,f,u,x;f=0;for(u=
a.length;f<u&&(x=a[f],e=b[x],x=d[x],e=e<x?-1*c:e>x?c:0,0===e);f+=1);return e})};c.prototype.sortLocalByFunc=function(a){var b=this,c=e.createDeferred();this.waitForNotLoading(function(){var d=b.currentItem;b.isLoading=!0;try{b._items.sort(a),b._onCollectionChanged({changeType:2,items:[],pos:[]})}finally{b.isLoading=!1,c.resolve()}b.currentItem=null;b.currentItem=d},[],!1,null);return c.promise()};c.prototype.clear=function(){this._isClearing=!0;try{this.raiseEvent(d.clearing,{}),this.cancelEdit(),
this._EditingItem=null,this._newKey=0,this.currentItem=null,this._destroyItems(),this._items=[],this._itemsByKey={},this._errors={},this._onCollectionChanged({changeType:2,items:[],pos:[]})}finally{this._isClearing=!1}this.raiseEvent(d.cleared,{});this.raisePropertyChanged("count")};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._waitQueue.destroy(),this._waitQueue=null,this.clear(),this._fieldMap={},this._fieldInfos=[],b.prototype.destroy.call(this))};c.prototype.waitForNotLoading=
function(a,b,c,d){this._waitQueue.enQueue({prop:"isLoading",groupName:null,predicate:function(a){return!a},action:a,actionArgs:b,lastWins:!!d,syncCheck:!!c})};c.prototype.toString=function(){return"Collection"};Object.defineProperty(c.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"currentItem",{get:function(){return this.getItemByPos(this._currentPos)},set:function(a){this._setCurrentItem(a)},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"count",{get:function(){return this._items.length},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"totalCount",{get:function(){return this._totalCount},set:function(a){a!=this._totalCount&&(this._totalCount=a,this.raisePropertyChanged("totalCount"),this.raisePropertyChanged("pageCount"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"pageSize",{get:function(){return this._options.pageSize},set:function(a){this._options.pageSize!==
a&&(this._options.pageSize=a,this.raisePropertyChanged("pageSize"),this._onPageSizeChanged())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"pageIndex",{get:function(){return this._pageIndex},set:function(a){a===this._pageIndex||!this.isPagingEnabled||0>a||!this._onPageChanging()||(this._pageIndex=a,this._onPageChanged(),this.raisePropertyChanged("pageIndex"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"items",{get:function(){return this._items},enumerable:!0,
configurable:!0});Object.defineProperty(c.prototype,"isPagingEnabled",{get:function(){return this._options.enablePaging},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"permissions",{get:function(){return this._perms},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isEditing",{get:function(){return!!this._EditingItem},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isLoading",{get:function(){return this._isLoading},set:function(a){this._isLoading!==
a&&(this._isLoading=a,this.raisePropertyChanged("isLoading"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isUpdating",{get:function(){return this._isUpdating},set:function(a){this._isUpdating!==a&&(this._isUpdating=a,this.raisePropertyChanged("isUpdating"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"pageCount",{get:function(){var a=this.totalCount,b=this.pageSize;return 0===a||0===b?0:a=0===a%b?a/b:Math.floor(a/b)+1},enumerable:!0,configurable:!0});
return c}(a.BaseObject);q.BaseCollection=m;var f=function(a){function b(c){a.call(this);this.f_aspect=c}__extends(b,a);Object.defineProperty(b.prototype,"_aspect",{get:function(){return this.f_aspect},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_key",{get:function(){return this.f_aspect?this.f_aspect.key:null},set:function(a){this.f_aspect&&(this.f_aspect.key=a)},enumerable:!0,configurable:!0});b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.f_aspect&&
!this.f_aspect.getIsDestroyCalled()&&this.f_aspect.destroy(),a.prototype.destroy.call(this))};b.prototype.toString=function(){return"CollectionItem"};return b}(a.BaseObject);q.CollectionItem=f;var z=function(a){function b(c,d,e){a.call(this,c);this.__isNew=e?!1:!0;this._item=null;this._vals=e?e:b._initVals(c,e);this._item=new d(this)}__extends(b,a);b._initVals=function(a,b){var c=b||{};b&&a.getFieldInfos().forEach(function(a){5!=a.fieldType?c[a.fieldName]=null:k(a,function(a,b){5==b.fieldType?h.setValue(c,
a,{},!1):h.setValue(c,a,null,!1)})});return c};b.prototype._setProp=function(a,b){var c,d=this.collection;if(this._getProp(a)!==b)try{if(h.setValue(this._vals,a,b,!1),this.getItem().raisePropertyChanged(a),d._getInternal().removeError(this.getItem(),a),c=this._validateField(a))throw new n([c],this);}catch(e){throw c=e instanceof n?e:new n([{fieldName:a,errors:[e.message]}],this),d._getInternal().addError(this.getItem(),a,c.errors[0].errors),c;}};b.prototype._getProp=function(a){return h.getValue(this._vals,
a)};b.prototype._resetIsNew=function(){this.__isNew=!1};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,a.prototype.destroy.call(this),this._item=null)};b.prototype.getItem=function(){return this._item};b.prototype.toString=function(){return this._item?this._item.toString()+"Aspect":"ListItemAspect"};Object.defineProperty(b.prototype,"vals",{get:function(){return this._vals},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isNew",{get:function(){return this.__isNew},
enumerable:!0,configurable:!0});return b}(b);q.ListItemAspect=z;b=function(b){function c(a,d){b.call(this);this._itemType=a;d&&this._updateFieldMap(d)}__extends(c,b);c.prototype._updateFieldMap=function(b){var c=this;if(!e.check.isArray(b)||0==b.length)throw Error(h.format(a.ERRS.ERR_PARAM_INVALID,"props",b));c._fieldMap={};c._fieldInfos=[];b.forEach(function(a){var b=m.getEmptyFieldInfo(a.name);b.dataType=a.dtype;c._fieldMap[a.name]=b;c._fieldInfos.push(b);k(b,function(a,b){b.dependents=null;b.fullName=
a})})};c.prototype._attach=function(c){try{this.endEdit()}catch(d){a.reThrow(d,this.handleError(d,this))}return b.prototype._attach.call(this,c)};c.prototype._createNew=function(){var a=new z(this,this._itemType,null);a.key=this._getNewKey(null);return a.getItem()};c.prototype._getNewKey=function(a){a="clkey_"+this._newKey;this._newKey+=1;return a};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._itemType=null,b.prototype.destroy.call(this))};c.prototype.fillItems=
function(a,b){var c=this,d=[],e=[],f=[];a||(a=[]);this._onFillStart({isBegin:!0,rowCount:a.length,time:new Date,isPageChanged:!1});try{b&&this.clear(),a.forEach(function(a){a=new z(c,c._itemType,a);var b=a.getItem();a.key=c._getNewKey(b);var x=c._itemsByKey[a.key];x?f.push(x):(c._items.push(b),c._itemsByKey[a.key]=b,d.push(b),e.push(c._items.length-1),f.push(b))}),0<d.length&&(this._onCollectionChanged({changeType:1,items:d,pos:e}),this.raisePropertyChanged("count"))}finally{this._onFillEnd({isBegin:!1,
rowCount:f.length,time:new Date,resetUI:!!b,fetchedItems:f,newItems:d,isPageChanged:!1})}this.moveFirst()};c.prototype.toArray=function(){return this.items.map(function(a,b,c){return e.cloneObj(a._aspect.vals)})};c.prototype.getNewObjects=function(){return this._items.filter(function(a){return a._aspect.isNew})};c.prototype.resetNewObjects=function(){this._items.forEach(function(a){a._aspect._resetIsNew()})};c.prototype.toString=function(){return"BaseList"};return c}(m);q.BaseList=b;var A=function(b){function c(d,
e,f){if(!e)throw Error(h.format(a.ERRS.ERR_PARAM_INVALID,"keyName",e));this._keyName=e;b.call(this,d,f);d=this.getFieldInfo(e);if(!d)throw Error(h.format(a.ERRS.ERR_DICTKEY_IS_NOTFOUND,e));d.isPrimaryKey=1}__extends(c,b);c.prototype._getNewKey=function(c){if(!c)return b.prototype._getNewKey.call(this,null);c=c[this._keyName];if(e.check.isNt(c))throw Error(h.format(a.ERRS.ERR_DICTKEY_IS_EMPTY,this.keyName));return""+c};c.prototype._onItemAdded=function(a){b.prototype._onItemAdded.call(this,a);this.raisePropertyChanged("["+
a[this._keyName]+"]")};c.prototype._onRemoved=function(a,c){var d=a[this._keyName];b.prototype._onRemoved.call(this,a,c);this.raisePropertyChanged("["+d+"]")};Object.defineProperty(c.prototype,"keyName",{get:function(){return this._keyName},enumerable:!0,configurable:!0});c.prototype.toString=function(){return"BaseDictionary"};return c}(b);q.BaseDictionary=A;q._isModuleLoaded=!0})(c=t.collection||(t.collection={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=a.consts,p=a.MOD.binding,k=a.MOD.baseElView,g=a.MOD.baseContent;c.css={dataform:"ria-dataform"};var n=a.localizable.VALIDATE,l;a.global.addOnInitialize(function(a,c){l=a.utils});c._setIsInsideTemplate=function(a){a instanceof e&&(a.form.isInsideTemplate=!0)};c._isDataForm=function(b){if(!b)return!1;if(b.hasAttribute(q.DATA_ATTR.DATA_FORM))return!0;b=b.getAttribute(q.DATA_ATTR.DATA_VIEW);if(!b)return!1;b=a.global.parser.parseOptions(b);return 0<b.length&&
b[0].name===q.ELVIEW_NM.DATAFORM};c._isInsideDataForm=function(a){return a?(a=a.parentElement)?c._isDataForm(a)?!0:c._isInsideDataForm(a):!1:!1};c._isInNestedForm=function(a,c,e){var f,h=c.length;if(0==h)return!1;for(f=e.parentElement;f;){for(e=0;e<h;e+=1)if(f===c[e])return!0;if(a&&f===a)break;f=f.parentElement}return!1};c._getParentDataForm=function(a,d){if(!d)return null;var e=d.parentElement;return e?e===a?a:c._isDataForm(e)?e:c._getParentDataForm(a,e):null};var h=function(b){function d(d){b.call(this);
var e=this;d=l.extend(!1,{app:null,el:null},d);this._app=d.app;this._el=d.el;this._$el=a.global.$(this._el);this._objId="frm"+a.baseUtils.getNewID();this._dataContext=null;this._$el.addClass(c.css.dataform);this._isEditing=!1;this._content=[];this._lfTime=null;this._contentCreated=!1;this._errors=this._parentDataForm=this._supportErrNotify=this._supportEdit=null;if(d=c._getParentDataForm(null,this._el))e._parentDataForm=this._app.getElementView(d),e._parentDataForm.addOnDestroyed(function(a,b){e._isDestroyCalled||
e.destroy()},e._objId)}__extends(d,b);Object.defineProperty(d.prototype,"_DATA_CONTENT_SELECTOR",{get:function(){return"*["+q.DATA_ATTR.DATA_CONTENT+"]:not(["+q.DATA_ATTR.DATA_COLUMN+"])"},enumerable:!0,configurable:!0});d.prototype.handleError=function(a,c){var d=b.prototype.handleError.call(this,a,c);return d?d:this._app.handleError(a,c)};d.prototype._getBindings=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),b=[],c=0,d=a.length;c<d;c+=1)p._isBinding(a[c])&&b.push(a[c]);return b};
d.prototype._getElViews=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),b=[],c=0,d=a.length;c<d;c+=1)k._isElView(a[c])&&b.push(a[c]);return b};d.prototype._createContent=function(){var b=this._dataContext,d=this;if(b){var e=a.ArrayHelper.fromList(this._el.querySelectorAll(d._DATA_CONTENT_SELECTOR)),h=this.isEditing,n=["*[",q.DATA_ATTR.DATA_FORM,"]"].join(""),k=a.ArrayHelper.fromList(this._el.querySelectorAll(n));e.forEach(function(e){if(!c._isInNestedForm(d._el,k,e)){var n=e.getAttribute(q.DATA_ATTR.DATA_CONTENT),
n=g.parseContentAttr(n);if(n.fieldName&&!n.fieldInfo){var z;z=n.fieldName;z=b?b._aspect&&l.check.isFunction(b._aspect.getFieldInfo)?b._aspect.getFieldInfo(z):l.check.isFunction(b.getFieldInfo)?b.getFieldInfo(z):null:null;n.fieldInfo=z;if(!n.fieldInfo)throw Error(l.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,"",n.fieldName));}e=new (d.app._getInternal().getContentType(n))(d.app,{parentEl:e,contentOptions:n,dataContext:b,isEditing:h});d._content.push(e)}});this._lfTime=d.app._getInternal().bindElements(this._el,
b,!0,this.isInsideTemplate);this._getBindings().forEach(function(a){a.isSourceFixed||(a.source=b)});this._contentCreated=!0}};d.prototype._updateContent=function(){try{var b=this._dataContext,c=this;this._contentCreated?(this._content.forEach(function(a){a.dataContext=b;a.isEditing=c.isEditing}),this._getBindings().forEach(function(a){a.isSourceFixed||(a.source=b)})):this._createContent()}catch(d){a.reThrow(d,this.handleError(d,this))}};d.prototype._onDSErrorsChanged=function(a,b){this._supportErrNotify&&
(this.validationErrors=this._supportErrNotify.getAllErrors())};d.prototype._onIsEditingChanged=function(a,b){this.isEditing=this._supportEdit.isEditing};d.prototype._bindDS=function(){var a=this._dataContext,b=this;a&&(a&&(this._supportEdit=l.getEditable(a),this._supportErrNotify=l.getErrorNotification(a)),a.addOnDestroyed(function(a,c){b.dataContext=null},b._objId),this._supportEdit&&this._supportEdit.addOnPropertyChange("isEditing",b._onIsEditingChanged,b._objId,b),this._supportErrNotify&&this._supportErrNotify.addOnErrorsChanged(b._onDSErrorsChanged,
b._objId,b))};d.prototype._unbindDS=function(){var a=this._dataContext;this.validationErrors=null;a&&!a.getIsDestroyCalled()&&(a.removeNSHandlers(this._objId),this._supportEdit&&this._supportEdit.removeNSHandlers(this._objId),this._supportErrNotify&&this._supportErrNotify.removeOnErrorsChanged(this._objId));this._supportErrNotify=this._supportEdit=null};d.prototype._clearContent=function(){this._content.forEach(function(a){a.destroy()});this._content=[];this._lfTime&&(this._lfTime.destroy(),this._lfTime=
null);this._contentCreated=!1};d.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;this._clearContent();this._$el.removeClass(c.css.dataform);this._$el=this._el=null;this._unbindDS();var a=this._parentDataForm;this._parentDataForm=null;a&&!a.getIsDestroyCalled()&&a.removeNSHandlers(this._objId);this._dataContext=null;this._contentCreated=!1;this._app=null;b.prototype.destroy.call(this)}};d.prototype.toString=function(){return"DataForm"};Object.defineProperty(d.prototype,
"app",{get:function(){return this._app},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"dataContext",{get:function(){return this._dataContext},set:function(b){try{if(b!==this._dataContext){if(b&&!l.check.isBaseObj(b))throw Error(a.ERRS.ERR_DATAFRM_DCTX_INVALID);this._unbindDS();this._dataContext=b;this._bindDS();this._updateContent();this.raisePropertyChanged("dataContext");this._dataContext&&
(this._supportEdit&&this._isEditing!==this._supportEdit.isEditing&&(this.isEditing=this._supportEdit.isEditing),this._supportErrNotify&&this._onDSErrorsChanged())}}catch(c){a.reThrow(c,this.handleError(c,this))}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isEditing",{get:function(){return this._isEditing},set:function(b){var c=this._dataContext;if(c){var d=this._isEditing,e;this._supportEdit&&(e=this._supportEdit);if(e||b===d){if(b!==d&&e)try{b?e.beginEdit():e.endEdit()}catch(h){a.reThrow(h,
this.handleError(h,c))}e&&e.isEditing!==d&&(this._isEditing=e.isEditing,this._updateContent(),this.raisePropertyChanged("isEditing"))}else this._isEditing=b,this._updateContent(),this.raisePropertyChanged("isEditing")}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"validationErrors",{get:function(){return this._errors},set:function(a){a!==this._errors&&(this._errors=a,this.raisePropertyChanged("validationErrors"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"isInsideTemplate",{get:function(){return this._isInsideTemplate},set:function(a){this._isInsideTemplate=a},enumerable:!0,configurable:!0});return d}(a.BaseObject);c.DataForm=h;var e=function(b){function c(a,d,e){b.call(this,a,d,e);var g=this;this._options=e;this._form=new h({app:a,el:d});this._form.addOnDestroyed(function(){g._form=null;g.invokePropChanged("form");g.raisePropertyChanged("form")});this._form.addOnPropertyChange("*",function(a,b){switch(b.property){case "validationErrors":g.validationErrors=
a.validationErrors;break;case "dataContext":g.raisePropertyChanged(b.property)}},this._objId)}__extends(c,b);c.prototype._getErrorTipInfo=function(a){var b=["<b>",n.errorInfo,"</b>","<ul>"];a.forEach(function(a){var c=a.fieldName,d="";c&&(d=n.errorField+" "+c);a.errors.forEach(function(a){d=d?d+" -> "+a:a});b.push("<li>"+d+"</li>");d=""});b.push("</ul>");return b.join("")};c.prototype._updateErrorUI=function(b,c){if(b){var d=this.$el;if(c&&0<c.length){var e,h=a.global.getImagePath("warning.png");
e=a.global.$('<img name="error_info" alt="error_info" class="error-info" />');d.prepend(e);e.get(0).src=h;k.fn_addToolTip(e,this._getErrorTipInfo(c),!0);this._setFieldError(!0)}else d.children('img[name="error_info"]').remove(),this._setFieldError(!1)}};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._form&&!this._form.getIsDestroyCalled()&&this._form.destroy(),this._form=null,b.prototype.destroy.call(this))};c.prototype.toString=function(){return"DataFormElView"};
Object.defineProperty(c.prototype,"dataContext",{get:function(){return this._isDestroyCalled?null:this._form.dataContext},set:function(a){this._isDestroyCalled||this.dataContext===a||(this._form.dataContext=a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"form",{get:function(){return this._form},enumerable:!0,configurable:!0});return c}(k.BaseElView);c.DataFormElView=e;a.global.registerType("DataFormElView",e);a.global.registerElView(q.ELVIEW_NM.DATAFORM,e);c._isModuleLoaded=
!0})(t.dataform||(t.dataform={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=a.MOD.baseElView,p=a.MOD.template,k,g=a.global;g.addOnInitialize(function(a,c){k=a.utils});q=function(c){function g(a,e,b){c.call(this,a,e,b);this._animation=this._template=this._templateID=this._prevTemplateID=this._dataContext=null}__extends(g,c);g.prototype.templateLoading=function(a){if(!this._isDestroyCalled){var c=!this._prevTemplateID;this._animation&&(this._animation.isAnimateFirstShow||!this._animation.isAnimateFirstShow&&!c)&&this._animation.beforeShow(a,
c)}};g.prototype.templateLoaded=function(a){if(!this._isDestroyCalled){k.isContained(a.el,this.el)||this.el.appendChild(a.el);var c=!this._prevTemplateID;this._animation&&(this._animation.isAnimateFirstShow||!this._animation.isAnimateFirstShow&&!c)&&this._animation.show(a,c)}};g.prototype.templateUnLoading=function(a){};g.prototype._templateChanging=function(c,e){var b=this;try{if(!e&&this._template){this._animation&&this._template.loadedElem?(this._animation.stop(),this._animation.beforeHide(this._template),
this._animation.hide(this._template).always(function(){b._isDestroyCalled||(b._template.destroy(),b._template=null,b.raisePropertyChanged("template"))})):(b._template.destroy(),b._template=null,b.raisePropertyChanged("template"));return}}catch(d){this.handleError(d,this),a.throwDummy(d)}try{this._template?this._animation&&this._template.loadedElem?(this._animation.stop(),this._animation.beforeHide(this._template),this._animation.hide(this._template).always(function(){b._isDestroyCalled||(b._template.templateID=
e)})):b._template.templateID=e:(this._template=new p.Template({app:this.app,templateID:e,dataContext:this._dataContext,templEvents:this}),b.raisePropertyChanged("template"))}catch(m){this.handleError(m,this),a.throwDummy(m)}};g.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._animation&&(k.check.isBaseObj(this._animation)&&this._animation.destroy(),this._animation=null),this._template&&(this._template.destroy(),this._template=null),this._dataContext=null,c.prototype.destroy.call(this))};
Object.defineProperty(g.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"templateID",{get:function(){return this._templateID},set:function(a){var c=this._templateID;c!==a&&(this._prevTemplateID=this._templateID,this._templateID=a,this._templateChanging(c,a),this.raisePropertyChanged("templateID"))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"dataContext",{get:function(){return this._dataContext},set:function(a){this._dataContext!==
a&&(this._dataContext=a,this._template&&(this._template.dataContext=this._dataContext),this.raisePropertyChanged("dataContext"))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"animation",{get:function(){return this._animation},set:function(a){this._animation!==a&&(this._animation=a,this.raisePropertyChanged("animation"))},enumerable:!0,configurable:!0});return g}(q.BaseElView);c.DynaContentElView=q;g.registerElView("dynacontent",q);c._isModuleLoaded=!0})(t.dynacontent||(t.dynacontent=
{}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=a.MOD.baseElView,p=function(c){function g(){c.call(this);this._dateFormat=null;this._datepickerRegion="";if(!a.global.$.datepicker)throw Error(a.ERRS.ERR_JQUERY_DATEPICKER_NOTFOUND);this.dateFormat="dd.mm.yy"}__extends(g,c);g.prototype.toString=function(){return"Datepicker"};g.prototype.attachTo=function(a,c){c?a.datepicker(c):a.datepicker()};g.prototype.detachFrom=function(c){a.global.utils.destroyJQueryPlugin(c,"datepicker")};g.prototype.parseDate=function(a){return this.datePickerFn.parseDate(this.dateFormat,
a)};g.prototype.formatDate=function(a){return this.datePickerFn.formatDate(this.dateFormat,a)};Object.defineProperty(g.prototype,"dateFormat",{get:function(){return this._dateFormat?this._dateFormat:this.datePickerFn.regional[this._datepickerRegion].dateFormat},set:function(a){this.dateFormat!==a&&(this._dateFormat=a,a=this.datePickerFn.regional[this._datepickerRegion],this._dateFormat&&(a.dateFormat=this._dateFormat,this.datePickerFn.setDefaults(a)),this.raisePropertyChanged("dateFormat"))},enumerable:!0,
configurable:!0});Object.defineProperty(g.prototype,"datepickerRegion",{get:function(){return this._datepickerRegion},set:function(a){a||(a="");var c=this.dateFormat;if(this._datepickerRegion!==a){var h=this.datePickerFn.regional[a];h&&(this._datepickerRegion=a,h.dateFormat=c,this.datePickerFn.setDefaults(h),this.raisePropertyChanged("datepickerRegion"))}},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"datePickerFn",{get:function(){return a.global.$.datepicker},enumerable:!0,configurable:!0});
return g}(a.BaseObject);c.Datepicker=p;q=function(c){function g(){c.apply(this,arguments)}__extends(g,c);g.prototype._init=function(g){c.prototype._init.call(this,g);a.global.defaults.datepicker.attachTo(this.$el,g.datepicker)};g.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,a.global.defaults.datepicker.detachFrom(this.$el),c.prototype.destroy.call(this))};g.prototype.toString=function(){return"DatePickerElView"};return g}(q.TextBoxElView);c.DatePickerElView=q;a.global.registerType("IDatepicker",
new p);a.global.registerElView("datepicker",q);c._isModuleLoaded=!0})(t.datepicker||(t.datepicker={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=function(c){function k(){c.apply(this,arguments)}__extends(k,c);k.prototype._init=function(a){c.prototype._init.call(this,a);this._tabOpts=a;this._tabsEvents=null;this._tabsCreated=!1;this._createTabs()};k.prototype._createTabs=function(){var c=this.$el,n=this,l={activate:function(a,c){if(n._tabsEvents)n._tabsEvents.onTabSelected(n);n.raisePropertyChanged("tabIndex")}},l=a.global.utils.extend(!1,l,n._tabOpts);c.tabs(l);setTimeout(function(){n.getIsDestroyCalled()||
(n._tabsCreated=!0,n._onTabsCreated(),n.raisePropertyChanged("tabIndex"))},100)};k.prototype._destroyTabs=function(){a.global.utils.destroyJQueryPlugin(this.$el,"tabs");this._tabsCreated=!1;this._tabsEvents&&this._tabsEvents.removeTabs()};k.prototype._onTabsCreated=function(){this._tabsEvents&&this._tabsEvents.addTabs(this);if(this._tabsEvents)this._tabsEvents.onTabSelected(this)};k.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._destroyTabs(),this._tabsEvents=null,
c.prototype.destroy.call(this))};k.prototype.toString=function(){return"TabsElView"};Object.defineProperty(k.prototype,"tabsEvents",{get:function(){return this._tabsEvents},set:function(a){var c=this._tabsEvents;a!==c&&(c&&c.removeTabs(),this._tabsEvents=a,this.raisePropertyChanged("tabsEvents"),this._tabsCreated&&this._onTabsCreated())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"tabIndex",{get:function(){return this.$el.tabs("option","active")},set:function(a){this.$el.tabs("option",
"active",a)},enumerable:!0,configurable:!0});return k}(t.baseElView.BaseElView);c.TabsElView=q;a.global.registerElView("tabs",q);c._isModuleLoaded=!0})(t.tabs||(t.tabs={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=a.MOD.collection,p=a.MOD.baseElView,k=a.MOD.baseContent,g,n;a.global.addOnInitialize(function(a,b){g=a.utils;n=a.parser});var l=function(b){function c(e){b.call(this);var h=this;e=g.extend(!1,{app:null,el:null,dataSource:null,valuePath:null,textPath:null,statePath:null},e);if(e.dataSource&&!(e.dataSource instanceof q.BaseCollection))throw Error(a.ERRS.ERR_LISTBOX_DATASRC_INVALID);this._$el=a.global.$(e.el);this._options=e;this._objId="lst"+a.baseUtils.getNewID();
this._$el.on("change."+this._objId,function(a){a.stopPropagation();h._isRefreshing||h._onChanged()});this._stateProvider=this._textProvider=null;this._isRefreshing=this._isDSFilling=!1;this._prevSelected=this._selectedItem=null;this._keyMap={};this._valMap={};this._tempValue=this._savedValue=void 0;e=this._options.dataSource;this._options.dataSource=null;this.dataSource=e;this._fn_state=function(a){if(a=h._keyMap[a._key]){var b=h._onOptionStateChanged(a);a.op.className=b}}}__extends(c,b);c.prototype.destroy=
function(){this._isDestroyed||(this._isDestroyCalled=!0,this._unbindDS(),this._$el.off("."+this._objId),this._clear(!0),this._$el=null,this._tempValue=void 0,this._savedValue=this._prevSelected=this._selectedItem=null,this._options={},this._stateProvider=this._textProvider=null,b.prototype.destroy.call(this))};c.prototype._onChanged=function(){var a=null,b;0<=this.el.selectedIndex&&(a=this.el.options[this.el.selectedIndex],a=a.value,b=this._keyMap[a]);!b&&this._selectedItem?this.selectedItem=null:
b.item!==this._selectedItem&&(this.selectedItem=b.item)};c.prototype._getStringValue=function(a){a=this._getValue(a);return g.check.isNt(a)?"":""+a};c.prototype._getValue=function(a){if(!a)return null;if(this._options.valuePath)return n.resolvePath(a,this._options.valuePath)};c.prototype._getText=function(b,c){var d="";if(!b)return d;if(this._options.textPath){d=a.global.parser.resolvePath(b,this._options.textPath);if(g.check.isNt(d))return"";d=""+d}else d=this._getStringValue(b);return this._textProvider?
d=this._textProvider.getText(b,c,d):d};c.prototype._onDSCollectionChanged=function(a,b){var c=this,d;switch(b.changeType){case 2:this._isDSFilling||this._refresh();break;case 1:this._isDSFilling||b.items.forEach(function(a){c._addOption(a,a._aspect.isNew)});break;case 0:b.items.forEach(function(a){c._removeOption(a)});c._textProvider&&c._resetText();break;case 3:if(d=c._keyMap[b.old_key])delete c._keyMap[b.old_key],c._keyMap[b.new_key]=d,d.op.value=b.new_key}};c.prototype._onDSFill=function(a,b){b.isBegin?
this._isDSFilling=!0:(this._isDSFilling=!1,this._refresh())};c.prototype._onEdit=function(a,b,c){b?this._savedValue=this._getStringValue(a):(b=this._savedValue,this._savedValue=void 0,c||(c=a._key,(c=this._keyMap[c])?(c.op.text=this._getText(a,c.op.index),a=this._getStringValue(a),b!==a&&(b&&delete this._valMap[b],a&&(this._valMap[a]=c))):b&&delete this._valMap[b]))};c.prototype._onStatusChanged=function(a,b){3===a._aspect.status&&(this._removeOption(a),this._textProvider&&this._resetText())};c.prototype._onCommitChanges=
function(a,b,c,d){if(b){if(!c||1!==d)if(c||3!==d)this._savedValue=this._getStringValue(a)}else b=this._savedValue,this._savedValue=void 0,c&&3===d?this._addOption(a,!0):(c=this._getStringValue(a),d=this._keyMap[a._key],b!==c&&(""!==b&&delete this._valMap[b],d&&""!==c&&(this._valMap[c]=d)),d&&(d.op.text=this._getText(a,d.op.index)))};c.prototype._onOptionStateChanged=function(a){return this._stateProvider?this._stateProvider.getCSS(a.item,a.op.index,n.resolvePath(a.item,this.statePath)):""};c.prototype._bindDS=
function(){var a=this,b=this.dataSource;b&&(b.addOnCollChanged(a._onDSCollectionChanged,a._objId,a),b.addOnFill(a._onDSFill,a._objId,a),b.addOnBeginEdit(function(b,c){a._onEdit(c.item,!0,void 0)},a._objId),b.addOnEndEdit(function(b,c){a._onEdit(c.item,!1,c.isCanceled)},a._objId),b.addOnStatusChanged(function(b,c){a._onStatusChanged(c.item,c.oldStatus)},a._objId),b.addOnCommitChanges(function(b,c){a._onCommitChanges(c.item,c.isBegin,c.isRejected,c.status)},a._objId))};c.prototype._unbindDS=function(){var a=
this.dataSource;a&&a.removeNSHandlers(this._objId)};c.prototype._addOption=function(b,c){if(this._isDestroyCalled)return null;var d,e="",h,m;b&&(e=b._key);if(this._keyMap[e])return null;var g=this.el;m=this._getText(b,g.options.length);h=this._getStringValue(b);d=a.global.document.createElement("option");d.text=m;d.value=e;m={item:b,op:d};this._keyMap[e]=m;h&&(this._valMap[h]=m);c?2>g.options.length?g.add(d,null):g.add(d,g.options[1]):g.add(d,null);this.statePath&&b&&(b.addOnPropertyChange(this.statePath,
this._fn_state,this._objId,this),this._fn_state(b));return d};c.prototype._mapByValue=function(){var a=this;this._valMap={};g.forEachProp(this._keyMap,function(b){b=a._keyMap[b];var c=a._getStringValue(b.item);c&&(a._valMap[c]=b)})};c.prototype._resetText=function(){var a=this;g.forEachProp(this._keyMap,function(b){b=a._keyMap[b];b.op.text=a._getText(b.item,b.op.index)})};c.prototype._removeOption=function(a){if(!this._isDestroyCalled){var b="",c;a&&(b=a._key,c=this._keyMap[b])&&(a.removeNSHandlers(this._objId),
this.el.remove(c.op.index),c=this._getStringValue(a),delete this._keyMap[b],c&&delete this._valMap[c],this._prevSelected===a&&(this._prevSelected=null),this.selectedItem===a&&(this.selectedItem=this._prevSelected))}};c.prototype._clear=function(a){var b=this;g.forEachProp(this._keyMap,function(a){a=b._keyMap[a];a.item&&a.item.removeNSHandlers(b._objId)});this.el.options.length=0;this._keyMap={};this._valMap={};this._prevSelected=null;a||this._addOption(null,!1);this.selectedItem=null};c.prototype._refresh=
function(){var a=this,b=this.dataSource,c=this._selectedItem,d=a._tempValue;this._isRefreshing=!0;try{this.clear(),b&&(b.forEach(function(b){a._addOption(b,!1)}),g.check.isUndefined(d)?a.el.selectedIndex=a._findItemIndex(c):(c=a.findItemByValue(d),a.selectedItem=c,a._tempValue=c?void 0:d))}finally{a._isRefreshing=!1}a._onChanged()};c.prototype._findItemIndex=function(a){return!a||a.getIsDestroyCalled()?0:(a=this._keyMap[a._key])?a.op.index:0};c.prototype._setIsEnabled=function(a,b){a.disabled=!b};
c.prototype._getIsEnabled=function(a){return!a.disabled};c.prototype.clear=function(){this._clear(!1)};c.prototype.findItemByValue=function(a){return g.check.isNt(a)?null:(a=this._valMap[""+a])?a.item:null};c.prototype.getTextByValue=function(a){return g.check.isNt(a)?"":(a=this._valMap[""+a])?a.op.text:""};c.prototype.toString=function(){return"ListBox"};Object.defineProperty(c.prototype,"dataSource",{get:function(){return this._options.dataSource},set:function(a){this.dataSource!==a&&(this.dataSource&&
(this._tempValue=this.selectedValue,this._unbindDS()),this._options.dataSource=a,this.dataSource&&this._bindDS(),this._refresh(),this.dataSource&&(this._tempValue=void 0),this.raisePropertyChanged("dataSource"),this.raisePropertyChanged("selectedItem"),this.raisePropertyChanged("selectedValue"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"selectedValue",{get:function(){if(this.dataSource)return this._getValue(this.selectedItem)},set:function(a){if(this.dataSource){if(this.selectedValue!==
a){var b=this.findItemByValue(a);this.selectedItem=b;g.check.isUndefined(a)||b?this._tempValue=void 0:this._tempValue=a}}else this._tempValue!==a&&(this._selectedItem=null,this._tempValue=a,this.raisePropertyChanged("selectedItem"),this.raisePropertyChanged("selectedValue"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"selectedItem",{get:function(){if(this.dataSource)return this._selectedItem},set:function(a){this._selectedItem!==a&&(this._selectedItem&&(this._prevSelected=
this._selectedItem),this._selectedItem=a,this.el.selectedIndex=this._findItemIndex(this._selectedItem),this.raisePropertyChanged("selectedItem"),this.raisePropertyChanged("selectedValue"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"valuePath",{get:function(){return this._options.valuePath},set:function(a){a!==this.valuePath&&(this._options.valuePath=a,this._mapByValue(),this.raisePropertyChanged("valuePath"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"textPath",{get:function(){return this._options.textPath},set:function(a){a!==this.textPath&&(this._options.textPath=a,this._resetText(),this.raisePropertyChanged("textPath"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"statePath",{get:function(){return this._options.statePath},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isEnabled",{get:function(){return this._getIsEnabled(this.el)},set:function(a){a!==this.isEnabled&&(this._setIsEnabled(this.el,a),this.raisePropertyChanged("isEnabled"))},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"textProvider",{get:function(){return this._textProvider},set:function(a){a!==this._textProvider&&(this._textProvider=a,this.raisePropertyChanged("textProvider"),this._resetText())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"stateProvider",{get:function(){return this._stateProvider},set:function(a){a!==this._stateProvider&&(this._stateProvider=a,this.raisePropertyChanged("stateProvider"))},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"el",{get:function(){return this._options.el},enumerable:!0,configurable:!0});return c}(a.BaseObject);c.ListBox=l;var h=function(a){function b(c,e,h){var m=this;m._options=h;var k=g.extend(!1,{app:c,el:e,dataSource:null},this._options);m._listBox=new l(k);m._listBox.addOnDestroyed(function(){m._listBox=null;m.invokePropChanged("listBox");m.raisePropertyChanged("listBox")},this.uniqueID);m._listBox.addOnPropertyChange("*",function(a,b){switch(b.property){case "dataSource":case "isEnabled":case "selectedValue":case "selectedItem":case "valuePath":case "textPath":case "textProvider":case "stateProvider":m.raisePropertyChanged(b.property)}},
m.uniqueID);a.call(this,c,e,h)}__extends(b,a);b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._listBox&&!this._listBox.getIsDestroyCalled()&&this._listBox.destroy(),this._listBox=null,a.prototype.destroy.call(this))};b.prototype.toString=function(){return"SelectElView"};Object.defineProperty(b.prototype,"isEnabled",{get:function(){return this._isDestroyCalled?!1:!this.el.disabled},set:function(a){a=!!a;a!==this.isEnabled&&(this.el.disabled=!a,this.raisePropertyChanged("isEnabled"))},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dataSource",{get:function(){return this._isDestroyCalled?void 0:this._listBox.dataSource},set:function(a){this.dataSource!==a&&(this._listBox.dataSource=a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selectedValue",{get:function(){return this.getIsDestroyCalled()?void 0:this._listBox.selectedValue},set:function(a){this._listBox.selectedValue!==
a&&(this._listBox.selectedValue=a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selectedItem",{get:function(){return this.getIsDestroyCalled()?void 0:this._listBox.selectedItem},set:function(a){this._listBox.selectedItem=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"valuePath",{get:function(){return this._listBox.valuePath},set:function(a){this._listBox.valuePath=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"textPath",{get:function(){return this._listBox.textPath},
set:function(a){this._listBox.textPath=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"textProvider",{get:function(){return this._listBox.textProvider},set:function(a){this._listBox.textProvider=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"stateProvider",{get:function(){return this._listBox.stateProvider},set:function(a){this._listBox.stateProvider=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"listBox",{get:function(){return this._listBox},
enumerable:!0,configurable:!0});return b}(p.BaseElView);c.SelectElView=h;var e=function(b){function c(e,h){if("lookup"!=h.contentOptions.name)throw Error(g.format(a.ERRS.ERR_ASSERTION_FAILED,"contentOptions.name == 'lookup'"));this._selectView=this._spanView=null;this._isListBoxCachedExternally=!1;this._value=this._listBinding=this._valBinding=null;b.call(this,e,h)}__extends(c,b);c.prototype.init=function(){this._options.initContentFn&&this._options.initContentFn(this)};c.prototype._getEventNames=
function(){var a=b.prototype._getEventNames.call(this);return["object_created","object_needed"].concat(a)};c.prototype.addOnObjectCreated=function(a,b){this._addHandler("object_created",a,b)};c.prototype.removeOnObjectCreated=function(a){this._removeHandler("object_created",a)};c.prototype.addOnObjectNeeded=function(a,b){this._addHandler("object_needed",a,b)};c.prototype.removeOnObjectNeeded=function(a){this._removeHandler("object_needed",a)};c.prototype.getSelectView=function(){if(this._selectView)return this._selectView;
var b=this._options.options,c={objectKey:"selectElView",object:null};this.raiseEvent("object_needed",c);c.object&&(this._isListBoxCachedExternally=!0,this._selectView=c.object);if(this._selectView)return this._selectView;var c=n.resolvePath(this.app,b.dataSource),b={valuePath:b.valuePath,textPath:b.textPath,statePath:b.statePath?b.statePath:null},d=a.global.document.createElement("select");d.setAttribute("size","1");b=this.createSelectElView(d,b);b.dataSource=c;c={objectKey:"selectElView",object:b,
isCachedExternally:!1};this.raiseEvent("object_created",c);this._isListBoxCachedExternally=c.isCachedExternally;return this._selectView=b};c.prototype.createSelectElView=function(a,b){var c=this.app._getInternal().getElView(a);return c?c:c=new h(this.app,a,b)};c.prototype.updateTextValue=function(){this.getSpanView().value=this.getLookupText()};c.prototype.getLookupText=function(){return this.getSelectView().listBox.getTextByValue(this.value)};c.prototype.getSpanView=function(){if(this._spanView)return this._spanView;
var b=a.global.document.createElement("span"),c=this._options.displayInfo,b=new p.SpanElView(this.app,b,{});c&&c.displayCss&&b.$el.addClass(c.displayCss);return this._spanView=b};c.prototype.render=function(){this.cleanUp();this.createTargetElement();this._parentEl.appendChild(this._el)};c.prototype.createTargetElement=function(){var a;this.isEditing&&this.getIsCanBeEdited()?(a=this.getSelectView(),this._listBinding=this.bindToList(a)):(a=this.getSpanView(),this._valBinding=this.bindToValue());this._el=
a.el;this.updateCss();return a};c.prototype.cleanUp=function(){this._el&&(g.removeNode(this._el),this._el=null);this._listBinding&&(this._listBinding.destroy(),this._listBinding=null);this._valBinding&&(this._valBinding.destroy(),this._valBinding=null);this._selectView&&this._isListBoxCachedExternally&&(this._selectView=null)};c.prototype.updateBindingSource=function(){this._valBinding&&(this._valBinding.source=this._dataContext);this._listBinding&&(this._listBinding.source=this._dataContext)};c.prototype.bindToValue=
function(){return this._options.fieldName?this.app.bind({target:this,source:this._dataContext,targetPath:"value",sourcePath:this._options.fieldName,mode:1,converter:null,converterParam:null,isSourceFixed:!1}):null};c.prototype.bindToList=function(a){return this._options.fieldName?this.app.bind({target:a,source:this._dataContext,targetPath:"selectedValue",sourcePath:this._options.fieldName,mode:2,converter:null,converterParam:null,isSourceFixed:!1}):null};c.prototype.destroy=function(){this._isDestroyed||
(this._isDestroyCalled=!0,this.cleanUp(),this._selectView&&!this._isListBoxCachedExternally&&this._selectView.destroy(),this._selectView=null,this._spanView&&this._spanView.destroy(),this._spanView=null,b.prototype.destroy.call(this))};c.prototype.toString=function(){return"LookupContent"};Object.defineProperty(c.prototype,"value",{get:function(){return this._value},set:function(a){this._value!==a&&(this._value=a,this.updateTextValue(),this.raisePropertyChanged("value"))},enumerable:!0,configurable:!0});
return c}(k.BindingContent);c.LookupContent=e;var b=function(){function b(a,c){this._app=a;this._nextFactory=c}b.prototype.getContentType=function(b){if("lookup"==b.name)return e;if(this._nextFactory)return this._nextFactory.getContentType(b);throw Error(a.ERRS.ERR_BINDING_CONTENT_NOT_FOUND);};b.prototype.createContent=function(a){return new (this.getContentType(a))(this.app,a)};b.prototype.isExternallyCachable=function(a){return e===a?!0:this._nextFactory.isExternallyCachable(a)};Object.defineProperty(b.prototype,
"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return b}();c.ContentFactory=b;c._initModule=function(a){a._getInternal().addContentFactory(function(c){return new b(a,c)})};a.global.registerElView("select",h);c._isModuleLoaded=!0})(t.listbox||(t.listbox={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=a.MOD.template,p=a.MOD.mvvm,k;a.global.addOnInitialize(function(a,c){k=a.utils});var g=function(c){function g(h,e){c.call(this);var b=this;e=k.extend(!1,{dataContext:null,templateID:null,width:500,height:350,title:"data edit dialog",submitOnOK:!1,canRefresh:!1,canCancel:!0,fn_OnClose:null,fn_OnOK:null,fn_OnShow:null,fn_OnCancel:null,fn_OnTemplateCreated:null,fn_OnTemplateDestroy:null},e);this._objId="dlg"+a.baseUtils.getNewID();this._app=h;this._dataContext=
e.dataContext;this._templateID=e.templateID;this._submitOnOK=e.submitOnOK;this._canRefresh=e.canRefresh;this._canCancel=e.canCancel;this._fn_OnClose=e.fn_OnClose;this._fn_OnOK=e.fn_OnOK;this._fn_OnShow=e.fn_OnShow;this._fn_OnCancel=e.fn_OnCancel;this._fn_OnTemplateCreated=e.fn_OnTemplateCreated;this._fn_OnTemplateDestroy=e.fn_OnTemplateDestroy;this._currentSelectable=this._result=this._$template=this._template=this._isEditable=null;this._fn_submitOnOK=function(){var a=k.getSubmittable(b._dataContext);
return a&&a.isCanSubmit?a.submitChanges():k.createDeferred().resolve()};this._updateIsEditable();this._options={width:e.width,height:e.height,title:e.title,autoOpen:!1,modal:!0,close:function(a,c){b._onClose()},buttons:b._getButtons()};this._dialogCreated=!1;this._createDialog()}__extends(g,c);g.prototype.handleError=function(a,e){var b=c.prototype.handleError.call(this,a,e);return b?b:this._app.handleError(a,e)};g.prototype.addOnClose=function(a,c,b){this._addHandler("close",a,c,b)};g.prototype.removeOnClose=
function(a){this._removeHandler("close",a)};g.prototype.addOnRefresh=function(a,c,b){this._addHandler("refresh",a,c,b)};g.prototype.removeOnRefresh=function(a){this._removeHandler("refresh",a)};g.prototype._updateIsEditable=function(){this._isEditable=k.getEditable(this._dataContext)};g.prototype._createDialog=function(){if(!this._dialogCreated)try{this._template=this._createTemplate(),this._$template=a.global.$(this._template.el),a.global.document.body.appendChild(this._template.el),this._$template.dialog(this._options),
this._dialogCreated=!0}catch(c){a.reThrow(c,this.handleError(c,this))}};g.prototype._getEventNames=function(){var a=c.prototype._getEventNames.call(this);return["close","refresh"].concat(a)};g.prototype.templateLoading=function(a){};g.prototype.templateLoaded=function(a){this._isDestroyCalled||this._fn_OnTemplateCreated&&this._fn_OnTemplateCreated(a)};g.prototype.templateUnLoading=function(a){this._fn_OnTemplateDestroy&&this._fn_OnTemplateDestroy(a)};g.prototype._createTemplate=function(){return new q.Template({app:this.app,
templateID:this._templateID,dataContext:null,templEvents:this})};g.prototype._destroyTemplate=function(){this._template&&this._template.destroy()};g.prototype._getButtons=function(){var c=this,e=[{id:c._objId+"Refresh",text:a.localizable.TEXT.txtRefresh,"class":"btn btn-info",click:function(){c._onRefresh()}},{id:c._objId+"Ok",text:a.localizable.TEXT.txtOk,"class":"btn btn-info",click:function(){c._onOk()}},{id:c._objId+"Cancel",text:a.localizable.TEXT.txtCancel,"class":"btn btn-info",click:function(){c._onCancel()}}];
this.canRefresh||e.shift();this.canCancel||e.pop();return e};g.prototype._getOkButton=function(){return $("#"+this._objId+"Ok")};g.prototype._getCancelButton=function(){return $("#"+this._objId+"Cancel")};g.prototype._getRefreshButton=function(){return $("#"+this._objId+"Refresh")};g.prototype._getAllButtons=function(){return[this._getOkButton(),this._getCancelButton(),this._getRefreshButton()]};g.prototype._disableButtons=function(a){this._getAllButtons().forEach(function(c){c.prop("disabled",!!a)})};
g.prototype._onOk=function(){var c=this,e;e=0;this._fn_OnOK&&(e=this._fn_OnOK(this));if(1!=e)if(this._dataContext){if(e=this._isEditable?this._isEditable.endEdit():!0)if(this._submitOnOK){this._disableButtons(!0);var b=this.title;this.title=a.localizable.TEXT.txtSubmitting;e=this._fn_submitOnOK();e.always(function(){c._disableButtons(!1);c.title=b});e.done(function(){c._result="ok";c.hide()});e.fail(function(){c._isEditable&&!c._isEditable.beginEdit()&&(c._result="cancel",c.hide())})}else c._result=
"ok",c.hide()}else c.hide()};g.prototype._onCancel=function(){var a=0;this._fn_OnCancel&&(a=this._fn_OnCancel(this));1!=a&&(this._isEditable&&this._isEditable.cancelEdit(),this._result="cancel",this.hide())};g.prototype._onRefresh=function(){var a={isHandled:!1};this.raiseEvent("refresh",a);a.isHandled||(a=this._dataContext)&&(k.check.isFunction(a.refresh)?a.refresh():a._aspect&&k.check.isFunction(a._aspect.refresh)&&a._aspect.refresh())};g.prototype._onClose=function(){try{if("ok"!=this._result&&
this._dataContext&&(this._isEditable&&this._isEditable.cancelEdit(),this._submitOnOK)){var c=k.getSubmittable(this._dataContext);c&&c.rejectChanges()}this._fn_OnClose&&this._fn_OnClose(this);this.raiseEvent("close",{})}finally{this._template.dataContext=null}var e=this._currentSelectable;this._currentSelectable=null;setTimeout(function(){a.global.currentSelectable=e;e=null},50)};g.prototype._onShow=function(){this._currentSelectable=a.global.currentSelectable;this._fn_OnShow&&this._fn_OnShow(this)};
g.prototype.show=function(){this._result=null;this._$template.dialog("option","buttons",this._getButtons());this._template.dataContext=this._dataContext;this._onShow();this._$template.dialog("open")};g.prototype.hide=function(){this._$template&&this._$template.dialog("close")};g.prototype.getOption=function(a){return this._$template?this._$template.dialog("option",a):void 0};g.prototype.setOption=function(a,c){this._$template.dialog("option",a,c)};g.prototype.destroy=function(){this._isDestroyed||
(this._isDestroyCalled=!0,this.hide(),this._destroyTemplate(),this._template=this._$template=null,this._dialogCreated=!1,this._app=this._isEditable=this._fn_submitOnOK=this._dataContext=null,c.prototype.destroy.call(this))};Object.defineProperty(g.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"dataContext",{get:function(){return this._dataContext},set:function(a){a!==this._dataContext&&(this._dataContext=a,this._updateIsEditable(),
this.raisePropertyChanged("dataContext"))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"result",{get:function(){return this._result},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"isSubmitOnOK",{get:function(){return this._submitOnOK},set:function(a){this._submitOnOK!==a&&(this._submitOnOK=a,this.raisePropertyChanged("isSubmitOnOK"))},enumerable:!0,
configurable:!0});Object.defineProperty(g.prototype,"width",{get:function(){return this.getOption("width")},set:function(a){var c=this.getOption("width");a!==c&&(this.setOption("width",a),this.raisePropertyChanged("width"))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"height",{get:function(){return this.getOption("height")},set:function(a){var c=this.getOption("height");a!==c&&(this.setOption("height",a),this.raisePropertyChanged("height"))},enumerable:!0,configurable:!0});
Object.defineProperty(g.prototype,"title",{get:function(){return this.getOption("title")},set:function(a){var c=this.getOption("title");a!==c&&(this.setOption("title",a),this.raisePropertyChanged("title"))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"canRefresh",{get:function(){return this._canRefresh},set:function(a){a!==this._canRefresh&&(this._canRefresh=a,this.raisePropertyChanged("canRefresh"))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"canCancel",
{get:function(){return this._canCancel},set:function(a){a!==this._canCancel&&(this._canCancel=a,this.raisePropertyChanged("canCancel"))},enumerable:!0,configurable:!0});return g}(a.BaseObject);c.DataEditDialog=g;p=function(a){function c(g){a.call(this,g);this._dialogs={}}__extends(c,a);c.prototype.createDialog=function(a,c){var b=this;this._dialogs[a]=function(){var d=new g(b.app,c);b._dialogs[a]=function(){return d};return d};return this._dialogs[a]};c.prototype.showDialog=function(a,c){var b=this.getDialog(a);
if(!b)throw Error(k.format("Invalid Dialog name:  {0}",a));b.dataContext=c;b.show();return b};c.prototype.getDialog=function(a){return(a=this._dialogs[a])?a():null};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,Object.keys(this._dialogs).forEach(function(a){this._dialogs[a].destroy()},this),this._dialogs={},a.prototype.destroy.call(this))};return c}(p.BaseViewModel);c.DialogVM=p;c._isModuleLoaded=!0})(t.datadialog||(t.datadialog={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP=
{}));
(function(a){(function(t){(function(c){function q(){h.forEachProp(m,function(a){a=m[a];a.getIsDestroyCalled()||a._columnWidthChecker()})}var p=a.consts,k=a.MOD.baseElView,g=a.MOD.baseContent,n=a.MOD.collection,l=a.MOD.template,h,e=a.global;e.addOnInitialize(function(a,b){h=a.utils});c.css={container:"ria-table-container",dataTable:"ria-data-table",columnInfo:"ria-col-info",column:"ria-ex-column",cellDiv:"cell-div",headerDiv:"ria-table-header",wrapDiv:"ria-table-wrap",dataColumn:"data-column",rowCollapsed:"row-collapsed",
rowExpanded:"row-expanded",rowExpander:"row-expander",columnSelected:"selected",rowSelected:"selected",rowActions:"row-actions",rowDetails:"row-details",rowSelector:"row-selector",rowHighlight:"row-highlight",rowDeleted:"row-deleted",rowError:"row-error",nobr:"ria-nobr",colSortable:"sortable",colSortAsc:"sort-asc",colSortDesc:"sort-desc"};var b,d=0,m={},f=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype.getIsCanBeEdited=function(){return!0};b.prototype.toString=function(){return"RowSelectContent"};
return b}(g.BoolContent);c.RowSelectContent=f;var z=function(a){function b(d){a.call(this);d=h.extend(!1,{row:null,td:null,column:null},d);this._row=d.row;this._el=d.td;this._column=d.column;this._num=d.num;this._div=e.document.createElement("div");d=e.$(this._div);this._clickTimeOut=null;d.addClass(c.css.cellDiv).attr(p.DATA_ATTR.DATA_EVENT_SCOPE,this._column.uniqueID);d.data("cell",this);this._column.options.width&&(this._el.style.width=this._column.options.width);this._init();this.column.options.rowCellCss&&
d.addClass(this.column.options.rowCellCss);this._el.appendChild(this._div);this._row.el.appendChild(this._el)}__extends(b,a);b.prototype._init=function(){};b.prototype._onCellClicked=function(a){};b.prototype._onDblClicked=function(a){this.grid._getInternal().onCellDblClicked(this)};b.prototype.handleError=function(b,c){var d=a.prototype.handleError.call(this,b,c);return d?d:this.row.handleError(b,c)};b.prototype.click=function(){this.grid.currentRow=this._row;this._onCellClicked(this._row)};b.prototype.scrollIntoView=
function(a){this._div.scrollIntoView(!!a)};b.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;this._clickTimeOut&&(clearTimeout(this._clickTimeOut),this._clickTimeOut=null);var b=e.$(this._div);b.removeData();b.remove();this._column=this._el=this._row=this._div=null;a.prototype.destroy.call(this)}};b.prototype.toString=function(){return"BaseCell"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"row",{get:function(){return this._row},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"column",{get:function(){return this._column},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"grid",{get:function(){return this._row.grid},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"item",{get:function(){return this._row.item},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"uniqueID",{get:function(){return this._row.uniqueID+"_"+this._num},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"num",{get:function(){return this._num},enumerable:!0,configurable:!0});return b}(a.BaseObject);c.BaseCell=z;var A=function(b){function c(a){this._stateCss=this._content=null;b.call(this,a)}__extends(c,b);c.prototype._init=function(){var b=this.column.options.content;if(!b.fieldInfo&&b.fieldName&&(b.fieldInfo=this.item._aspect.getFieldInfo(b.fieldName),!b.fieldInfo))throw Error(h.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,"",b.fieldName));
var c=this.grid.app;b.initContentFn=null;try{var d=c._getInternal().getContentType(b);c.contentFactory.isExternallyCachable(d)&&(b.initContentFn=this.column._getInitContentFn());this._content=new d(c,{parentEl:this._div,contentOptions:b,dataContext:this.item,isEditing:this.item._aspect.isEditing})}finally{delete b.initContentFn}};c.prototype.click=function(){var a=this,b=this._row;this.grid.currentRow=b;this._clickTimeOut?(clearTimeout(this._clickTimeOut),this._clickTimeOut=null,this._onDblClicked(b)):
this._clickTimeOut=setTimeout(function(){a._clickTimeOut=null;a._onCellClicked(b)},350)};c.prototype._beginEdit=function(){this._content.isEditing||(this._content.isEditing=!0)};c.prototype._endEdit=function(a){this._content.isEditing&&(this._content.isEditing=!1)};c.prototype._setState=function(a){var b;this._stateCss!==a&&(b=e.$(this._div),this._stateCss&&b.removeClass(this._stateCss),(this._stateCss=a)&&b.addClass(this._stateCss))};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=
!0,this._content&&(this._content.destroy(),this._content=null),b.prototype.destroy.call(this))};c.prototype.toString=function(){return"DataCell"};Object.defineProperty(c.prototype,"column",{get:function(){return this._column},enumerable:!0,configurable:!0});return c}(z);c.DataCell=A;var C=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(){var a=e.$(this.el);a.addClass(c.css.rowCollapsed);a.addClass(c.css.rowExpander)};b.prototype._onCellClicked=function(b){if(b=
b||this._row)a.prototype._onCellClicked.call(this,b),b.isExpanded=!b.isExpanded};b.prototype.toggleImage=function(){var a=e.$(this.el);this._row.isExpanded?(a.removeClass(c.css.rowCollapsed),a.addClass(c.css.rowExpanded)):(a.removeClass(c.css.rowExpanded),a.addClass(c.css.rowCollapsed))};b.prototype.toString=function(){return"ExpanderCell"};return b}(z);c.ExpanderCell=C;var y=function(b){function d(a){this._isEditing=!1;b.call(this,a)}__extends(d,b);d.prototype._init=function(){var a=e.$(this.el),
b=e.$(this._div);a.addClass([c.css.rowActions,c.css.cellDiv,c.css.nobr].join(" "));b.on("mouseenter","img",function(a){a.stopPropagation();$(this).css("opacity",.5)});b.on("mouseout","img",function(a){a.stopPropagation();$(this).css("opacity",1)});this._createButtons(!1)};d.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=e.$(this._div),c=a.find("img");a.off();c.each(function(a,b){e.$(b).removeData()});b.prototype.destroy.call(this)}};d.prototype._createButtons=function(b){if(this._el){var c=
this,d=e.$,u=d(this._div),x={img_ok:"txtOk",img_cancel:"txtCancel",img_edit:"txtEdit",img_delete:"txtDelete"};u.empty();var w=c._column.options;b?(this._isEditing=!0,b=d('<img name="img_ok" alt="ok"/>&nbsp;<img name="img_cancel" alt="cancel"/>')):(this._isEditing=!1,b=d('<img name="img_edit" alt="edit"/>&nbsp;<img name="img_delete" alt="delete"/>'),c.isCanEdit||(b=b.not('img[name="img_edit"]')),c.isCanDelete||(b=b.not('img[name="img_delete"]')));(function(b){b.each(function(b,u){var e=d(u);u.style.cursor=
"pointer";u.src=w[u.name];e.data("cell",c);k.fn_addToolTip(e,a.localizable.TEXT[x[u.name]]);e.attr(p.DATA_ATTR.DATA_EVENT_SCOPE,c._column.uniqueID)})})(b.filter("img"));u.append(b)}};d.prototype.update=function(){this._row&&this._isEditing!=this._row.isEditing&&this._createButtons(this._row.isEditing)};d.prototype.toString=function(){return"ActionsCell"};Object.defineProperty(d.prototype,"isCanEdit",{get:function(){return this.grid.isCanEdit},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"isCanDelete",{get:function(){return this.grid.isCanDelete},enumerable:!0,configurable:!0});return d}(z);c.ActionsCell=y;var v=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(){e.$(this.el).addClass(c.css.rowSelector);this._content=new f(this.grid.app,{parentEl:this._div,contentOptions:{fieldName:"isSelected",bindingInfo:{target:null,source:null,targetPath:null,sourcePath:"isSelected",mode:"TwoWay",converter:null,converterParam:null},displayInfo:null},dataContext:this.row,
isEditing:!0})};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._content&&(this._content.destroy(),this._content=null),a.prototype.destroy.call(this))};b.prototype.toString=function(){return"RowSelectorCell"};return b}(z);c.RowSelectorCell=v;var B=function(a){function b(c){a.call(this);this._row=c.row;this._el=c.td;this._init(c)}__extends(b,a);b.prototype._init=function(a){if(a=a.details_id)this._el.colSpan=this.grid.columns.length,this._row.el.appendChild(this._el),
this._template=new l.Template({app:this.grid.app,templateID:a,templEvents:this}),this._el.appendChild(this._template.el)};b.prototype.templateLoading=function(a){};b.prototype.templateLoaded=function(a){};b.prototype.templateUnLoading=function(a){this._el.removeChild(a.el);this._template=null};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._template&&(this._template.destroy(),this._template=null),this._el=this._row=null,a.prototype.destroy.call(this))};b.prototype.toString=
function(){return"DetailsCell"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"grid",{get:function(){return this._row.grid},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"item",{get:function(){return this._template.dataContext},set:function(a){this._template.dataContext=a},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});return b}(a.BaseObject);c.DetailsCell=B;var D=function(b){function d(c,u){var e=this;b.call(this);this._grid=c;this._el=u.tr;this._item=u.item;this._cells=null;this._objId="r"+a.baseUtils.getNewID();this._rowSelectorCell=this._actionsCell=this._expanderCell=null;this._isSelected=this._isDeleted=this._isCurrent=!1;this._createCells();this._isDeleted=this._item._aspect.isDeleted;
var x=function(){var a=e._grid._getInternal().onRowStateChanged(e,e._item[e._grid.options.rowStateField]);e._setState(a)};this.isHasStateField&&(this._item.addOnPropertyChange(this._grid.options.rowStateField,function(a,b){x()},this._objId),x())}__extends(d,b);d.prototype.handleError=function(a,c){var d=b.prototype.handleError.call(this,a,c);return d?d:this.grid.handleError(a,c)};d.prototype._createCells=function(){var a=this,b=0;a._cells=Array(this.columns.length);this.columns.forEach(function(c){a._cells[b]=
a._createCell(c,b);b+=1})};d.prototype._createCell=function(a,b){var c=e.document.createElement("td");c=a instanceof r?this._expanderCell=new C({row:this,td:c,column:a,num:b}):a instanceof x?this._actionsCell=new y({row:this,td:c,column:a,num:b}):a instanceof u?this._rowSelectorCell=new v({row:this,td:c,column:a,num:b}):new A({row:this,td:c,column:a,num:b});return c};d.prototype._setState=function(a){for(var b=0,c=this._cells.length;b<c;b++){var d=this._cells[b];d instanceof A&&d._setState(a)}};d.prototype._onBeginEdit=
function(){this._cells.forEach(function(a){a instanceof A&&a._beginEdit()});this._actionsCell&&this._actionsCell.update()};d.prototype._onEndEdit=function(a){this._cells.forEach(function(b){b instanceof A&&b._endEdit(a)});this._actionsCell&&this._actionsCell.update()};d.prototype.beginEdit=function(){return this._item._aspect.beginEdit()};d.prototype.endEdit=function(){return this._item._aspect.endEdit()};d.prototype.cancelEdit=function(){return this._item._aspect.cancelEdit()};d.prototype.destroy=
function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this._grid;a&&(this.isExpanded&&a.collapseDetails(),this._cells.forEach(function(a){a.destroy()}),this._cells=null,a._getInternal().getIsClearing()||(a._getInternal().removeRow(this),this._el&&e.$(this._el).remove()));this._item&&this._item.removeNSHandlers(this._objId);this._grid=this._el=this._expanderCell=this._item=null;b.prototype.destroy.call(this)}};d.prototype.deleteRow=function(){this._item._aspect.deleteItem()};d.prototype.updateErrorState=
function(){var a=this._item._aspect.getIsHasErrors(),b=e.$(this._el);a?b.addClass(c.css.rowError):b.removeClass(c.css.rowError)};d.prototype.scrollIntoView=function(a){this._cells&&0<this._cells.length&&this._cells[0].scrollIntoView(a)};d.prototype.toString=function(){return"Row"};Object.defineProperty(d.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"item",{get:function(){return this._item},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"cells",{get:function(){return this._cells},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"columns",{get:function(){return this._grid.columns},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"itemKey",{get:function(){return this._item?this._item._key:
null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isCurrent",{get:function(){return this._isCurrent},set:function(a){if(a!==this._isCurrent){var b=e.$(this._el);(this._isCurrent=a)?b.addClass(c.css.rowHighlight):b.removeClass(c.css.rowHighlight);this.raisePropertyChanged("isCurrent")}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isSelected",{get:function(){return this._isSelected},set:function(a){this._isSelected!=a&&(this._isSelected=a,this.raisePropertyChanged("isSelected"),
this.grid._getInternal().onRowSelectionChanged(this))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isExpanded",{get:function(){return this.grid._getInternal().isRowExpanded(this)},set:function(a){a!==this.isExpanded&&(!a&&this.isExpanded?this.grid._getInternal().expandDetails(this,!1):a&&this.grid._getInternal().expandDetails(this,!0))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"expanderCell",{get:function(){return this._expanderCell},enumerable:!0,configurable:!0});
Object.defineProperty(d.prototype,"actionsCell",{get:function(){return this._actionsCell},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isDeleted",{get:function(){return this._el?this._isDeleted:!0},set:function(a){this._el&&this._isDeleted!==a&&((this._isDeleted=a)?(this.isExpanded=!1,e.$(this._el).addClass(c.css.rowDeleted)):e.$(this._el).removeClass(c.css.rowDeleted))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isEditing",{get:function(){return!!this._item&&
this._item._aspect.isEditing},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isHasStateField",{get:function(){return!!this._grid.options.rowStateField},enumerable:!0,configurable:!0});return d}(a.BaseObject);c.Row=D;var E=function(a){function b(){a.call(this);this._$el=null}__extends(b,a);b.prototype.beforeShow=function(a){this.stop();this._$el=e.$(a);this._$el.hide()};b.prototype.show=function(a){this._$el.slideDown("fast",a)};b.prototype.beforeHide=function(a){this.stop();this._$el=
e.$(a)};b.prototype.hide=function(a){this._$el.slideUp("fast",a)};b.prototype.stop=function(){this._$el&&(this._$el.finish(),this._$el=null)};b.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;try{this.stop()}finally{a.prototype.destroy.call(this)}}};return b}(a.BaseObject),F=function(b){function d(u){b.call(this);var x=this;this._grid=u.grid;this._el=u.tr;this._parentRow=this._cell=this._item=null;this._isFirstShow=!0;this._objId="drow"+a.baseUtils.getNewID();this._createCell(u.details_id);
this._$el=e.$(this._el);this._$el.addClass(c.css.rowDetails);this._grid.addOnRowExpanded(function(a,b){!b.isExpanded&&b.collapsedRow&&x._setParentRow(null)},this._objId,this)}__extends(d,b);d.prototype._createCell=function(a){var b=e.document.createElement("td");this._cell=new B({row:this,td:b,details_id:a})};d.prototype._setParentRow=function(a){var b=this;this._item=null;this._cell.item=null;h.removeNode(this._el);!a||a.getIsDestroyCalled()?this._parentRow=null:(this._parentRow=a,this._item=a.item,
this._cell.item=this._item,this._isFirstShow&&this._initShow(),h.insertAfter(a.el,this._el),this._show(function(){var a=b._parentRow;a&&!a.getIsDestroyCalled()&&b.grid.options.isUseScrollIntoDetails&&a.scrollIntoView(!0)}))};d.prototype._initShow=function(){this._grid.animation.beforeShow(this._cell.template.el)};d.prototype._show=function(a){var b=this._grid.animation;this._isFirstShow=!1;b.beforeShow(this._cell.template.el);b.show(a)};d.prototype._hide=function(a){var b=this._grid.animation;b.beforeHide(this._cell.template.el);
b.hide(a)};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._grid.removeNSHandlers(this._objId),this._cell&&(this._cell.destroy(),this._cell=null),this._$el.remove(),this._grid=this._el=this._item=this._$el=null,b.prototype.destroy.call(this))};d.prototype.toString=function(){return"DetailsRow"};Object.defineProperty(d.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"$el",{get:function(){return this._$el},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"item",{get:function(){return this._item},set:function(a){this._item!==a&&(this._item=a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});
Object.defineProperty(d.prototype,"itemKey",{get:function(){return this._item?this._item._key:null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"parentRow",{get:function(){return this._parentRow},set:function(a){var b=this;a!==this._parentRow&&(b._parentRow?b._hide(function(){b._setParentRow(a)}):b._setParentRow(a))},enumerable:!0,configurable:!0});return d}(a.BaseObject);c.DetailsRow=F;z=function(b){function d(u,x){b.call(this);var w=this;this._grid=u;this._el=x.th;this._options=
x.colinfo;this._isSelected=!1;this._objId="col"+a.baseUtils.getNewID();var r=e.document.createElement("div");this._$extcol=e.$(r);this._$extcol.addClass(c.css.column);this._grid._getInternal().appendToHeader(r);var g=e.document.createElement("div");this._$div=e.$(g);this._$div.addClass(c.css.cellDiv).click(function(a){a.stopPropagation();e.currentSelectable=u;u._getInternal().setCurrentColumn(w);w._onColumnClicked()});r.appendChild(g);this.grid._getInternal().get$El().on("click",["div[",p.DATA_ATTR.DATA_EVENT_SCOPE,
'="',this.uniqueID,'"]'].join(""),function(a){a.stopPropagation();if(a=e.$(this).data("cell"))e.currentSelectable=u,u._getInternal().setCurrentColumn(w),a.click()});this._options.width&&(this._el.style.width=this._options.width);this._init();this._options.colCellCss&&this._$div.addClass(this._options.colCellCss)}__extends(d,b);d.prototype._init=function(){this.title&&this._$div.html(this.title);this._options.tip&&k.fn_addToolTip(this._$extcol,this._options.tip,!1,"bottom center")};d.prototype.destroy=
function(){this._isDestroyed||(this._isDestroyCalled=!0,this._grid._getInternal().get$El().off("click",["div[",p.DATA_ATTR.DATA_EVENT_SCOPE,'="',this.uniqueID,'"]'].join("")),this._options.tip&&k.fn_addToolTip(this._$extcol,null),this._$extcol.remove(),this._options=this._grid=this._el=this._$div=this._$extcol=null,b.prototype.destroy.call(this))};d.prototype.scrollIntoView=function(a){this._$div&&this._$div.get(0).scrollIntoView(!!a)};d.prototype._onColumnClicked=function(){};d.prototype.toString=
function(){return"BaseColumn"};Object.defineProperty(d.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"$div",{get:function(){return this._$div},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"$extcol",{get:function(){return this._$extcol},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"title",{get:function(){return this._options.title},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isSelected",{get:function(){return this._isSelected},set:function(a){this._isSelected!==a&&((this._isSelected=a)?this._$div.addClass(c.css.columnSelected):this._$div.removeClass(c.css.columnSelected))},
enumerable:!0,configurable:!0});return d}(a.BaseObject);c.BaseColumn=z;var G=function(a){function b(d,u){a.call(this,d,u);this._objCache={};this.$div.addClass(c.css.dataColumn)}__extends(b,a);b.prototype._init=function(){a.prototype._init.call(this);this._sortOrder=null;this.isSortable&&this.$div.addClass(c.css.colSortable)};b.prototype._onColumnClicked=function(){if(this.isSortable&&this.sortMemberName){var a=this._sortOrder;this.grid._getInternal().resetColumnsSort();this.sortOrder=0==a?1:0;this.grid.sortByColumn(this)}};
b.prototype._cacheObject=function(a,b){this._objCache[a]=b};b.prototype._getCachedObject=function(a){return this._objCache[a]};b.prototype._getInitContentFn=function(){var a=this;return function(b){b.addOnObjectCreated(function(b,c){a._cacheObject(c.objectKey,c.object);c.isCachedExternally=!!a._getCachedObject(c.objectKey)});b.addOnObjectNeeded(function(b,c){c.object=a._getCachedObject(c.objectKey)})}};b.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var b=this;h.forEachProp(b._objCache,
function(a){b._objCache[a].destroy()});b._objCache=null;a.prototype.destroy.call(this)}};b.prototype.toString=function(){return"DataColumn"};Object.defineProperty(b.prototype,"isSortable",{get:function(){return!!this.options.sortable},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sortMemberName",{get:function(){return this.options.sortMemberName},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sortOrder",{get:function(){return this._sortOrder},set:function(a){this.$div.removeClass([c.css.colSortable,
c.css.colSortAsc,c.css.colSortDesc].join(" "));switch(a){case 0:this.$div.addClass(c.css.colSortAsc);break;case 1:this.$div.addClass(c.css.colSortDesc);break;default:this.isSortable&&this.$div.addClass(c.css.colSortable)}this._sortOrder=a;this.raisePropertyChanged("sortOrder")},enumerable:!0,configurable:!0});return b}(z);c.DataColumn=G;var r=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(){a.prototype._init.call(this);this.$div.addClass(c.css.rowExpander)};
b.prototype.toString=function(){return"ExpanderColumn"};return b}(z);c.ExpanderColumn=r;var u=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(){a.prototype._init.call(this);var b=this;this._val=!1;this.$div.addClass(c.css.rowSelector);var d=e.$('<input type="checkbox"/>');this.$div.append(d);this._$chk=d;d.click(function(a){a.stopPropagation();b._onCheckBoxClicked(this.checked)});d.on("change",function(a){a.stopPropagation();b.checked=this.checked})};b.prototype._onCheckBoxClicked=
function(a){this.grid.selectRows(a)};b.prototype.toString=function(){return"RowSelectorColumn"};Object.defineProperty(b.prototype,"checked",{get:function(){return this._val},set:function(a){var b=this._$chk;null!==a&&(a=!!a);a!==this._val&&(this._val=a,b&&b.prop("checked",!!this._val),this.raisePropertyChanged("checked"))},enumerable:!0,configurable:!0});b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._$chk.off(),this._$chk.remove(),this._$chk=null,a.prototype.destroy.call(this))};
return b}(z);c.RowSelectorColumn=u;var x=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(){a.prototype._init.call(this);var b=this,d=this.options;this.$div.addClass(c.css.rowActions);d.img_ok=e.getImagePath(d.img_ok||"ok.png");d.img_cancel=e.getImagePath(d.img_cancel||"cancel.png");d.img_edit=e.getImagePath(d.img_edit||"edit.png");d.img_delete=e.getImagePath(d.img_delete||"delete.png");this.grid._getInternal().get$El().on("click","img["+p.DATA_ATTR.DATA_EVENT_SCOPE+
'="'+this.uniqueID+'"]',function(a){a.stopPropagation();var c=e.$(this);a=this.name;c=c.data("cell");b.grid.currentRow=c.row;switch(a){case "img_ok":b._onOk(c);break;case "img_cancel":b._onCancel(c);break;case "img_edit":b._onEdit(c);break;case "img_delete":b._onDelete(c)}});this.grid.addOnRowAction(function(a,c){switch(c.action){case 0:b._onOk(c.row.actionsCell);break;case 1:b._onEdit(c.row.actionsCell);break;case 2:b._onCancel(c.row.actionsCell);break;case 3:b._onDelete(c.row.actionsCell)}},this.uniqueID)};
b.prototype._onOk=function(a){a.row&&(a.row.endEdit(),a.update())};b.prototype._onCancel=function(a){a.row&&(a.row.cancelEdit(),a.update())};b.prototype._onDelete=function(a){a.row&&a.row.deleteRow()};b.prototype._onEdit=function(a){a.row&&(a.row.beginEdit(),a.update(),this.grid.showEditDialog())};b.prototype.toString=function(){return"ActionsColumn"};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.grid._getInternal().get$El().off("click","img["+p.DATA_ATTR.DATA_EVENT_SCOPE+
'="'+this.uniqueID+'"]'),this.grid.removeNSHandlers(this.uniqueID),a.prototype.destroy.call(this))};return b}(z);c.ActionsColumn=x;var w={row_expanded:"row_expanded",row_selected:"row_selected",page_changed:"page_changed",row_state_changed:"row_state_changed",cell_dblclicked:"cell_dblclicked",row_action:"row_action"},s=function(f){function s(u){f.call(this);var x=this;u=h.mergeObj(u,{app:null,el:null,dataSource:null,animation:null,isUseScrollInto:!0,isUseScrollIntoDetails:!0,containerCss:null,wrapCss:null,
headerCss:null,rowStateField:null,isCanEdit:null,isCanDelete:null,isHandleAddNew:!1});if(u.dataSource&&!(u.dataSource instanceof n.BaseCollection))throw Error(a.ERRS.ERR_GRID_DATASRC_INVALID);this._options=u;this._columnWidthChecker=function(){};u=e.$(this._options.el);this._el=this._options.el;this._$el=u;u.addClass(c.css.dataTable);this._name=u.attr(p.DATA_ATTR.DATA_NAME);this._objId="grd"+a.baseUtils.getNewID();this._rowMap={};this._rows=[];this._columns=[];this._isDSFilling=this._isClearing=!1;
this._editingRow=this._currentColumn=this._rowSelectorCol=this._actionsCol=this._expanderCol=this._details=this._expandedRow=this._currentRow=null;this._isSorting=!1;this._contaner=this._$wrapDiv=this._$headerDiv=this._dialog=null;this._wrapTable();this._selectable={getContainerEl:function(){return x._getContainerEl()},getUniqueID:function(){return x.uniqueID},onKeyDown:function(a,b){x._onKeyDown(a,b)},onKeyUp:function(a,b){x._onKeyUp(a,b)}};this._internal={isRowExpanded:function(a){return x._isRowExpanded(a)},
appendToHeader:function(a){x._appendToHeader(a)},setCurrentColumn:function(a){x._setCurrentColumn(a)},onRowStateChanged:function(a,b){return x._onRowStateChanged(a,b)},onCellDblClicked:function(a){x._onCellDblClicked(a)},onRowSelectionChanged:function(a){x._onRowSelectionChanged(a)},resetColumnsSort:function(){x._resetColumnsSort()},getLastRow:function(){return x._getLastRow()},removeRow:function(a){x._removeRow(a)},expandDetails:function(a,b){x._expandDetails(a,b)},getIsClearing:function(){return x._getIsClearing()},
get$El:function(){return x._get$El()}};this._createColumns();this._bindDS();e._getInternal().trackSelectable(this);m[this.uniqueID]=this;d+=1;1==d&&(b=setInterval(q,250))}__extends(s,f);s.prototype._getEventNames=function(){var a=f.prototype._getEventNames.call(this);return Object.keys(w).map(function(a,b,c){return w[a]}).concat(a)};s.prototype.addOnRowExpanded=function(a,b,c){this._addHandler(w.row_expanded,a,b,c)};s.prototype.removeOnRowExpanded=function(a){this._removeHandler(w.row_expanded,a)};
s.prototype.addOnRowSelected=function(a,b,c){this._addHandler(w.row_selected,a,b,c)};s.prototype.removeOnRowSelected=function(a){this._removeHandler(w.row_selected,a)};s.prototype.addOnPageChanged=function(a,b,c){this._addHandler(w.page_changed,a,b,c)};s.prototype.removeOnPageChanged=function(a){this._removeHandler(w.page_changed,a)};s.prototype.addOnRowStateChanged=function(a,b,c){this._addHandler(w.row_state_changed,a,b,c)};s.prototype.removeOnRowStateChanged=function(a){this._removeHandler(w.row_state_changed,
a)};s.prototype.addOnCellDblClicked=function(a,b,c){this._addHandler(w.cell_dblclicked,a,b,c)};s.prototype.removeOnCellDblClicked=function(a){this._removeHandler(w.cell_dblclicked,a)};s.prototype.addOnRowAction=function(a,b,c){this._addHandler(w.row_action,a,b,c)};s.prototype.removeOnRowAction=function(a){this._removeHandler(w.row_action,a)};s.prototype._getContainerEl=function(){return this._contaner};s.prototype._onKeyDown=function(a,b){var c=this.dataSource;if(c)switch(a){case 38:b.preventDefault();
c.movePrev(!0)&&this.isUseScrollInto&&this._scrollToCurrent(!1);break;case 40:b.preventDefault();c.moveNext(!0)&&this.isUseScrollInto&&this._scrollToCurrent(!1);break;case 34:0<c.pageIndex&&--c.pageIndex;break;case 33:c.pageIndex+=1;break;case 13:this._currentRow&&this._actionsCol&&b.preventDefault();break;case 27:this._currentRow&&this._actionsCol&&this._currentRow.isEditing&&b.preventDefault();break;case 32:this._rowSelectorCol&&this._currentRow&&!this._currentRow.isEditing&&b.preventDefault()}};
s.prototype._onKeyUp=function(a,b){if(this.dataSource)switch(a){case 13:this._currentRow&&this._actionsCol&&(this._currentRow.isEditing?this.raiseEvent(w.row_action,{row:this._currentRow,action:0}):this.raiseEvent(w.row_action,{row:this._currentRow,action:1}),b.preventDefault());break;case 27:this._currentRow&&this._actionsCol&&this._currentRow.isEditing&&(this.raiseEvent(w.row_action,{row:this._currentRow,action:2}),b.preventDefault());break;case 32:this._rowSelectorCol&&this._currentRow&&!this._currentRow.isEditing&&
(b.preventDefault(),this._currentRow.isSelected=!this._currentRow.isSelected)}};s.prototype._isRowExpanded=function(a){return this._expandedRow===a};s.prototype._appendToHeader=function(a){this._$headerDiv.append(a)};s.prototype._setCurrentColumn=function(a){this._currentColumn&&(this._currentColumn.isSelected=!1);if(this._currentColumn=a)this._currentColumn.isSelected=!0};s.prototype._onRowStateChanged=function(a,b){var c={row:a,val:b,css:null};this.raiseEvent(w.row_state_changed,c);return c.css};
s.prototype._onCellDblClicked=function(a){this.raiseEvent(w.cell_dblclicked,{cell:a})};s.prototype._onRowSelectionChanged=function(a){this.raiseEvent(w.row_selected,{row:a})};s.prototype._resetColumnsSort=function(){this.columns.forEach(function(a){a instanceof G&&(a.sortOrder=null)})};s.prototype._getLastRow=function(){if(0===this._rows.length)return null;for(var a=this._rows.length-1,b=this._rows[a];b.isDeleted&&0<a;)--a,b=this._rows[a];return b.isDeleted?null:b};s.prototype._removeRow=function(a){this._expandedRow===
a&&this.collapseDetails();if(0!==this._rows.length){var b=a.itemKey,c=h.removeFromArray(this._rows,a);try{-1<c&&(a.getIsDestroyCalled()||a.destroy())}finally{this._rowMap[b]&&delete this._rowMap[b]}}};s.prototype._expandDetails=function(a,b){if(this._options.details){this._details||(this._details=this._createDetails());var c=this._expandedRow;c===a&&c&&b||(this._expandedRow=null,this._details.parentRow=null,b?(this._expandedRow=a,this._details.parentRow=a,this._expandedRow.expanderCell.toggleImage()):
(this._expandedRow=null,this._details.parentRow=null,c&&c.expanderCell.toggleImage()),c!==a&&c&&c.expanderCell.toggleImage(),this.raiseEvent(w.row_expanded,{collapsedRow:c,expandedRow:a,isExpanded:b}))}};s.prototype._getIsClearing=function(){return this._isClearing};s.prototype._get$El=function(){return this._$el};s.prototype._parseColumnAttr=function(a,b){var c={type:"data",title:null,sortable:!1,sortMemberName:null,content:null},d=e.parser.parseOptions(a),c=0<d.length?h.extend(!1,c,d[0]):c;b&&(c.content=
g.parseContentAttr(b),!c.sortMemberName&&c.content.fieldName&&(c.sortMemberName=c.content.fieldName));return c};s.prototype._findUndeleted=function(a,b){if(!a)return null;if(!a.isDeleted)return a;var c=this.rows.indexOf(a),d=this.rows.length;if(b)for(c+=1,c<d&&(a=this.rows[c]);c<d&&a.isDeleted;)c+=1,c<d&&(a=this.rows[c]);else for(--c,0<=c&&(a=this.rows[c]);0<=c&&a.isDeleted;)--c,0<=c&&(a=this.rows[c]);a.isDeleted&&(a=null);return a};s.prototype._updateCurrent=function(a,b){this.currentRow=a;b&&a&&
!a.isDeleted&&this._scrollToCurrent(!0)};s.prototype._scrollToCurrent=function(a){var b=this.currentRow;b&&b.scrollIntoView(a)};s.prototype.handleError=function(a,b){var c=f.prototype.handleError.call(this,a,b);return c?c:e.handleError(a,b)};s.prototype._onDSCurrentChanged=function(a,b){var c=this.dataSource,d;c&&(d=c.currentItem);d?this._updateCurrent(this._rowMap[d._key],!1):this._updateCurrent(null,!1)};s.prototype._onDSCollectionChanged=function(b,c){var d=this,u;u=c.items;switch(c.changeType){case 2:this._isDSFilling||
this._refreshGrid();break;case 1:this._isDSFilling||d._appendItems(c.items);break;case 0:u.forEach(function(a){(a=d._rowMap[a._key])&&d._removeRow(a)});break;case 3:if(u=d._rowMap[c.old_key])delete d._rowMap[c.old_key],d._rowMap[c.new_key]=u;break;default:throw Error(h.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,c.changeType));}};s.prototype._onDSFill=function(a,b){var c=this;b.isBegin?(c._isDSFilling=!0,c._isSorting||b.isPageChanged||c._resetColumnsSort()):(c._isDSFilling=!1,b.resetUI?c._refreshGrid():
c._appendItems(b.newItems),b.isPageChanged&&setTimeout(function(){c._isDestroyCalled||c._onPageChanged()},0),setTimeout(function(){c._isDestroyCalled||c._updateColsDim()},0))};s.prototype._onPageChanged=function(){this._rowSelectorCol&&(this._rowSelectorCol.checked=!1);this._scrollToCurrent(!1);this.raiseEvent(w.page_changed,{})};s.prototype._onItemEdit=function(a,b,c){if(a=this._rowMap[a._key])b?(a._onBeginEdit(),this._editingRow=a):(a._onEndEdit(c),this._editingRow=null),this.raisePropertyChanged("editingRow")};
s.prototype._onItemAdded=function(a,b){var c=this._rowMap[b.item._key];c&&(this._updateCurrent(c,!0),this._options.isHandleAddNew&&!b.isAddNewHandled&&(b.isAddNewHandled=this.showEditDialog()))};s.prototype._onItemStatusChanged=function(a,b){var c=a._aspect.status,d=this.dataSource,u=this._rowMap[a._key];u&&(3===c?(u.isDeleted=!0,(c=this._findUndeleted(u,!0))||(c=this._findUndeleted(u,!1)),c&&(d.currentItem=c.item)):3===b&&3!==c&&(u.isDeleted=!1))};s.prototype._onDSErrorsChanged=function(a,b){var c=
this._rowMap[b.item._key];c&&c.updateErrorState()};s.prototype._bindDS=function(){var a=this,b=this.dataSource;b&&(b.addOnCollChanged(a._onDSCollectionChanged,a._objId,a),b.addOnFill(a._onDSFill,a._objId,a),b.addOnCurrentChanged(a._onDSCurrentChanged,a._objId,a),b.addOnBeginEdit(function(b,c){a._onItemEdit(c.item,!0,!1)},a._objId),b.addOnEndEdit(function(b,c){a._onItemEdit(c.item,!1,c.isCanceled)},a._objId),b.addOnErrorsChanged(a._onDSErrorsChanged,a._objId,a),b.addOnStatusChanged(function(b,c){a._onItemStatusChanged(c.item,
c.oldStatus)},a._objId),b.addOnItemAdded(a._onItemAdded,a._objId,a),this._refreshGrid(),this._updateColsDim(),this._onDSCurrentChanged())};s.prototype._unbindDS=function(){var a=this.dataSource;a&&a.removeNSHandlers(this._objId)};s.prototype._clearGrid=function(){if(0!==this._rows.length){this._isClearing=!0;try{this.collapseDetails();var a=this._tBodyEl,b=e.document.createElement("tbody");this._el.replaceChild(b,a);var c=this._rows;this._rows=[];this._rowMap={};c.forEach(function(a){a.destroy()})}finally{this._isClearing=
!1}this._currentRow=null}};s.prototype._updateColsDim=function(){var a=0,b=this._$headerDiv;this._columns.forEach(function(b){a+=b.el.offsetWidth});b.width(a);this._columns.forEach(function(a){a.$extcol.width(a.el.offsetWidth)})};s.prototype._wrapTable=function(){var a=this._$el,b,d,u,x=this;a.wrap(e.$("<div></div>").addClass(c.css.wrapDiv));d=a.parent();d.wrap(e.$("<div></div>").addClass(c.css.container));u=d.parent();b=e.$("<div></div>").addClass(c.css.headerDiv).insertBefore(d);e.$(this._tHeadRow).addClass(c.css.columnInfo);
this._$wrapDiv=d;this._$headerDiv=b;this._contaner=u.get(0);this._options.containerCss&&u.addClass(this._options.containerCss);this._options.wrapCss&&d.addClass(this._options.wrapCss);this._options.headerCss&&b.addClass(this._options.headerCss);var w=a.width();x._columnWidthChecker=function(){var b=a.width();w!==b&&(w=b,x._updateColsDim())}};s.prototype._unWrapTable=function(){var a=this._$el;this._$headerDiv&&(this._columnWidthChecker=function(){},this._$headerDiv.remove(),this._$headerDiv=null,
a.unwrap(),this._$wrapDiv=null,a.unwrap(),this._contaner=null)};s.prototype._createColumns=function(){for(var a=this,b=this._tHeadCells,c=b.length,d=[],u,e,x=0;x<c;x+=1)u=b[x],e=this._parseColumnAttr(u.getAttribute(p.DATA_ATTR.DATA_COLUMN),u.getAttribute(p.DATA_ATTR.DATA_CONTENT)),d.push({th:u,colinfo:e});d.forEach(function(b){(b=a._createColumn(b))&&a._columns.push(b)})};s.prototype._createColumn=function(b){var c;switch(b.colinfo.type){case "row_expander":this._expanderCol||(this._expanderCol=c=
new r(this,b));break;case "row_actions":this._actionsCol||(this._actionsCol=c=new x(this,b));break;case "row_selector":this._rowSelectorCol||(this._rowSelectorCol=c=new u(this,b));break;case "data":c=new G(this,b);break;default:throw Error(h.format(a.ERRS.ERR_GRID_COLTYPE_INVALID,b.colinfo.type));}return c};s.prototype._appendItems=function(a){if(!this._isDestroyCalled)for(var b,c=this._tBodyEl,d=0,u=a.length;d<u;d+=1)b=a[d],this._rowMap[b._key]||this._createRowForItem(c,b)};s.prototype._refreshGrid=
function(){var a=this,b=this.dataSource;a._clearGrid();if(b){var c=e.document.createDocumentFragment(),d=this._tBodyEl,u=e.document.createElement("tbody");b.items.forEach(function(b,d){a._createRowForItem(c,b,d)});u.appendChild(c);a._el.replaceChild(u,d)}};s.prototype._createRowForItem=function(a,b,c){c=e.document.createElement("tr");c=new D(this,{tr:c,item:b});this._rowMap[b._key]=c;this._rows.push(c);a.appendChild(c.el);return c};s.prototype._createDetails=function(){var a=this._options.details.templateID,
b=e.document.createElement("tr");return new F({grid:this,tr:b,details_id:a})};s.prototype._getInternal=function(){return this._internal};s.prototype.getISelectable=function(){return this._selectable};s.prototype.sortByColumn=function(a){var b=this,c=this.dataSource,d=a.sortMemberName.split(";");b._isSorting=!0;c.sort(d,a.sortOrder).always(function(){b._isSorting=!1})};s.prototype.selectRows=function(a){this._rows.forEach(function(b){b.isDeleted||(b.isSelected=a)})};s.prototype.findRowByItem=function(a){return(a=
this._rowMap[a._key])?a:null};s.prototype.collapseDetails=function(){if(this._details){var a=this._expandedRow;a&&(this._expandedRow=null,this.raiseEvent(w.row_expanded,{collapsedRow:a,expandedRow:null,isExpanded:!1}))}};s.prototype.getSelectedRows=function(){var a=[];this._rows.forEach(function(b){b.isDeleted||b.isSelected&&a.push(b)});return a};s.prototype.showEditDialog=function(){if(!this._options.editor||!this._options.editor.templateID||!this._editingRow)return!1;var a,b=this._editingRow.item;
b._aspect.isEditing||b._aspect.beginEdit();this._dialog?this._dialog.dataContext=b:(a=h.extend(!1,{dataContext:b},this._options.editor),this._dialog=new t.datadialog.DataEditDialog(this.app,a));this._dialog.canRefresh=!!this.dataSource.permissions.canRefreshRow&&!b._aspect.isNew;this._dialog.show();return!0};s.prototype.scrollToCurrent=function(a){this._scrollToCurrent(a)};s.prototype.addNew=function(){var b=this.dataSource;try{b.addNew(),this.showEditDialog()}catch(c){a.reThrow(c,this.handleError(c,
this))}};s.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,delete m[this.uniqueID],--d,0==d&&clearInterval(b),e._getInternal().untrackSelectable(this),this._details&&(this._details.destroy(),this._details=null),this._options.animation&&(this._options.animation.stop(),this._options.animation=null),this._dialog&&(this._dialog.destroy(),this._dialog=null),this.dataSource=null,this._unWrapTable(),this._$el.removeClass(c.css.dataTable),e.$(this._tHeadRow).removeClass(c.css.columnInfo),
this._$el=this._el=null,this._options.app=null,this._options={},f.prototype.destroy.call(this))};Object.defineProperty(s.prototype,"app",{get:function(){return this._options.app},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"_tBodyEl",{get:function(){return this._el.tBodies[0]},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"_tHeadEl",{get:function(){return this._el.tHead},
enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"_tFootEl",{get:function(){return this._el.tFoot},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"_tHeadRow",{get:function(){if(!this._tHeadEl)return null;var a=this._tHeadEl.rows;return 0===a.length?null:a[0]},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"_tHeadCells",{get:function(){var b=this._tHeadRow;return b?a.ArrayHelper.fromCollection(b.cells):[]},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,
"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"dataSource",{get:function(){return this._options.dataSource},set:function(a){a!==this.dataSource&&(this.dataSource&&this._unbindDS(),this._clearGrid(),this._options.dataSource=a,this.dataSource&&this._bindDS(),this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});
Object.defineProperty(s.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"columns",{get:function(){return this._columns},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"currentRow",{get:function(){return this._currentRow},set:function(a){var b=this.dataSource,c=this._currentRow,d=!1;b&&(c!==a&&(this._currentRow=a,c&&(c.isCurrent=!1),a&&(a.isCurrent=!0),d=!0),a?a.item!==b.currentItem&&(b.currentItem=a.item):b.currentItem=
null,d&&this.raisePropertyChanged("currentRow"))},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"editingRow",{get:function(){return this._editingRow},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"isCanEdit",{get:function(){if(null!==this._options.isCanEdit)return this._options.isCanEdit;var a=this.dataSource;return!!a&&a.permissions.canEditRow},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"isCanDelete",{get:function(){if(null!==this._options.isCanDelete)return this._options.isCanDelete;
var a=this.dataSource;return!!a&&a.permissions.canDeleteRow},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"isCanAddNew",{get:function(){var a=this.dataSource;return!!a&&a.permissions.canAddRow},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"isUseScrollInto",{get:function(){return this._options.isUseScrollInto},set:function(a){this._options.isUseScrollInto=a},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"animation",{get:function(){this.options.animation||
(this.options.animation=new E);return this.options.animation},enumerable:!0,configurable:!0});return s}(a.BaseObject);c.DataGrid=s;z=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype.toString=function(){return"GridElView"};b.prototype._init=function(b){a.prototype._init.call(this,b);this._grid=this._stateProvider=null;this._options=b;this._createGrid()};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._grid&&!this._grid.getIsDestroyCalled()&&
this._grid.destroy(),this._stateProvider=this._grid=null,a.prototype.destroy.call(this))};b.prototype._createGrid=function(){var a=h.extend(!1,{app:this._app,el:this._el,dataSource:null,animation:null},this._options);this._grid=new s(a);this._bindGridEvents()};b.prototype._bindGridEvents=function(){this._grid&&(this._grid.addOnRowStateChanged(function(a,b){this._stateProvider&&(b.css=this._stateProvider.getCSS(b.row.item,b.val))},this.uniqueID,this),this._grid.addOnDestroyed(function(a,b){this._grid=
null;this.invokePropChanged("grid");this.raisePropertyChanged("grid")},this.uniqueID,this))};Object.defineProperty(b.prototype,"dataSource",{get:function(){return this._isDestroyCalled?void 0:this.grid.dataSource},set:function(a){this._isDestroyCalled||this.dataSource===a||(this.grid.dataSource=a,this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"stateProvider",{get:function(){return this._stateProvider},set:function(a){a!==this._stateProvider&&(this._stateProvider=a,this.raisePropertyChanged("stateProvider"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"animation",{get:function(){return this._isDestroyCalled?void 0:this._grid.options.animation},set:function(a){this._isDestroyCalled||this.animation===a||(this._grid.options.animation=a,this.raisePropertyChanged("animation"))},enumerable:!0,configurable:!0});return b}(k.BaseElView);
c.GridElView=z;e.registerElView("table",z);e.registerElView("datagrid",z);c._isModuleLoaded=!0})(t.datagrid||(t.datagrid={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=a.MOD.collection,p=a.MOD.baseElView,k;a.global.addOnInitialize(function(a,c){k=a.utils});c.css={pager:"ria-data-pager",info:"pager-info",currentPage:"pager-current-page",otherPage:"pager-other-page"};var g=a.localizable.PAGER,n=function(h){function e(b){h.call(this);b=k.extend(!1,{app:null,el:null,dataSource:null,showTip:!0,showInfo:!1,showNumbers:!0,showFirstAndLast:!0,showPreviousAndNext:!1,useSlider:!0,hideOnSinglePage:!0,sliderSize:25},b);if(b.dataSource&&
!(b.dataSource instanceof q.BaseCollection))throw Error(a.ERRS.ERR_PAGER_DATASRC_INVALID);this._options=b;this._$el=a.global.$(b.el);this._objId="pgr"+a.baseUtils.getNewID();this._rowCount=this._rowsPerPage=0;this._currentPage=1;this._$el.addClass(c.css.pager);this._options.dataSource&&this._bindDS()}__extends(e,h);e.prototype._createElement=function(b){return a.global.$(a.global.document.createElement(b))};e.prototype._render=function(){var a=this._$el,d,e;this._clearContent();if(!(0>=this.rowsPerPage)&&
(d=this.rowCount,0!=d&&(d=this.currentPage,0!=d)))if(e=this.pageCount,this.hideOnSinglePage&&1==e)a.hide();else{a.show();if(this.showInfo){var f=this._createElement("span"),h=k.format(g.pageInfo,d,e);f.addClass(c.css.info).text(h).appendTo(a)}this.showFirstAndLast&&1!=d&&a.append(this._createFirst());this.showPreviousAndNext&&1!=d&&a.append(this._createPrevious());if(this.showNumbers){var f=1,h=e,l=this.sliderSize;this.useSlider&&0<l&&(f=Math.floor((l-1)/2),h=d+f+(l-1)%2,f=d-f,1>f&&(h+=1-f,f=1),h>
e&&(f-=h-e,1>f&&(f=1),h=e));for(;f<=h;f++)f===d?a.append(this._createCurrent()):a.append(this._createOther(f))}this.showPreviousAndNext&&d!=e&&a.append(this._createNext());this.showFirstAndLast&&d!=e&&a.append(this._createLast())}};e.prototype._setDSPageIndex=function(a){this.dataSource.pageIndex=a-1};e.prototype._onPageSizeChanged=function(a,c){this.rowsPerPage=a.pageSize};e.prototype._onPageIndexChanged=function(a,c){this.currentPage=a.pageIndex+1};e.prototype._onTotalCountChanged=function(a,c){this.rowCount=
a.totalCount};e.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._unbindDS(),this._clearContent(),this._$el.removeClass(c.css.pager),this._$el=null,this._options={},h.prototype.destroy.call(this))};e.prototype._bindDS=function(){var a=this,c=this.dataSource;c&&(c.addOnFill(function(c,d){d.isBegin||d.isPageChanged||(a._unbindDS(),setTimeout(function(){a._bindDS()},0))},a._objId),c.addOnPageIndexChanged(a._onPageIndexChanged,a._objId,a),c.addOnPageSizeChanged(a._onPageSizeChanged,
a._objId,a),c.addOnTotalCountChanged(a._onTotalCountChanged,a._objId,a),this._currentPage=c.pageIndex+1,this._rowsPerPage=c.pageSize,this._rowCount=c.totalCount,this._render())};e.prototype._unbindDS=function(){var a=this.dataSource;a&&a.removeNSHandlers(this._objId)};e.prototype._clearContent=function(){this._$el.empty()};e.prototype._createLink=function(a,c,e){var g=this._createElement("a"),h=this;g.text(""+c);g.attr("href","javascript:void(0)");e&&p.fn_addToolTip(g,e);g.click(function(c){c.preventDefault();
h._setDSPageIndex(a);h.currentPage=a});return g};e.prototype._createFirst=function(){var a=this._createElement("span"),d;this.showTip&&(d=g.firstPageTip);d=this._createLink(1,g.firstText,d);a.addClass(c.css.otherPage).append(d);return a};e.prototype._createPrevious=function(){var a=this._createElement("span"),d=this.currentPage-1,e;this.showTip&&(e=k.format(g.prevPageTip,d));d=this._createLink(d,g.previousText,e);a.addClass(c.css.otherPage).append(d);return a};e.prototype._createCurrent=function(){var a=
this._createElement("span"),d=this.currentPage;a.text(""+d);this.showTip&&p.fn_addToolTip(a,this._buildTip(d));a.addClass(c.css.currentPage);return a};e.prototype._createOther=function(a){var d=this._createElement("span"),e;this.showTip&&(e=this._buildTip(a));a=this._createLink(a,""+a,e);d.addClass(c.css.otherPage);d.append(a);return d};e.prototype._createNext=function(){var a=this._createElement("span"),d=this.currentPage+1,e;this.showTip&&(e=k.format(g.nextPageTip,d));d=this._createLink(d,g.nextText,
e);a.addClass(c.css.otherPage).append(d);return a};e.prototype._createLast=function(){var a=this._createElement("span"),d;this.showTip&&(d=g.lastPageTip);d=this._createLink(this.pageCount,g.lastText,d);a.addClass(c.css.otherPage).append(d);return a};e.prototype._buildTip=function(a){var c=this.rowsPerPage,e=this.rowCount,f=(a-1)*c+1,c=a==this.pageCount?e:a*c,h="";return h=a==this.currentPage?k.format(g.showingTip,f,c,e):k.format(g.showTip,f,c,e)};e.prototype.toString=function(){return"Pager"};Object.defineProperty(e.prototype,
"app",{get:function(){return this._options.app},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"el",{get:function(){return this._options.el},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._options.dataSource},set:function(a){a!==this.dataSource&&(this.dataSource&&this._unbindDS(),this._options.dataSource=a,this.dataSource&&this._bindDS(),this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"pageCount",{get:function(){var a=this.rowCount,c=this.rowsPerPage;return 0===a||0===c?0:0===a%c?a/c:a=Math.floor(a/c)+1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"rowCount",{get:function(){return this._rowCount},set:function(a){this._rowCount!=a&&(this._rowCount=a,this._render(),this.raisePropertyChanged("rowCount"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"rowsPerPage",{get:function(){return this._rowsPerPage},set:function(a){this._rowsPerPage!=
a&&(this._rowsPerPage=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"currentPage",{get:function(){return this._currentPage},set:function(a){this._currentPage!=a&&(this._currentPage=a,this._render(),this.raisePropertyChanged("currentPage"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"useSlider",{get:function(){return this._options.useSlider},set:function(a){this.useSlider!==a&&(this._options.useSlider=a,this._render())},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"sliderSize",{get:function(){return this._options.sliderSize},set:function(a){this.sliderSize!==a&&(this._options.sliderSize=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hideOnSinglePage",{get:function(){return this._options.hideOnSinglePage},set:function(a){this.hideOnSinglePage!==a&&(this._options.hideOnSinglePage=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"showTip",{get:function(){return this._options.showTip},
set:function(a){this.showTip!==a&&(this._options.showTip=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"showInfo",{get:function(){return this._options.showInfo},set:function(a){this._options.showInfo!==a&&(this._options.showInfo=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"showFirstAndLast",{get:function(){return this._options.showFirstAndLast},set:function(a){this.showFirstAndLast!==a&&(this._options.showFirstAndLast=
a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"showPreviousAndNext",{get:function(){return this._options.showPreviousAndNext},set:function(a){this.showPreviousAndNext!==a&&(this._options.showPreviousAndNext=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"showNumbers",{get:function(){return this._options.showNumbers},set:function(a){this.showNumbers!==a&&(this._options.showNumbers=a,this._render())},enumerable:!0,configurable:!0});
return e}(a.BaseObject);c.Pager=n;var l=function(a){function c(b,d,e){var g=this;this._pager=null;this._options=e;var l=k.extend(!1,{app:b,el:d,dataSource:null},this._options);this._pager=new n(l);this._pager.addOnDestroyed(function(){g._pager=null;g.invokePropChanged("pager");g.raisePropertyChanged("pager")});a.call(this,b,d,e)}__extends(c,a);c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._pager&&!this._pager.getIsDestroyCalled()&&this._pager.destroy(),this._pager=
null,a.prototype.destroy.call(this))};c.prototype.toString=function(){return"PagerElView"};Object.defineProperty(c.prototype,"dataSource",{get:function(){return this._isDestroyCalled?void 0:this._pager.dataSource},set:function(a){this._isDestroyCalled||this.dataSource===a||(this._pager.dataSource=a,this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"pager",{get:function(){return this._pager},enumerable:!0,configurable:!0});return c}(p.BaseElView);
c.PagerElView=l;a.global.registerElView("pager",l);c._isModuleLoaded=!0})(t.pager||(t.pager={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){var q=a.consts,p=a.MOD.collection,k,g=a.global;g.addOnInitialize(function(a,c){k=a.utils});c.css={stackpanel:"ria-stackpanel",item:"stackpanel-item",currentItem:"current-item"};var n=function(h){function e(b){h.call(this);var d=this;b=k.extend(!1,{app:null,el:null,dataSource:null,orientation:"horizontal",templateID:null},b);if(b.dataSource&&!(b.dataSource instanceof p.BaseCollection))throw Error(a.ERRS.ERR_STACKPNL_DATASRC_INVALID);if(!b.templateID)throw Error(a.ERRS.ERR_STACKPNL_TEMPLATE_INVALID);
this._options=b;this._$el=g.$(b.el);this._objId="pnl"+a.baseUtils.getNewID();this._isDSFilling=!1;this._currentItem=null;this._$el.addClass(c.css.stackpanel);this._itemMap={};this._selectable={getContainerEl:function(){return d._getContainerEl()},getUniqueID:function(){return d.uniqueID},onKeyDown:function(a,b){d._onKeyDown(a,b)},onKeyUp:function(a,b){d._onKeyUp(a,b)}};this._$el.on("click",["div[",q.DATA_ATTR.DATA_EVENT_SCOPE,'="',this.uniqueID,'"]'].join(""),function(a){a.stopPropagation();a=g.$(this).data("data");
d._onItemClicked(a.div,a.item)});b.dataSource&&this._bindDS();g._getInternal().trackSelectable(this)}__extends(e,h);e.prototype._getEventNames=function(){var a=h.prototype._getEventNames.call(this);return["item_clicked"].concat(a)};e.prototype.templateLoading=function(a){};e.prototype.templateLoaded=function(a){};e.prototype.templateUnLoading=function(a){};e.prototype.addOnItemClicked=function(a,c,e){this._addHandler("item_clicked",a,c,e)};e.prototype.removeOnItemClicked=function(a){this._removeHandler("item_clicked",
a)};e.prototype._getContainerEl=function(){return this._options.el};e.prototype._onKeyDown=function(a,c){var e=this.dataSource;if(e)if("horizontal"==this.orientation)switch(a){case 37:c.preventDefault();e.movePrev(!0)&&this.scrollIntoView(e.currentItem);break;case 39:c.preventDefault(),e.moveNext(!0)&&this.scrollIntoView(e.currentItem)}else switch(a){case 38:c.preventDefault();e.movePrev(!0)&&this.scrollIntoView(e.currentItem);break;case 40:c.preventDefault(),e.moveNext(!0)&&this.scrollIntoView(e.currentItem)}};
e.prototype._onKeyUp=function(a,c){};e.prototype._updateCurrent=function(a,d){var e=this._currentItem;e!==a&&(this._currentItem=a,e&&(e=this._itemMap[e._key])&&g.$(e.div).removeClass(c.css.currentItem),a&&(e=this._itemMap[a._key])&&(g.$(e.div).addClass(c.css.currentItem),d&&e.div.scrollIntoView(!1)),this.raisePropertyChanged("currentItem"))};e.prototype._onDSCurrentChanged=function(a,c){var e=this.dataSource.currentItem;e?this._updateCurrent(e,!0):this._updateCurrent(null,!1)};e.prototype._onDSCollectionChanged=
function(b,c){var e=this,f=c.items;switch(c.changeType){case 2:this._isDSFilling||this._refresh();break;case 1:this._isDSFilling||e._appendItems(f);break;case 0:f.forEach(function(a){e._removeItem(a)});break;case 3:if(f=e._itemMap[c.old_key])delete e._itemMap[c.old_key],e._itemMap[c.new_key]=f;break;default:throw Error(g.utils.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,c.changeType));}};e.prototype._onDSFill=function(a,c){c.isBegin?this._isDSFilling=!0:(this._isDSFilling=!1,c.resetUI?this._refresh():
this._appendItems(c.newItems))};e.prototype._onItemStatusChanged=function(a,c){var e=a._aspect.status,f=this._itemMap[a._key];f&&(3===e?g.$(f.div).hide():3===c&&3!==e&&g.$(f.div).show())};e.prototype._createTemplate=function(a){return new t.template.Template({app:this.app,templateID:this.templateID,dataContext:a,templEvents:this})};e.prototype._appendItems=function(a){if(!this._isDestroyCalled){var c=this;a.forEach(function(a){c._itemMap[a._key]||c._appendItem(a)})}};e.prototype._appendItem=function(a){if(a._key){var d=
this._createElement("div"),e=d.get(0);d.addClass(c.css.item);"horizontal"==this.orientation&&d.css("display","inline-block");d.attr(q.DATA_ATTR.DATA_EVENT_SCOPE,this.uniqueID);this._$el.append(d);e={div:e,template:null,item:a};d.data("data",e);this._itemMap[a._key]=e;e.template=this._createTemplate(a);e.div.appendChild(e.template.el)}};e.prototype._bindDS=function(){var a=this,c=this.dataSource;c&&(c.addOnCollChanged(a._onDSCollectionChanged,a._objId,a),c.addOnFill(a._onDSFill,a._objId,a),c.addOnCurrentChanged(a._onDSCurrentChanged,
a._objId,a),c.addOnStatusChanged(function(c,d){a._onItemStatusChanged(d.item,d.oldStatus)},a._objId),this._refresh())};e.prototype._unbindDS=function(){var a=this.dataSource;a&&a.removeNSHandlers(this._objId)};e.prototype._createElement=function(a){return g.$(g.document.createElement(a))};e.prototype._onItemClicked=function(a,c){this._updateCurrent(c,!1);this.dataSource.currentItem=c;this.raiseEvent("item_clicked",{item:c})};e.prototype._clearContent=function(){var a=this;a._$el.empty();g.utils.forEachProp(a._itemMap,
function(c){a._removeItemByKey(c)})};e.prototype._removeItemByKey=function(a){var c=this._itemMap[a];c&&(delete this._itemMap[a],c.template.destroy(),c.template=null,g.$(c.div).removeData("data"),g.$(c.div).remove())};e.prototype._removeItem=function(a){this._removeItemByKey(a._key)};e.prototype._refresh=function(){var a=this.dataSource,c=this;this._clearContent();a&&a.forEach(function(a){c._appendItem(a)})};e.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,g._getInternal().untrackSelectable(this),
this._unbindDS(),this._clearContent(),this._$el.removeClass(c.css.stackpanel),this._currentItem=this._$el=null,this._itemMap={},this._options={},h.prototype.destroy.call(this))};e.prototype.getISelectable=function(){return this._selectable};e.prototype.scrollIntoView=function(a){a&&(a=this._itemMap[a._key])&&a.div.scrollIntoView(!1)};e.prototype.getDivElementByItem=function(a){return(a=this._itemMap[a._key])?a.div:null};e.prototype.toString=function(){return"StackPanel"};Object.defineProperty(e.prototype,
"app",{get:function(){return this._options.app},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"el",{get:function(){return this._options.el},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"orientation",{get:function(){return this._options.orientation},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"templateID",{get:function(){return this._options.templateID},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._options.dataSource},set:function(a){a!==this.dataSource&&(this.dataSource&&this._unbindDS(),this._options.dataSource=a,this.dataSource&&this._bindDS(),this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"currentItem",{get:function(){return this._currentItem},enumerable:!0,configurable:!0});return e}(a.BaseObject);c.StackPanel=n;var l=function(a){function c(b,
d,e){this._panel=null;this._options=e;this._panelEvents=null;var g=k.extend(!1,{app:b,el:d,dataSource:null},this._options);this._createPanel(g);a.call(this,b,d,e)}__extends(c,a);c.prototype._createPanel=function(a){this._panel=new n(a);this._panel.addOnItemClicked(function(a,b){if(this._panelEvents)this._panelEvents.onItemClicked(b.item)},this.uniqueID,this);this._panel.addOnDestroyed(function(){this._panel=null;this.invokePropChanged("panel");this.raisePropertyChanged("panel")},this.uniqueID,this)};
c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._panel&&!this._panel.getIsDestroyCalled()&&this._panel.destroy(),this._panel=this._panelEvents=null,a.prototype.destroy.call(this))};c.prototype.toString=function(){return"StackPanelElView"};Object.defineProperty(c.prototype,"dataSource",{get:function(){return this.getIsDestroyCalled()||!this._panel?void 0:this._panel.dataSource},set:function(a){this._isDestroyCalled||this.dataSource===a||(this._panel.dataSource=a,this.raisePropertyChanged("dataSource"))},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"panelEvents",{get:function(){return this._panelEvents},set:function(a){a!==this._panelEvents&&(this._panelEvents=a,this.raisePropertyChanged("panelEvents"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0});return c}(t.baseElView.BaseElView);c.StackPanelElView=l;g.registerElView("stackpanel",l);c._isModuleLoaded=!0})(t.stackpanel||(t.stackpanel=
{}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(t){(function(c){function q(b,c){if(b)switch(b.name){case "AccessDeniedException":throw new f(a.ERRS.ERR_ACCESS_DENIED,c);case "ConcurrencyException":throw new t(a.ERRS.ERR_CONCURRENCY,c);case "ValidationException":throw new A(d.format(a.ERRS.ERR_VALIDATION,b.message),c);case "DomainServiceException":throw new m(d.format(a.ERRS.ERR_SVC_ERROR,b.message),c);default:throw new m(d.format(a.ERRS.ERR_UNEXPECTED_SVC_ERROR,b.message),c);}}function p(a,b){function c(a,b,d){if(b.nested&&
0<b.nested.length){var e,r,g=b.nested.length;for(r=0;r<g;r+=1)e=b.nested[r],e.nested&&0<e.nested.length?c(a+"."+e.fieldName,e,d):d(a+"."+e.fieldName,e)}else d(a,b)}c(a.fieldName,a,b)}var k=a.MOD.utils,g=a.MOD.collection,n=a.MOD.errors,l=/^<head:(\d{1,6})>/,h=n.ValidationError,e=k.valueUtils,b=a.baseUtils,d;a.global.addOnInitialize(function(a,b){d=a.utils});var m=function(a){function b(c,d){var e;c&&(e=c.message);e||(e=""+c);a.call(this,e);this.origError=c;this._operationName=d}__extends(b,a);Object.defineProperty(b.prototype,
"operationName",{get:function(){return this._operationName},enumerable:!0,configurable:!0});return b}(n.BaseError);c.DataOperationError=m;var f=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(m);c.AccessDeniedError=f;var t=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(m);c.ConcurrencyError=t;var A=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(m);c.SvcValidationError=A;var C=function(a){function c(d,e,w){var s=d.message||
""+d;this.origError=d;this._allSubmitted=e||[];this._notValidated=w||[];if(0<this._notValidated.length){var g=[s+":"];this._notValidated.forEach(function(a){g.push(b.format("item key:{0} errors:{1}",a._key,a._aspect.getErrorString()))});s=g.join("\r\n")}a.call(this,s,0)}__extends(c,a);Object.defineProperty(c.prototype,"allSubmitted",{get:function(){return this._allSubmitted},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"notValidated",{get:function(){return this._notValidated},
enumerable:!0,configurable:!0});return c}(m);c.SubmitError=C;var y=function(c){function e(a){c.call(this);this._query=a;this._cache=[];this._totalCount=0;this._itemsByKey={}}__extends(e,c);e.prototype.getCachedPage=function(c){var d=this._cache.filter(function(a){return a.pageIndex===c});if(0==d.length)return null;if(1!=d.length)throw Error(b.format(a.ERRS.ERR_ASSERTION_FAILED,"res.length == 1"));return d[0]};e.prototype.reindexCache=function(){var a=this,b;this._itemsByKey={};for(var c=0;c<this._cache.length;c+=
1)b=this._cache[c],b.items.forEach(function(b){a._itemsByKey[b._key]=b})};e.prototype.getPrevCachedPageIndex=function(a){for(var b=-1,c,d=0;d<this._cache.length;d+=1)c=this._cache[d].pageIndex,c>b&&c<a&&(b=c);return b};e.prototype.getNextRange=function(a){var b=Math.floor((this.loadPageCount-1)/2),c=a+b+(this.loadPageCount-1)%2,b=a-b;a=this.getPrevCachedPageIndex(a);0>b&&(c+=0-b,b=0);b<=a&&(c+=a-b+1,b+=a-b+1);this._pageCount>this.loadPageCount&&c>this._pageCount-1&&(b-=c-(this._pageCount-1),0>b&&
(b=0),c=this._pageCount-1);b<=a&&(c+=a-b+1,b+=a-b+1);a=c-b+1;a<this.loadPageCount&&(c+=this.loadPageCount-a,a=c-b+1);return{start:b,end:c,cnt:a}};e.prototype.fillCache=function(a,b){var c,d=this._itemsByKey,e,g,r=b.length,f,h=this.pageSize;for(e=0;e<this.loadPageCount;e+=1)for(g=a+e,f=this.getCachedPage(g),f||(f={items:[],pageIndex:g},this._cache.push(f)),g=0;g<h;g+=1)if(c=e*h+g,c<r)c=b[c],d[c._key]||(f.items.push(c),d[c._key]=c,c._aspect.isCached=!0);else return};e.prototype.clear=function(){var a,
b,c,d,e=this._query.dbSet;for(a=0;a<this._cache.length;a+=1)for(c=this._cache[a].items,b=0;b<c.length;b+=1)(d=c[b])&&d._aspect&&d._aspect.key&&(d._aspect.isCached=!1,e.getItemByKey(d._key)||d._aspect.destroy());this._cache=[];this._itemsByKey={}};e.prototype.clearCacheForPage=function(a){var b=this.getCachedPage(a);a=this._query.dbSet;if(b){var c,d,e=this._cache.indexOf(b);c=b.items;for(b=0;b<c.length;b+=1)(d=c[b])&&null!==d._key&&(delete this._itemsByKey[d._key],d._aspect.isCached=!1,a.getItemByKey(d._key)||
d._aspect.destroy());this._cache.splice(e,1)}};e.prototype.hasPage=function(a){for(var b=0;b<this._cache.length;b+=1)if(this._cache[b].pageIndex===a)return!0;return!1};e.prototype.getItemByKey=function(a){return this._itemsByKey[a]};e.prototype.getPageByItem=function(a){a=this._itemsByKey[a._key];if(!a)return-1;for(var b=0;b<this._cache.length;b+=1)if(-1<this._cache[b].items.indexOf(a))return this._cache[b].pageIndex;return-1};e.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=
!0,this.clear(),c.prototype.destroy.call(this))};e.prototype.toString=function(){return"DataCache"};Object.defineProperty(e.prototype,"_pageCount",{get:function(){var a=this.totalCount,b=this.pageSize;return 0===a||0===b?0:a=0===a%b?a/b:Math.floor(a/b)+1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"pageSize",{get:function(){return this._query.pageSize},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"loadPageCount",{get:function(){return this._query.loadPageCount},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"totalCount",{get:function(){return this._totalCount},set:function(a){d.check.isNt(a)&&(a=0);a!==this._totalCount&&(this._totalCount=a,this.raisePropertyChanged("totalCount"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cacheSize",{get:function(){return this._cache.length},enumerable:!0,configurable:!0});return e}(a.BaseObject);c.DataCache=y;var v=function(b){function c(a,d){b.call(this);var e=this;this._dbSet=
a;this.__queryInfo=d;this._filterInfo={filterItems:[]};this._sortInfo={sortItems:[]};this._isClearPrevData=this._isIncludeTotalCount=!0;this._pageSize=a.pageSize;this._pageIndex=a.pageIndex;this._params={};this._loadPageCount=1;this._isClearCacheOnEveryLoad=!0;this._dataCache=null;this._cacheInvalidated=!1;this._internal={clearCache:function(){e._clearCache()},getCache:function(){return e._getCache()},reindexCache:function(){e._reindexCache()},isPageCached:function(a){return e._isPageCached(a)},getQueryInfo:function(){return e.__queryInfo}}}
__extends(c,b);c.prototype._addSort=function(a,b){var c=0;d.check.isNt(b)||(c=b);this._sortInfo.sortItems.push({fieldName:a,sortOrder:c});this._cacheInvalidated=!0};c.prototype._addFilterItem=function(b,c,w){var g=0,f=this.getFieldInfo(b);if(!f)throw Error(d.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,this.dbSetName,b));var h=this.serverTimezone,r=f.dateConversion,m=[],m=d.check.isArray(w)?w:[w],m=a.ArrayHelper.clone(m).map(function(a){return e.stringifyValue(a,r,f.dataType,h)});switch(c){case 0:case 9:case 2:case 3:case 4:case 5:case 7:case 6:case 8:g=
c;break;case 1:g=c;if(2!=w.length)throw Error(a.ERRS.ERR_QUERY_BETWEEN);break;default:throw Error(d.format(a.ERRS.ERR_QUERY_OPERATOR_INVALID,c));}this._filterInfo.filterItems.push({fieldName:b,kind:g,values:m});this._cacheInvalidated=!0};c.prototype._resetCacheInvalidated=function(){this._cacheInvalidated=!1};c.prototype._clearCache=function(){this._dataCache&&(this._dataCache.destroy(),this._dataCache=null);this._resetCacheInvalidated()};c.prototype._getCache=function(){this._dataCache||(this._dataCache=
new y(this));return this._dataCache};c.prototype._reindexCache=function(){this._dataCache&&this._dataCache.reindexCache()};c.prototype._isPageCached=function(a){return this._dataCache?this._dataCache.hasPage(a):!1};c.prototype._getInternal=function(){return this._internal};c.prototype.where=function(a,b,c){this._addFilterItem(a,b,c);return this};c.prototype.and=function(a,b,c){this._addFilterItem(a,b,c);return this};c.prototype.orderBy=function(a,b){this._addSort(a,b);return this};c.prototype.thenBy=
function(a,b){this._addSort(a,b);return this};c.prototype.clearSort=function(){this._sortInfo.sortItems=[];this._cacheInvalidated=!0;return this};c.prototype.clearFilter=function(){this._filterInfo.filterItems=[];this._cacheInvalidated=!0;return this};c.prototype.clearParams=function(){this._params={};this._cacheInvalidated=!0;return this};c.prototype.getFieldInfo=function(a){return this._dbSet.getFieldInfo(a)};c.prototype.getFieldNames=function(){return this._dbSet.getFieldNames()};c.prototype.load=
function(){return this.dbSet.dbContext.load(this)};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._clearCache(),b.prototype.destroy.call(this))};c.prototype.toString=function(){return"DataQuery"};Object.defineProperty(c.prototype,"serverTimezone",{get:function(){return this._dbSet.dbContext.serverTimezone},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"entityType",{get:function(){return this._dbSet.entityType},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"dbSet",{get:function(){return this._dbSet},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"dbSetName",{get:function(){return this._dbSet.dbSetName},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"queryName",{get:function(){return this.__queryInfo.methodName},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"filterInfo",{get:function(){return this._filterInfo},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"sortInfo",{get:function(){return this._sortInfo},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isIncludeTotalCount",{get:function(){return this._isIncludeTotalCount},set:function(a){this._isIncludeTotalCount=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isClearPrevData",{get:function(){return this._isClearPrevData},set:function(a){this._isClearPrevData=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"pageSize",{get:function(){return this._pageSize},set:function(a){this._pageSize!=
a&&(this._pageSize=a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"pageIndex",{get:function(){return this._pageIndex},set:function(a){this._pageIndex!=a&&(this._pageIndex=a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"params",{get:function(){return this._params},set:function(a){this._params!==a&&(this._params=a,this._cacheInvalidated=!0)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isPagingEnabled",{get:function(){return 0<=this._pageIndex&&
this._dbSet.isPagingEnabled},set:function(b){this.isPagingEnabled!=b&&(this._dbSet.isPagingEnabled?this._pageIndex=b?this._dbSet.pageIndex:-1:b&&(b=Error("Paging is disabled on the server side and can not be enabled here."),this._dbSet.handleError(b,this),a.throwDummy(b)))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"loadPageCount",{get:function(){return this._loadPageCount},set:function(a){1>a&&(a=1);this._loadPageCount!=a&&(this._loadPageCount=a,1===a&&this._clearCache(),
this.raisePropertyChanged("loadPageCount"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isClearCacheOnEveryLoad",{get:function(){return this._isClearCacheOnEveryLoad},set:function(a){this._isClearCacheOnEveryLoad!=a&&(this._isClearCacheOnEveryLoad=a,this.raisePropertyChanged("isClearCacheOnEveryLoad"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isCacheValid",{get:function(){return!!this._dataCache&&!this._cacheInvalidated},enumerable:!0,configurable:!0});
return c}(a.BaseObject);c.DataQuery=v;n=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(v);c.TDataQuery=n;var B=function(f){function r(a,c,d,e){f.call(this,a);var h=this;this.__srvKey=null;this._isCached=this._isRefreshing=!1;this._savedStatus=this._origVals=null;a=this.dbSet.getFieldInfos();for(var r,m=0,k=a.length;m<k;m+=1)r=a[m],5!=r.fieldType?h._vals[r.fieldName]=null:g.fn_traverseField(r,function(a,c){5==c.fieldType?b.setValue(h._vals,a,{},!1):b.setValue(h._vals,a,null,
!1)});this._initRowInfo(d,e);this._item=new c(this)}__extends(r,f);r.prototype._fakeDestroy=function(){!this._isDestroyCalled&&this._item&&(this.raiseEvent("destroyed",{}),this._item.raiseEvent("destroyed",{}),this.removeNSHandlers(null),this._item.removeNSHandlers(null))};r.prototype._initRowInfo=function(a,b){a&&(this.key=this.__srvKey=a.k,this._processValues("",a.v,b))};r.prototype._processValues=function(c,d,g){var s=this,f=s.serverTimezone;d.forEach(function(d,x){var h=g[x],r=c+h.n,m=s.dbSet.getFieldInfo(r);
if(!m)throw Error(b.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,s.dbSetName,r));5==m.fieldType?s._processValues(r+".",d,h.p):(h=e.parseValue(d,m.dataType,m.dateConversion,f),b.setValue(s._vals,r,h,!1))})};r.prototype._onFieldChanged=function(a,b){var c=this;this._isDestroyCalled||(c.getItem().raisePropertyChanged(a),b.dependents&&0<b.dependents.length&&b.dependents.forEach(function(a){c.getItem().raisePropertyChanged(a)}))};r.prototype._getValueChange=function(a,c,d){var e=this.dbSet,g,f,h;if(1==c.fieldType||
3==c.fieldType||2==c.fieldType||6==c.fieldType)return null;if(5==c.fieldType)for(g={fieldName:c.fieldName,val:null,orig:null,flags:0,nested:[]},f=c.nested.length,e=0;e<f;e+=1)(h=this._getValueChange(a+"."+c.nested[e].fieldName,c.nested[e],d))&&g.nested.push(h);else g=e._getInternal().getStrValue(b.getValue(this._vals,a),c),a=null===this._origVals?g:e._getInternal().getStrValue(b.getValue(this._origVals,a),c),g=a!==g?{fieldName:c.fieldName,val:g,orig:a,flags:3,nested:null}:0<c.isPrimaryKey||4==c.fieldType||
c.isNeedOriginal?{fieldName:c.fieldName,val:g,orig:a,flags:2,nested:null}:{fieldName:c.fieldName,val:null,orig:null,flags:0,nested:null};return d?5==c.fieldType?0<g.nested.length?g:null:1===(g.flags&1)?g:null:g};r.prototype._getValueChanges=function(a){var b=this;return this.dbSet.getFieldInfos().map(function(c){return b._getValueChange(c.fieldName,c,a)}).filter(function(a){return!!a})};r.prototype._fldChanging=function(a,b,c,e){this._origVals||(this._origVals=d.cloneObj(this._vals));return!0};r.prototype._skipValidate=
function(a,b){var c=this.dbSet._getInternal().getChildToParentNames(a.fieldName),d=!1;if(c&&null===b)for(var e=0,g=c.length;e<g&&!(d=!!this._getFieldVal(c[e]));e+=1);return d};r.prototype._beginEdit=function(){if(!f.prototype._beginEdit.call(this))return!1;this._savedStatus=this.status;return!0};r.prototype._endEdit=function(){if(!f.prototype._endEdit.call(this))return!1;this._savedStatus=null;return!0};r.prototype._cancelEdit=function(){if(!this._isEditing)return!1;var c=this,d=this._getValueChanges(!0),
e=this.isNew,g=this.dbSet;this._vals=this._saveVals;this._saveVals=null;this.setStatus(this._savedStatus);this._savedStatus=null;g._getInternal().removeAllErrors(this.getItem());d.forEach(function(d){var e=c.dbSet.getFieldInfo(d.fieldName);if(!e)throw Error(b.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,c.dbSetName,d.fieldName));c._onFieldChanged(d.fieldName,e)});this._isEditing=!1;e&&this._notEdited&&g.removeItem(this.getItem());return!0};r.prototype.getDbSet=function(){return this.dbSet};r.prototype.setStatus=
function(a){if(this._status!==a){var b=this._status;this._status=a;0!==a?this.dbSet._getInternal().addToChanged(this.getItem()):this.dbSet._getInternal().removeFromChanged(this.key);this.dbSet._getInternal().onItemStatusChanged(this.getItem(),b)}};r.prototype._updateKeys=function(a){this.key=this.__srvKey=a};r.prototype._checkCanRefresh=function(){if(null===this.key||1===this.status)throw Error(a.ERRS.ERR_OPER_REFRESH_INVALID);};r.prototype._refreshValue=function(c,d,g){var s=this.dbSet.getFieldInfo(d);
if(!s)throw Error(b.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,this.dbSetName,d));var f,h,r=s.dataType;c=e.parseValue(c,r,s.dateConversion,this.serverTimezone);f=b.getValue(this._vals,d);switch(g){case 3:e.compareVals(c,f,r)||(b.setValue(this._vals,d,c,!1),this._onFieldChanged(d,s));break;case 1:this._origVals&&b.setValue(this._origVals,d,c,!1);this._saveVals&&b.setValue(this._saveVals,d,c,!1);e.compareVals(c,f,r)||(b.setValue(this._vals,d,c,!1),this._onFieldChanged(d,s));break;case 2:this._origVals&&
(h=b.getValue(this._origVals,d),b.setValue(this._origVals,d,c,!1));void 0!==h&&!e.compareVals(h,f,r)||e.compareVals(c,f,r)||(b.setValue(this._vals,d,c,!1),this._onFieldChanged(d,s));break;default:throw Error(b.format(a.ERRS.ERR_PARAM_INVALID,"refreshMode",g));}};r.prototype._refreshValues=function(a,b){var c=this,d=this.status;this._isDestroyed||(b||(b=1),a.values.forEach(function(a){p(a,function(a,d){4===(d.flags&4)&&c._refreshValue(d.val,a,b)})}),2===d&&0===this._getValueChanges(!0).length&&(this._origVals=
null,this.setStatus(0)))};r.prototype._getRowInfo=function(){return{values:this._getValueChanges(!1),changeType:this.status,serverKey:this._srvKey,clientKey:this.key,error:null}};r.prototype._getCalcFieldVal=function(a){return this._isDestroyCalled?null:this.dbSet._getInternal().getCalcFieldVal(a,this.getItem())};r.prototype._getNavFieldVal=function(a){return this._isDestroyCalled?null:this.dbSet._getInternal().getNavFieldVal(a,this.getItem())};r.prototype._setNavFieldVal=function(a,b){this.dbSet._getInternal().setNavFieldVal(a,
this.getItem(),b)};r.prototype._clearFieldVal=function(a){b.setValue(this._vals,a,null,!1)};r.prototype._getFieldVal=function(a){return this._isDestroyCalled?null:b.getValue(this._vals,a)};r.prototype._setFieldVal=function(c,d){var e,g=this.dbSetName,f=this.dbSet,r=a.ERRS,m=this._getFieldVal(c),k=d,l=this.getFieldInfo(c),n=!1;if(!l)throw Error(b.format(r.ERR_DBSET_INVALID_FIELDNAME,g,c));this._isEditing||this.isUpdating||this.beginEdit();try{k=this._checkVal(l,k);if(m!=k&&this._fldChanging(c,l,m,
k)){b.setValue(this._vals,c,k,!1);if(1!=l.fieldType&&6!=l.fieldType)switch(this.status){case 0:this.setStatus(2)}this._onFieldChanged(c,l);n=!0}f._getInternal().removeError(this.getItem(),c);if(e=this._validateField(c))throw new h([e],this);}catch(p){throw e=p instanceof h?p:new h([{fieldName:c,errors:[p.message]}],this),f._getInternal().addError(this.getItem(),c,e.errors[0].errors),e;}return n};r.prototype._acceptChanges=function(a){var b=this.status,c=this.dbSet,e=c._getInternal();null!==this.key&&
0!==b&&(e.onCommitChanges(this.getItem(),!0,!1,b),3===b?c.removeItem(this.getItem()):(this._origVals=null,this._saveVals&&(this._saveVals=d.cloneObj(this._vals)),this.setStatus(0),e.removeAllErrors(this.getItem()),a&&this._refreshValues(a,3),e.onCommitChanges(this.getItem(),!1,!1,b)))};r.prototype._onAttaching=function(){f.prototype._onAttaching.call(this);this._status=1};r.prototype._onAttach=function(){f.prototype._onAttach.call(this);if(null===this.key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);
this.dbSet._getInternal().addToChanged(this.getItem())};r.prototype.deleteItem=function(){return this.deleteOnSubmit()};r.prototype.deleteOnSubmit=function(){var a=this.status,b=this.dbSet,c={item:this.getItem(),isCancel:!1};b._getInternal().onItemDeleting(c);if(c.isCancel||null===this.key)return!1;if(1===a)return b.removeItem(this.getItem()),!0;this.setStatus(3);return!0};r.prototype.acceptChanges=function(){this._acceptChanges(null)};r.prototype.rejectChanges=function(){var a=this,b=a.status,c=
a.dbSet,e=c._getInternal();if(a.key&&0!==b)if(e.onCommitChanges(a.getItem(),!0,!0,b),1===b)c.removeItem(this.getItem());else{var g=a._getValueChanges(!0);a._origVals&&(a._vals=d.cloneObj(a._origVals),a._origVals=null,a._saveVals&&(a._saveVals=d.cloneObj(a._vals)));a.setStatus(0);e.removeAllErrors(this.getItem());g.forEach(function(b){p(b,function(b,d){a._onFieldChanged(b,c.getFieldInfo(b))})});e.onCommitChanges(this.getItem(),!1,!0,b)}};r.prototype.submitChanges=function(){var a=this.dbSet.dbContext,
b=d.uuid();a.addOnSubmitError(function(a,b){b.error instanceof c.SubmitError&&0<b.error.notValidated.length&&(b.isHandled=!0)},b);var e=a.submitChanges();e.always(function(){a.removeOnSubmitError(b)});return e};r.prototype.refresh=function(){return this.dbSet.dbContext._getInternal().refreshItem(this.getItem())};r.prototype.getItem=function(){return this._item};r.prototype.toString=function(){return"EntityAspect"};r.prototype.destroy=function(){this._isDestroyed||(this.isCached?this._fakeDestroy():
(this._isDestroyCalled=!0,this._savedStatus=this._origVals=this.__srvKey=null,this._isCached=this._isRefreshing=!1,f.prototype.destroy.call(this),this._item=null))};Object.defineProperty(r.prototype,"_entityType",{get:function(){return this.dbSet.entityType},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"_srvKey",{get:function(){return this.__srvKey},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"isCanSubmit",{get:function(){return!0},enumerable:!0,configurable:!0});
Object.defineProperty(r.prototype,"isNew",{get:function(){return 1===this._status},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"isDeleted",{get:function(){return 3===this._status},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"dbSetName",{get:function(){return this.dbSet.dbSetName},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"serverTimezone",{get:function(){return this.dbSet.dbContext.serverTimezone},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,
"dbSet",{get:function(){return this.collection},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"isRefreshing",{get:function(){return this._isRefreshing},set:function(a){this._isRefreshing!==a&&(this._isRefreshing=a,this.raisePropertyChanged("isRefreshing"))},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"isCached",{get:function(){return this._isCached},set:function(a){this._isCached=a},enumerable:!0,configurable:!0});return r}(g.ItemAspect);c.EntityAspect=B;
n=function(c){function f(a,e){c.call(this);var w=this,s=a.dbSetInfo,h=s.fieldInfos;this._dbContext=a.dbContext;this._options.dbSetName=s.dbSetName;this._options.enablePaging=s.enablePaging;this._options.pageSize=s.pageSize;this._query=null;this._entityType=e;this._isSubmitOnDelete=!1;this._navfldMap={};this._calcfldMap={};this._fieldInfos=h;this._trackAssoc={};this._trackAssocMap={};this._childAssocMap={};this._parentAssocMap={};this._changeCount=0;this._changeCache={};this._ignorePageChanged=!1;
h.forEach(function(a){w._fieldMap[a.fieldName]=a;g.fn_traverseField(a,function(a,b){b.dependents=[];b.fullName=a})});h.forEach(function(c){g.fn_traverseField(c,function(c,d){3==d.fieldType?w._navfldMap[d.fieldName]=w._doNavigationField(a,d):2==d.fieldType&&b.setValue(w._calcfldMap,c,w._doCalculatedField(a,d),!0)})});w._mapAssocFields();Object.freeze(this._perms);d.mergeObj({getCalcFieldVal:function(a,b){return w._getCalcFieldVal(a,b)},getNavFieldVal:function(a,b){return w._getNavFieldVal(a,b)},setNavFieldVal:function(a,
b,c){w._setNavFieldVal(a,b,c)},beforeLoad:function(a,b){w._beforeLoad(a,b)},updatePermissions:function(a){w._updatePermissions(a)},getChildToParentNames:function(a){return w._getChildToParentNames(a)},fillFromService:function(a){return w._fillFromService(a)},fillFromCache:function(a){return w._fillFromCache(a)},commitChanges:function(a){w._commitChanges(a)},setItemInvalid:function(a){return w._setItemInvalid(a)},getChanges:function(){return w._getChanges()},getTrackAssocInfo:function(){return w._getTrackAssocInfo()},
addToChanged:function(a){w._addToChanged(a)},removeFromChanged:function(a){w._removeFromChanged(a)},onItemStatusChanged:function(a,b){w._onItemStatusChanged(a,b)}},this._internal)}__extends(f,c);f.prototype.handleError=function(a,b){return this.dbContext.handleError(a,b)};f.prototype._getEventNames=function(){var a=c.prototype._getEventNames.call(this);return["loaded"].concat(a)};f.prototype._mapAssocFields=function(){for(var a=this._trackAssoc,b,c=Object.keys(a),e,g=this._trackAssocMap,f=0,h=c.length;f<
h;f+=1){b=a[c[f]];for(var r=0,m=b.fieldRels.length;r<m;r+=1)e=b.fieldRels[r],d.check.isArray(g[e.childField])?g[e.childField].push(b.childToParentName):g[e.childField]=[b.childToParentName]}};f.prototype._doNavigationField=function(c,d){var e=this,g=!0,f={getFunc:function(a){throw Error("Function is not implemented");},setFunc:function(a){throw Error("Function is not implemented");}},h=c.childAssoc.filter(function(a){return a.childToParentName==d.fieldName});0===h.length&&(h=c.parentAssoc.filter(function(a){return a.parentToChildrenName==
d.fieldName}),g=!1);if(1!=h.length)throw Error(b.format(a.ERRS.ERR_PARAM_INVALID_TYPE,"assocs","Array"));var r=h[0].name;d.isReadOnly=!0;g?(d.isReadOnly=!1,e._childAssocMap[h[0].childToParentName]=h[0],h[0].fieldRels.forEach(function(a){a=e.getFieldInfo(a.childField);!d.isReadOnly&&a.isReadOnly&&(d.isReadOnly=!0)}),f.getFunc=function(a){return e.dbContext.getAssociation(r).getParentItem(a)},d.isReadOnly||(e._trackAssoc[r]=h[0],f.setFunc=function(c){var u,g,f=e.dbContext.getAssociation(r);if(c&&!(c instanceof
f.parentDS.entityType))throw Error(b.format(a.ERRS.ERR_PARAM_INVALID_TYPE,"value",f.parentDS.dbSetName));if(c&&c._aspect&&c._aspect.isNew)this._aspect._setFieldVal(d.fieldName,c._key);else if(c)for(u=0,g=f.childFldInfos.length;u<g;u+=1)this[f.childFldInfos[u].fieldName]=c[f.parentFldInfos[u].fieldName];else for(this._aspect._getFieldVal(d.fieldName)&&this._aspect._setFieldVal(d.fieldName,null),u=0,g=f.childFldInfos.length;u<g;u+=1)this[f.childFldInfos[u].fieldName]=null})):(e._parentAssocMap[h[0].parentToChildrenName]=
h[0],f.getFunc=function(a){return e.dbContext.getAssociation(r).getChildItems(a)});return f};f.prototype._doCalculatedField=function(b,c){function e(b){b.dependentOn&&b.dependentOn.split(",").forEach(function(c){var e=f.getFieldInfo(c);if(!e)throw Error(d.format(a.ERRS.ERR_CALC_FIELD_DEFINE,c));if(b===e)throw Error(d.format(a.ERRS.ERR_CALC_FIELD_SELF_DEPEND,c));0>e.dependents.indexOf(b.fullName)&&e.dependents.push(b.fullName)})}var f=this;c.isReadOnly=!0;c.dependentOn&&e(c);return{getFunc:function(a){throw Error(d.format("Calculated field:'{0}' is not initialized",
c.fieldName));}}};f.prototype._refreshValues=function(c,d,e,f,g){var h=this;e.forEach(function(e,w){var r=f[w],m=c+r.n,k=h.getFieldInfo(m);if(!k)throw Error(b.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,h.dbSetName,m));5==k.fieldType?h._refreshValues(m+".",d,e,r.p,g):d._aspect._refreshValue(e,m,g)})};f.prototype._setCurrentItem=function(d){if(d&&!(d instanceof this._entityType))throw Error(b.format(a.ERRS.ERR_PARAM_INVALID_TYPE,"currentItem",this._options.dbSetName));c.prototype._setCurrentItem.call(this,
d)};f.prototype._getNewKey=function(a){a="clkey_"+this._newKey;this._newKey+=1;return a};f.prototype._createNew=function(){var a=new B(this,this._entityType,null,null),b=a.getItem();a.key=this._getNewKey(b);return b};f.prototype._clearChangeCache=function(){var a=this._changeCount;this._changeCache={};this._changeCount=0;a!==this._changeCount&&this.raisePropertyChanged("isHasChanges")};f.prototype._onPageChanging=function(){var a=c.prototype._onPageChanging.call(this);if(!a)return a;this.isHasChanges&&
this.rejectChanges();return a};f.prototype._onPageChanged=function(){this.cancelEdit();c.prototype._onPageChanged.call(this);this._ignorePageChanged||(this.query.pageIndex=this.pageIndex,this.dbContext._getInternal().load(this.query,!0))};f.prototype._onPageSizeChanged=function(){c.prototype._onPageSizeChanged.call(this);this._query&&(this._query.pageSize=this.pageSize)};f.prototype._defineCalculatedField=function(c,d){var e=b.getValue(this._calcfldMap,c);if(!e)throw Error(b.format(a.ERRS.ERR_PARAM_INVALID,
"calculated fieldName",c));e.getFunc=d};f.prototype._onLoaded=function(a){this.raiseEvent("loaded",{items:a})};f.prototype._getStrValue=function(a,b){return e.stringifyValue(a,b.dateConversion,b.dataType,this.dbContext.serverTimezone)};f.prototype._getCalcFieldVal=function(a,c){return b.getValue(this._calcfldMap,a).getFunc.call(c,c)};f.prototype._getNavFieldVal=function(a,c){return b.getValue(this._navfldMap,a).getFunc.call(c,c)};f.prototype._setNavFieldVal=function(a,c,d){b.getValue(this._navfldMap,
a).setFunc.call(c,d)};f.prototype._beforeLoad=function(a,b){a&&b!==a&&(this._query=a,this.pageIndex=0);b&&b!==a&&b.destroy();if(a.pageSize!==this.pageSize){this._ignorePageChanged=!0;try{this.pageIndex=0,this.pageSize=a.pageSize}finally{this._ignorePageChanged=!1}}if(a.pageIndex!==this.pageIndex){this._ignorePageChanged=!0;try{this.pageIndex=a.pageIndex}finally{this._ignorePageChanged=!1}}a.isCacheValid||a._getInternal().clearCache()};f.prototype._updatePermissions=function(a){this._perms=a};f.prototype._getChildToParentNames=
function(a){return this._trackAssocMap[a]};f.prototype._fillFromService=function(b){b=d.extend(!1,{res:{names:[],rows:[],pageIndex:null,pageCount:null,dbSetName:this.dbSetName,totalCount:null},isPageChanged:!1,fn_beforeFillEnd:null},b);var c=this,e=b.res,f=e.names,g=e.rows||[],h=[],r=[],m=[],k=[],l=[],n=this.isPagingEnabled,p=this.query,q=!0,t;this._onFillStart({isBegin:!0,rowCount:g.length,time:new Date,isPageChanged:b.isPageChanged});try{p&&(q=p.isClearPrevData,p.isClearCacheOnEveryLoad&&p._getInternal().clearCache(),
q&&this.clear(),p._getInternal().reindexCache(),1<p.loadPageCount&&n&&(t=p._getInternal().getCache(),p.isIncludeTotalCount&&!d.check.isNt(e.totalCount)&&(t.totalCount=e.totalCount)));k=l=g.map(function(b){var d=b.k;if(!d)throw Error(a.ERRS.ERR_KEY_IS_EMPTY);var e=c._itemsByKey[d];e?c._refreshValues("",e,b.v,f,1):(t&&(e=t.getItemByKey(d)),e?c._refreshValues("",e,b.v,f,1):(b=new B(c,c._entityType,b,f),e=b.getItem()));return e});if(p&&(p.isIncludeTotalCount&&!d.check.isNt(e.totalCount)&&(this.totalCount=
e.totalCount),1<p.loadPageCount&&n)){t.fillCache(e.pageIndex,l);var v=t.getCachedPage(p.pageIndex),k=v?v.items:[]}k.forEach(function(a){var b=c._itemsByKey[a._key];b?m.push(b):(c._items.push(a),r.push(c._items.length-1),c._itemsByKey[a._key]=a,h.push(a),m.push(a))});0<h.length&&(this._onCollectionChanged({changeType:1,items:h,pos:r}),this._onCountChanged());b.fn_beforeFillEnd&&b.fn_beforeFillEnd();this._onLoaded(l)}finally{this._onFillEnd({isBegin:!1,rowCount:m.length,time:new Date,resetUI:q,fetchedItems:m,
newItems:h,isPageChanged:b.isPageChanged})}q&&this.moveFirst();return{fetchedItems:m,newItems:h,isPageChanged:b.isPageChanged,outOfBandData:b.res.extraInfo}};f.prototype._fillFromCache=function(b){b=d.extend(!1,{isPageChanged:!1,fn_beforeFillEnd:null},b);var c=this,e=[],f=[],g=this.query;if(!g)throw Error(d.format(a.ERRS.ERR_ASSERTION_FAILED,"query is not null"));g=(g=g._getInternal().getCache().getCachedPage(g.pageIndex))?g.items:[];this._onFillStart({isBegin:!0,rowCount:g.length,time:new Date,isPageChanged:b.isPageChanged});
try{this.clear(),this._items=g,g.forEach(function(a,b){c._itemsByKey[a._key]=a;e.push(b);f.push(a)}),b.fn_beforeFillEnd&&b.fn_beforeFillEnd(),0<f.length&&(this._onCollectionChanged({changeType:1,items:f,pos:e}),this._onCountChanged())}finally{this._onFillEnd({isBegin:!1,rowCount:f.length,time:new Date,resetUI:!0,fetchedItems:f,newItems:f,isPageChanged:b.isPageChanged})}this.moveFirst();return{fetchedItems:f,newItems:f,isPageChanged:b.isPageChanged,outOfBandData:null}};f.prototype._commitChanges=function(c){var d=
this;c.forEach(function(c){var e=c.clientKey,u=d._itemsByKey[e];if(!u)throw Error(b.format(a.ERRS.ERR_KEY_IS_NOTFOUND,e));var f=u._aspect.status;u._aspect._acceptChanges(c);1===f&&(delete d._itemsByKey[e],u._aspect._updateKeys(c.serverKey),d._itemsByKey[u._key]=u,d._onCollectionChanged({changeType:3,items:[u],old_key:e,new_key:u._key}))})};f.prototype._setItemInvalid=function(a){var b=this._itemsByKey[a.clientKey],c={};a.invalid.forEach(function(a){a.fieldName||(a.fieldName="*");c[a.fieldName]?c[a.fieldName].push(a.message):
c[a.fieldName]=[a.message]});var e=[];d.forEachProp(c,function(a){e.push({fieldName:a,errors:c[a]})});this._addErrors(b,e);return b};f.prototype._getChanges=function(){var a=[],b=this._changeCache;d.forEachProp(b,function(c){a.push(b[c]._aspect._getRowInfo())});return a};f.prototype._getTrackAssocInfo=function(){var a=this,b=[],c=this._changeCache,e=Object.keys(a._trackAssoc);d.forEachProp(c,function(d){var f=c[d];e.forEach(function(c){var d=f._aspect._getFieldVal(a._trackAssoc[c].childToParentName),
e=f._key;d&&e&&b.push({assocName:c,parentKey:d,childKey:e})})});return b};f.prototype._addToChanged=function(a){null===a._key||this._changeCache[a._key]||(this._changeCache[a._key]=a,this._changeCount+=1,1===this._changeCount&&this.raisePropertyChanged("isHasChanges"))};f.prototype._removeFromChanged=function(a){null!==a&&this._changeCache[a]&&(delete this._changeCache[a],--this._changeCount,0===this._changeCount&&this.raisePropertyChanged("isHasChanges"))};f.prototype._onItemStatusChanged=function(a,
b){c.prototype._onItemStatusChanged.call(this,a,b);a._aspect.isDeleted&&this.isSubmitOnDelete&&this.dbContext.submitChanges()};f.prototype._onRemoved=function(a,b){this._removeFromChanged(a._key);c.prototype._onRemoved.call(this,a,b)};f.prototype._getInternal=function(){return this._internal};f.prototype.addOnLoaded=function(a,b,c){this._addHandler("loaded",a,b,c,!1)};f.prototype.removeOnLoaded=function(a){this._removeHandler("loaded",a)};f.prototype.getFieldInfo=function(c){var d,e=c.split(".");
d=this._fieldMap[e[0]];if(1==e.length)return d;if(5==d.fieldType){for(c=1;c<e.length;c+=1)d=g.fn_getPropertyByName(e[c],d.nested);return d}if(3==d.fieldType&&(d=this._childAssocMap[d.fieldName]))return c=this.dbContext.getDbSet(d.parentDbSetName),c.getFieldInfo(e.slice(1).join("."));throw Error(b.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,this.dbSetName,c));};f.prototype.sort=function(a,b){var d=this.query;if(d){d.clearSort();for(var e=0;e<a.length;e+=1)0==e?d.orderBy(a[e],b):d.thenBy(a[e],b);d.isClearPrevData=
!0;d.pageIndex=0;return this.dbContext.load(d)}return c.prototype.sort.call(this,a,b)};f.prototype.fillItems=function(a){a={res:d.extend(!1,{names:[],rows:[],pageIndex:this.query?this.query.pageIndex:null,pageCount:null,dbSetName:this.dbSetName,totalCount:null,rowCount:a.rows.length,extraInfo:null,error:null,included:[]},a),isPageChanged:!1,fn_beforeFillEnd:null};this._fillFromService(a)};f.prototype.acceptChanges=function(){var a=this._changeCache;d.forEachProp(a,function(b){a[b]._aspect.acceptChanges()});
this._changeCount=0};f.prototype.rejectChanges=function(){var a=this._changeCache;d.forEachProp(a,function(b){a[b]._aspect.rejectChanges()})};f.prototype.deleteOnSubmit=function(a){a._aspect.deleteOnSubmit()};f.prototype.clear=function(){this._clearChangeCache();c.prototype.clear.call(this)};f.prototype.createQuery=function(c){var d=this.dbContext._getInternal().getQueryInfo(c);if(!d)throw Error(b.format(a.ERRS.ERR_QUERY_NAME_NOTFOUND,c));return new v(this,d)};f.prototype.clearCache=function(){var a=
this._query;a&&a._getInternal().clearCache()};f.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this._query;this._query=null;a&&a.destroy();this._navfldMap={};this._calcfldMap={};c.prototype.destroy.call(this)}};f.prototype.toString=function(){return this._options.dbSetName};Object.defineProperty(f.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"dbContext",{get:function(){return this._dbContext},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"dbSetName",{get:function(){return this._options.dbSetName},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"entityType",{get:function(){return this._entityType},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isHasChanges",{get:function(){return 0<this._changeCount},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"cacheSize",{get:function(){var a=this._query;return a&&a.isCacheValid?(a=a._getInternal().getCache(),a.cacheSize):0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isSubmitOnDelete",{get:function(){return this._isSubmitOnDelete},set:function(a){this._isSubmitOnDelete!==a&&(this._isSubmitOnDelete=!!a,this.raisePropertyChanged("isSubmitOnDelete"))},enumerable:!0,configurable:!0});return f}(g.BaseCollection);c.DbSet=n;n=function(a){function b(){a.apply(this,
arguments)}__extends(b,a);return b}(n);c.TDbSet=n;n=function(c){function d(a){c.call(this);this._dbContext=a;this._arrDbSets=[];this._dbSets={};this._dbSetNames=[]}__extends(d,c);d.prototype._dbSetCreated=function(a){var b=this;this._arrDbSets.push(a);a.addOnPropertyChange("isHasChanges",function(a,c){b._dbContext._getInternal().onDbSetHasChangesChanged(a)},null)};d.prototype._createDbSet=function(a,b){var c=this,d=this._dbContext;c._dbSets[a]=function(){var e=new b(d);c._dbSets[a]=function(){return e};
c._dbSetCreated(e);return e}};Object.defineProperty(d.prototype,"dbSetNames",{get:function(){return this._dbSetNames},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"arrDbSets",{get:function(){return this._arrDbSets},enumerable:!0,configurable:!0});d.prototype.getDbSet=function(c){var d=this._dbSets[c];if(!d)throw Error(b.format(a.ERRS.ERR_DBSET_NAME_INVALID,c));return d()};d.prototype.destroy=function(){this._arrDbSets.forEach(function(a){a.destroy()});this._arrDbSets=[];this._dbContext=
this._dbSets=null;c.prototype.destroy.call(this)};return d}(a.BaseObject);c.DbSets=n;n=function(c){function f(){c.call(this);var a=this;this._isInitialized=!1;this._dbSets=null;this._svcMethods={};this._assoc={};this._arrAssoc=[];this._queryInf={};this._serviceUrl=null;this._isBusy=0;this._isHasChanges=this._isSubmiting=!1;this._pendingSubmit=null;this._serverTimezone=d.get_timeZoneOffset();this._waitQueue=new k.WaitQueue(this);this._internal={onItemRefreshed:function(b,c){a._onItemRefreshed(b,c)},
refreshItem:function(b){return a._refreshItem(b)},getQueryInfo:function(b){return a._getQueryInfo(b)},onDbSetHasChangesChanged:function(b){a._onDbSetHasChangesChanged(b)},load:function(b,c){return a._load(b,c)}}}__extends(f,c);f.prototype._getEventNames=function(){var a=c.prototype._getEventNames.call(this);return["submit_error"].concat(a)};f.prototype._initDbSets=function(){if(this._isInitialized)throw Error(a.ERRS.ERR_DOMAIN_CONTEXT_INITIALIZED);};f.prototype._initAssociations=function(a){var b=
this;a.forEach(function(a){b._initAssociation(a)})};f.prototype._initMethods=function(a){var b=this;a.forEach(function(a){a.isQuery?b._queryInf[a.methodName]=a:b._initMethod(a)})};f.prototype._updatePermissions=function(a){var b=this;this._serverTimezone=a.serverTimezone;a.permissions.forEach(function(a){b.getDbSet(a.dbSetName)._getInternal().updatePermissions(a)})};f.prototype._initAssociation=function(a){var b=this,c={dbContext:b,parentName:a.parentDbSetName,childName:a.childDbSetName,onDeleteAction:a.onDeleteAction,
parentKeyFields:a.fieldRels.map(function(a){return a.parentField}),childKeyFields:a.fieldRels.map(function(a){return a.childField}),parentToChildrenName:a.parentToChildrenName,childToParentName:a.childToParentName,name:a.name},d="get"+a.name;this._assoc[d]=function(){var a=new D(c);b._arrAssoc.push(a);b._assoc[d]=function(){return a};return a}};f.prototype._initMethod=function(b){var c=this;this._svcMethods[b.methodName]=function(e){var f=d.createDeferred(),g=function(a){a.error?f.reject():f.resolve(a.result)};
try{var h=c._getMethodParams(b,e);c._invokeMethod(b,h,g)}catch(m){a.checkIsDummy(m)||(c.handleError(m,c),g({result:null,error:m}))}return f.promise()}};f.prototype._getMethodParams=function(b,c){var f={methodName:b.methodName,paramInfo:{parameters:[]}},g,h=b.parameters,m=h.length,r,k;c||(c={});for(g=0;g<m;g+=1){r=h[g];k=c[r.name];if(!r.isNullable&&!r.isArray&&1!=r.dataType&&10!=r.dataType&&d.check.isNt(k))throw Error(d.format(a.ERRS.ERR_SVC_METH_PARAM_INVALID,r.name,k,b.methodName));if(d.check.isFunction(k))throw Error(d.format(a.ERRS.ERR_SVC_METH_PARAM_INVALID,
r.name,k,b.methodName));!r.isArray||d.check.isNt(k)||d.check.isArray(k)||(k=[k]);if(10==r.dataType&&d.check.isArray(k))k=JSON.stringify(k);else if(d.check.isArray(k)){for(var l=Array(k.length),n=0;n<k.length;n+=1)l[n]=e.stringifyValue(k[n],r.dateConversion,r.dataType,this.serverTimezone);k=JSON.stringify(l)}else k=e.stringifyValue(k,r.dateConversion,r.dataType,this.serverTimezone);f.paramInfo.parameters.push({name:r.name,value:k})}return f};f.prototype._invokeMethod=function(b,c,e){var f=this,g,h,
m=function(b){try{if(!b)throw Error(d.format(a.ERRS.ERR_UNEXPECTED_SVC_ERROR,"operation result is undefined"));q(b.error,2);e({result:b.result,error:null})}catch(c){a.checkIsDummy(c)||(f._onDataOperError(c,2),e({result:null,error:c}))}};this.isBusy=!0;try{g=JSON.stringify(c),h=this._getUrl("invoke"),d.performAjaxCall(h,g,!0,function(a){m(JSON.parse(a));f.isBusy=!1},function(a){m({result:null,error:a});f.isBusy=!1},null)}catch(r){a.checkIsDummy(r)&&a.throwDummy(r),this.isBusy=!1,this._onDataOperError(r,
2),e({result:null,error:r}),a.throwDummy(r)}};f.prototype._loadFromCache=function(b,c){var d=b.dbSet,e;try{e=d._getInternal().fillFromCache({isPageChanged:c,fn_beforeFillEnd:null})}catch(f){a.checkIsDummy(f)&&a.throwDummy(f),this._onDataOperError(f,1),a.throwDummy(f)}return e};f.prototype._loadIncluded=function(a){var b=this;a.included&&0<a.included.length&&a.included.forEach(function(a){b.getDbSet(a.dbSetName).fillItems(a)})};f.prototype._onLoaded=function(c,d){var e=this,f,g,h;try{if(!c)throw Error(b.format(a.ERRS.ERR_UNEXPECTED_SVC_ERROR,
"null result"));f=c.dbSetName;g=e.getDbSet(f);if(!g)throw Error(b.format(a.ERRS.ERR_DBSET_NAME_INVALID,f));q(c.error,1);h=g._getInternal().fillFromService({res:c,isPageChanged:d,fn_beforeFillEnd:function(){e._loadIncluded(c)}})}catch(m){a.checkIsDummy(m)&&a.throwDummy(m),this._onDataOperError(m,1),a.throwDummy(m)}return h};f.prototype._dataSaved=function(c){var d=this,e=[],f=[];try{try{q(c.error,0)}catch(g){throw c.dbSets.forEach(function(c){var u=d._dbSets.getDbSet(c.dbSetName);c.rows.forEach(function(c){var d=
u.getItemByKey(c.clientKey);if(!d)throw Error(b.format(a.ERRS.ERR_KEY_IS_NOTFOUND,c.clientKey));e.push(d);c.invalid&&(u._getInternal().setItemInvalid(c),f.push(d))})}),new C(g,e,f);}c.dbSets.forEach(function(a){d._dbSets.getDbSet(a.dbSetName)._getInternal().commitChanges(a.rows)})}catch(h){a.checkIsDummy(h)&&a.throwDummy(h),this._onSubmitError(h),a.throwDummy(h)}};f.prototype._getChanges=function(){var a={dbSets:[],error:null,trackAssocs:[]};this._dbSets.arrDbSets.forEach(function(b){b.endEdit();
var c=b._getInternal().getChanges();if(0!==c.length){var d=b._getInternal().getTrackAssocInfo();a.dbSets.push({dbSetName:b.dbSetName,rows:c});a.trackAssocs=a.trackAssocs.concat(d)}});return a};f.prototype._getUrl=function(a){var b=this.service_url;d.str.endsWith(b,"/")||(b+="/");return b+=[a,""].join("/")};f.prototype.handleError=function(b,d){var e=c.prototype.handleError.call(this,b,d);return e?e:a.global.handleError(b,d)};f.prototype._onDataOperError=function(b,c){if(a.checkIsDummy(b))return!0;
var d;d=b instanceof m?b:new m(b,c);return this.handleError(d,this)};f.prototype._onSubmitError=function(a){var b={error:a,isHandled:!1};this.raiseEvent("submit_error",b);b.isHandled||(this.rejectChanges(),this._onDataOperError(a,0))};f.prototype.waitForNotBusy=function(a,b){this._waitQueue.enQueue({prop:"isBusy",groupName:null,predicate:function(a){return!a},action:a,actionArgs:b})};f.prototype.waitForNotSubmiting=function(a,b,c){this._waitQueue.enQueue({prop:"isSubmiting",predicate:function(a){return!a},
action:a,actionArgs:b,groupName:c,lastWins:!!c})};f.prototype.waitForInitialized=function(a,b){this._waitQueue.enQueue({prop:"isInitialized",groupName:"dbContext",predicate:function(a){return!!a},action:a,actionArgs:b})};f.prototype._loadInternal=function(b){var c=this,e=b.dbSet.query,f,g,h=1,m=b.pageIndex,r=b.loadPageCount,k=b.isPagingEnabled;b.fn_onStart();try{var n=function(b){function c(b,e){var f=!!b.included&&0<b.included.length;if(e&&0<e.length&&(f&&b.included.forEach(function(b){b.rows=e.splice(0,
b.rowCount);if(b.rowCount!=b.rows.length)throw Error(d.format(a.ERRS.ERR_ASSERTION_FAILED,"subset.rowCount == subset.rows.length"));}),b.rows=e,b.rowCount!=b.rows.length))throw Error(d.format(a.ERRS.ERR_ASSERTION_FAILED,"QueryResponse.rowCount == QueryResponse.rows.length"));return b}var e=[],f,u;(f=b.match(l))?(u=parseInt(f[1]),e.push(b.substr(f[0].length,u)),e.push(b.substr(f[0].length+u))):e.push(b);b=e.map(function(a){return JSON.parse(a)});e=b[0];1<b.length&&(e=c(b[0],b[1]));return e};b.query.pageIndex=
m;b.dbSet._getInternal().beforeLoad(b.query,e);if(1<r&&k){if(b.query._getInternal().isPageCached(m)){f=c._loadFromCache(b.query,b.isPageChanged);b.fn_onOK(f);return}g=b.query._getInternal().getCache().getNextRange(m);m=g.start;h=g.cnt}var p={dbSetName:b.dbSetName,pageIndex:m,pageSize:b.query.pageSize,pageCount:h,isIncludeTotalCount:b.query.isIncludeTotalCount,filterInfo:b.query.filterInfo,sortInfo:b.query.sortInfo,paramInfo:c._getMethodParams(b.query._getInternal().getQueryInfo(),b.query.params).paramInfo,
queryName:b.query.queryName};d.performAjaxCall(c._getUrl("query"),JSON.stringify(p),!0,function(a){try{var d=n(a);f=c._onLoaded(d,b.isPageChanged);b.fn_onOK(f)}catch(e){b.fn_onErr(e)}},function(a){b.fn_onErr2(a)},null)}catch(q){b.fn_onErr(q)}};f.prototype._onItemRefreshed=function(b,c){try{if(q(b.error,3),b.rowInfo)c._aspect._refreshValues(b.rowInfo,2);else throw c._aspect.dbSet.removeItem(c),c._aspect.destroy(),Error(a.ERRS.ERR_ITEM_DELETED_BY_ANOTHER_USER);}catch(d){a.checkIsDummy(d)&&a.throwDummy(d),
this._onDataOperError(d,3),a.throwDummy(d)}};f.prototype._refreshItem=function(a){function b(a){a.fn_onStart();try{var c={dbSetName:a.item._aspect.dbSetName,rowInfo:a.item._aspect._getRowInfo(),error:null};a.item._aspect._checkCanRefresh();d.performAjaxCall(f._getUrl("refresh"),JSON.stringify(c),!0,function(b){try{a.fn_onOK(JSON.parse(b))}catch(c){a.fn_onErr(c)}},function(b){a.fn_onErr2(b)},null)}catch(e){a.fn_onErr(e)}}var c=d.createDeferred(),e=function(b){b?c.resolve(a):c.reject()},f=this,g={item:a,
dbSet:a._aspect.dbSet,fn_onStart:function(){g.item._aspect.isRefreshing=!0;f.isBusy=!0;g.dbSet.isLoading=!0},fn_onEnd:function(){f.isBusy=!1;g.dbSet.isLoading=!1;g.item._aspect.isRefreshing=!1},fn_onErr:function(a){g.fn_onEnd();f._onDataOperError(a,3);e(!1)},fn_onErr2:function(a){g.fn_onEnd();f._onDataOperError(a,3);e(!1)},fn_onOK:function(b){f._onItemRefreshed(b,a);g.fn_onEnd();e(!0)}};this.waitForNotSubmiting(function(){g.dbSet.waitForNotLoading(function(){return b(g)},[],!0,null)},[],null);return c.promise()};
f.prototype._getQueryInfo=function(a){return this._queryInf[a]};f.prototype._onDbSetHasChangesChanged=function(a){var b=this._isHasChanges;this._isHasChanges=!1;if(a.isHasChanges)this._isHasChanges=!0;else for(var c=0,d=this._dbSets.arrDbSets.length;c<d;c+=1)if(a=this._dbSets.arrDbSets[c],a.isHasChanges){this._isHasChanges=!0;break}this._isHasChanges!==b&&this.raisePropertyChanged("isHasChanges")};f.prototype._load=function(b,c){if(!b)throw Error(a.ERRS.ERR_DB_LOAD_NO_QUERY);var e=this,f=d.createDeferred(),
g={query:b,isPageChanged:c,loadPageCount:b.loadPageCount,pageIndex:b.pageIndex,isPagingEnabled:b.isPagingEnabled,dbSetName:b.dbSetName,dbSet:e.getDbSet(b.dbSetName),fn_onStart:function(){g.dbSet.isLoading=!0;e.isBusy=!0},fn_onEnd:function(){g.dbSet.isLoading=!1;e.isBusy=!1},fn_onOK:function(a){g.fn_onEnd();f.resolve(a)},fn_onErr:function(a){g.fn_onEnd();e._onDataOperError(a,1);f.reject()},fn_onErr2:function(a){g.fn_onEnd();e._onDataOperError(a,1);f.reject()}};this.waitForNotSubmiting(function(){g.dbSet.waitForNotLoading(function(){return e._loadInternal(g)},
[],!0,c?"paging":null)},[],c?"paging":null);return f.promise()};f.prototype.initialize=function(b){if(!this._isInitialized){var c=this;b=d.extend(!1,{serviceUrl:null,permissions:null},b);var e,f;try{if(!d.check.isString(b.serviceUrl))throw Error(d.format(a.ERRS.ERR_PARAM_INVALID,"serviceUrl",b.serviceUrl));this._serviceUrl=b.serviceUrl;this._initDbSets();if(b.permissions){c._updatePermissions(b.permissions);c._isInitialized=!0;c.raisePropertyChanged("isInitialized");return}e=this._getUrl("permissions");
f=4}catch(g){this.handleError(g,this),a.throwDummy(g)}try{this.isBusy=!0,d.performAjaxGet(e).done(function(b){try{c._updatePermissions(JSON.parse(b)),c.isBusy=!1,c._isInitialized=!0,c.raisePropertyChanged("isInitialized")}catch(d){c.isBusy=!1,c._onDataOperError(d,f),a.throwDummy(d)}}).fail(function(a){c.isBusy=!1;c._onDataOperError(a,f)})}catch(h){this.isBusy=!1,this._onDataOperError(h,f),a.throwDummy(h)}}};f.prototype.addOnSubmitError=function(a,b,c){this._addHandler("submit_error",a,b,c)};f.prototype.removeOnSubmitError=
function(a){this._removeHandler("submit_error",a)};f.prototype._getInternal=function(){return this._internal};f.prototype.getDbSet=function(a){return this._dbSets.getDbSet(a)};f.prototype.getAssociation=function(c){var d=this._assoc["get"+c];if(!d)throw Error(b.format(a.ERRS.ERR_ASSOC_NAME_INVALID,c));return d()};f.prototype.submitChanges=function(){function a(c){var e;c.fn_onStart();try{e=b._getChanges(),0===e.dbSets.length?c.fn_onOk():d.performAjaxCall(b._getUrl("save"),JSON.stringify(e),!0,function(a){try{b._dataSaved(JSON.parse(a)),
c.fn_onOk()}catch(d){c.fn_onErr(d)}},function(a){c.fn_onErr2(a)},null)}catch(f){c.fn_onErr(f)}}if(this._pendingSubmit)return this._pendingSubmit.deferred.promise();var b=this,c={deferred:d.createDeferred()},e=function(a){a?c.deferred.resolve():c.deferred.reject()};this._pendingSubmit=c;var f={fn_onStart:function(){b.isBusy=!0;b.isSubmiting=!0;b._pendingSubmit=null},fn_onEnd:function(){b.isBusy=!1;b.isSubmiting=!1},fn_onErr:function(a){f.fn_onEnd();b._onDataOperError(a,0);e(!1)},fn_onErr2:function(a){f.fn_onEnd();
b._onSubmitError(a);e(!1)},fn_onOk:function(){f.fn_onEnd();e(!0)}};this.waitForNotBusy(function(){return a(f)},[]);return c.deferred.promise()};f.prototype.load=function(a){return this._load(a,!1)};f.prototype.acceptChanges=function(){this._dbSets.arrDbSets.forEach(function(a){a.acceptChanges()})};f.prototype.rejectChanges=function(){this._dbSets.arrDbSets.forEach(function(a){a.rejectChanges()})};f.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._waitQueue.destroy(),
this._waitQueue=null,this._arrAssoc.forEach(function(a){a.destroy()}),this._arrAssoc=[],this._assoc={},this._dbSets.destroy(),this._dbSets=null,this._svcMethods={},this._queryInf={},this._serviceUrl=null,this._isInitialized=!1,this._isBusy=0,this._isHasChanges=this._isSubmiting=!1,c.prototype.destroy.call(this))};Object.defineProperty(f.prototype,"service_url",{get:function(){return this._serviceUrl},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isInitialized",{get:function(){return this._isInitialized},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isBusy",{get:function(){return 0<this._isBusy},set:function(a){var b=0<this._isBusy;a?this._isBusy+=1:(--this._isBusy,0>this._isBusy&&(this._isBusy=0));0<this._isBusy!=b&&this.raisePropertyChanged("isBusy")},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isSubmiting",{get:function(){return this._isSubmiting},set:function(a){this._isSubmiting!==a&&(this._isSubmiting=a,this.raisePropertyChanged("isSubmiting"))},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"serverTimezone",{get:function(){return this._serverTimezone},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"dbSets",{get:function(){return this._dbSets},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"serviceMethods",{get:function(){return this._svcMethods},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isHasChanges",{get:function(){return this._isHasChanges},enumerable:!0,configurable:!0});
return f}(a.BaseObject);c.DbContext=n;var D=function(c){function e(a){c.call(this);var f=this;this._objId="ass"+b.getNewID();a=d.extend(!1,{dbContext:null,parentName:"",childName:"",parentKeyFields:[],childKeyFields:[],parentToChildrenName:null,childToParentName:null,name:this._objId,onDeleteAction:0},a);this._name=a.name;this._dbContext=a.dbContext;this._onDeleteAction=a.onDeleteAction;this._parentDS=a.dbContext.getDbSet(a.parentName);this._childDS=a.dbContext.getDbSet(a.childName);this._parentFldInfos=
a.parentKeyFields.map(function(a){return f._parentDS.getFieldInfo(a)});this._childFldInfos=a.childKeyFields.map(function(a){return f._childDS.getFieldInfo(a)});this._parentToChildrenName=a.parentToChildrenName;this._childToParentName=a.childToParentName;this._parentMap={};this._childMap={};this._isChildFilling=this._isParentFilling=!1;this._bindParentDS();a=this._mapParentItems(this._parentDS.items);this._bindChildDS();var g=this._mapChildren(this._childDS.items);this._changedTimeout=this._saveChildFKey=
this._saveParentFKey=null;this._changed={};f._notifyParentChanged(a);f._notifyChildrenChanged(g)}__extends(e,c);e.prototype.handleError=function(b,d){var e=c.prototype.handleError.call(this,b,d);return e?e:a.global.handleError(b,d)};e.prototype._bindParentDS=function(){var a=this,b=this._parentDS;b&&(b.addOnCollChanged(function(b,c){a._onParentCollChanged(c)},a._objId,null,!0),b.addOnFill(function(b,c){a._onParentFill(c)},a._objId,null,!0),b.addOnBeginEdit(function(b,c){a._onParentEdit(c.item,!0,
void 0)},a._objId,null,!0),b.addOnEndEdit(function(b,c){a._onParentEdit(c.item,!1,c.isCanceled)},a._objId,null,!0),b.addOnItemDeleting(function(a,b){},a._objId,null,!0),b.addOnStatusChanged(function(b,c){a._onParentStatusChanged(c.item,c.oldStatus)},a._objId,null,!0),b.addOnCommitChanges(function(b,c){a._onParentCommitChanges(c.item,c.isBegin,c.isRejected,c.status)},a._objId,null,!0))};e.prototype._bindChildDS=function(){var a=this,b=this._childDS;b&&(b.addOnCollChanged(function(b,c){a._onChildCollChanged(c)},
a._objId,null,!0),b.addOnFill(function(b,c){a._onChildFill(c)},a._objId,null,!0),b.addOnBeginEdit(function(b,c){a._onChildEdit(c.item,!0,void 0)},a._objId,null,!0),b.addOnEndEdit(function(b,c){a._onChildEdit(c.item,!1,c.isCanceled)},a._objId,null,!0),b.addOnStatusChanged(function(b,c){a._onChildStatusChanged(c.item,c.oldStatus)},a._objId,null,!0),b.addOnCommitChanges(function(b,c){a._onChildCommitChanges(c.item,c.isBegin,c.isRejected,c.status)},a._objId,null,!0))};e.prototype._onParentCollChanged=
function(c){var d=this,e;e=c.items;var f=[],g={};switch(c.changeType){case 2:d._isParentFilling||(f=d.refreshParentMap());break;case 1:this._isParentFilling||(f=d._mapParentItems(e));break;case 0:e.forEach(function(a){(a=d._unMapParentItem(a))&&(g[a]=null)});f=Object.keys(g);break;case 3:c.old_key&&(e=this._parentMap[c.old_key])&&(delete this._parentMap[c.old_key],f=this._mapParentItems([e]));break;default:throw Error(b.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,c.changeType));}d._notifyParentChanged(f)};
e.prototype._onParentFill=function(a){a.isBegin?this._isParentFilling=!0:(this._isParentFilling=!1,a=a.resetUI?this.refreshParentMap():this._mapParentItems(a.newItems),this._notifyParentChanged(a))};e.prototype._onParentEdit=function(a,b,c){b?this._storeParentFKey(a):c?this._saveParentFKey=null:this._checkParentFKey(a)};e.prototype._onParentCommitChanges=function(a,b,c,d){b?c&&1===d?(a=this._unMapParentItem(a))&&this._notifyParentChanged([a]):c||3!==d?this._storeParentFKey(a):(a=this._unMapParentItem(a))&&
this._notifyParentChanged([a]):this._checkParentFKey(a)};e.prototype._storeParentFKey=function(a){a=this.getParentFKey(a);null!==a&&this._parentMap[a]&&(this._saveParentFKey=a)};e.prototype._checkParentFKey=function(a){var b,c=this._saveParentFKey;this._saveParentFKey=null;b=this.getParentFKey(a);b!==c&&(c&&(delete this._parentMap[c],this._notifyChildrenChanged([c]),this._notifyParentChanged([c])),b&&(this._mapParentItems([a]),this._notifyChildrenChanged([b]),this._notifyParentChanged([b])))};e.prototype._onParentStatusChanged=
function(a,b){var c=this,d=null,e;if(3===a._aspect.status){e=c.getChildItems(a);d=this._unMapParentItem(a);switch(c.onDeleteAction){case 1:e.forEach(function(a){a._aspect.deleteItem()});break;case 2:e.forEach(function(a){var b=a._aspect.isEditing;b||a._aspect.beginEdit();try{c._childFldInfos.forEach(function(b){a[b.fieldName]=null}),b||a._aspect.endEdit()}finally{b||a._aspect.cancelEdit()}})}d&&c._notifyParentChanged([d])}};e.prototype._onChildCollChanged=function(c){var d=this,e=c.items,f=[],g={};
switch(c.changeType){case 2:d._isChildFilling||(f=d.refreshChildMap());break;case 1:this._isChildFilling||(f=d._mapChildren(e));break;case 0:e.forEach(function(a){(a=d._unMapChildItem(a))&&(g[a]=null)});f=Object.keys(g);break;case 3:if(c.old_key&&(c=e[0])){if(f=c._aspect._getFieldVal(this._childToParentName))delete this._childMap[f],c._aspect._clearFieldVal(this._childToParentName);f=this._mapChildren([c])}break;default:throw Error(b.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,c.changeType));
}d._notifyChildrenChanged(f)};e.prototype._notifyChildrenChanged=function(a){this._notifyChanged([],a)};e.prototype._notifyParentChanged=function(a){this._notifyChanged(a,[])};e.prototype._notifyChanged=function(a,b){var c=this;if(0<a.length||0<b.length)a.forEach(function(a){var b=c._changed[a];c._changed[a]=b?b|1:1}),b.forEach(function(a){var b=c._changed[a];c._changed[a]=b?b|2:2}),this._changedTimeout||(this._changedTimeout=setTimeout(function(){if(!c._isDestroyCalled){c._changedTimeout=null;var a=
c._changed;c._changed={};Object.keys(a).forEach(function(b){var d=a[b];1==(d&1)&&c._onParentChanged(b);2==(d&2)&&c._onChildrenChanged(b)})}},50))};e.prototype._onChildFill=function(a){a.isBegin?this._isChildFilling=!0:(this._isChildFilling=!1,a=a.resetUI?this.refreshChildMap():this._mapChildren(a.newItems),this._notifyChildrenChanged(a))};e.prototype._onChildEdit=function(a,b,c){b?this._storeChildFKey(a):c?this._saveChildFKey=null:this._checkChildFKey(a)};e.prototype._onChildCommitChanges=function(a,
b,c,d){b?c&&1===d?(a=this._unMapChildItem(a))&&this._notifyChildrenChanged([a]):c||3!==d?this._storeChildFKey(a):(a=this._unMapChildItem(a))&&this._notifyChildrenChanged([a]):this._checkChildFKey(a)};e.prototype._storeChildFKey=function(a){var b=this.getChildFKey(a),c;b&&(c=this._childMap[b])&&-1<c.indexOf(a)&&(this._saveChildFKey=b)};e.prototype._checkChildFKey=function(a){var b=this._saveChildFKey,c,e;this._saveChildFKey=null;c=this.getChildFKey(a);c!==b&&(b&&(e=this._childMap[b],d.removeFromArray(e,
a),0==e.length&&delete this._childMap[b],this._notifyParentChanged([b]),this._notifyChildrenChanged([b])),c&&(this._mapChildren([a]),this._notifyParentChanged([c]),this._notifyChildrenChanged([c])))};e.prototype._onChildStatusChanged=function(a,b){var c=a._aspect.status,d=this.getChildFKey(a);d&&3===c&&(d=this._unMapChildItem(a))&&this._notifyChildrenChanged([d])};e.prototype._getItemKey=function(a,b,c){var d=[],e;b=b._getInternal();for(var f=0,g=a.length;f<g;f+=1){e=c[a[f].fieldName];e=b.getStrValue(e,
a[f]);if(null===e)return null;d.push(e)}return d.join(";")};e.prototype._resetChildMap=function(){var a=Object.keys(this._childMap);this._childMap={};this._notifyChildrenChanged(a)};e.prototype._resetParentMap=function(){var a=Object.keys(this._parentMap);this._parentMap={};this._notifyParentChanged(a)};e.prototype._unMapChildItem=function(a){var b,c,e=null;if(b=this.getChildFKey(a))if(c=this._childMap[b])a=d.removeFromArray(c,a),-1<a&&(0==c.length&&delete this._childMap[b],e=b);return e};e.prototype._unMapParentItem=
function(a){var b=null;(a=this.getParentFKey(a))&&this._parentMap[a]&&(delete this._parentMap[a],b=a);return b};e.prototype._mapParentItems=function(a){for(var b,c,d,e={},f=0,g=a.length;f<g;f+=1)if(b=a[f],c=b._aspect.status,3!==c&&(c=this.getParentFKey(b)))d=this._parentMap[c],d!==b&&(this._parentMap[c]=b,e[c]=null);return Object.keys(e)};e.prototype._onChildrenChanged=function(a){a&&this._parentToChildrenName&&(a=this._parentMap[a])&&a.raisePropertyChanged(this._parentToChildrenName)};e.prototype._onParentChanged=
function(a){var b=this;a&&this._childToParentName&&(a=this._childMap[a])&&a.forEach(function(a){a.raisePropertyChanged(b._childToParentName)})};e.prototype._mapChildren=function(a){for(var b,c,d,e={},f=0,g=a.length;f<g;f+=1)if(b=a[f],c=b._aspect.status,3!==c&&(c=this.getChildFKey(b)))d=this._childMap[c],d||(d=[],this._childMap[c]=d),0>d.indexOf(b)&&(d.push(b),e[c]||(e[c]=null));return Object.keys(e)};e.prototype._unbindParentDS=function(){var a=this.parentDS;a&&a.removeNSHandlers(this._objId)};e.prototype._unbindChildDS=
function(){var a=this.childDS;a&&a.removeNSHandlers(this._objId)};e.prototype.getParentFKey=function(a){return a&&a._aspect.isNew?a._key:this._getItemKey(this._parentFldInfos,this._parentDS,a)};e.prototype.getChildFKey=function(a){if(a&&this._childToParentName){var b=a._aspect._getFieldVal(this._childToParentName);if(b)return b}return this._getItemKey(this._childFldInfos,this._childDS,a)};e.prototype.getChildItems=function(a){if(!a)return[];a=this.getParentFKey(a);return(a=this._childMap[a])?a:[]};
e.prototype.getParentItem=function(a){if(!a)return null;a=this.getChildFKey(a);return(a=this._parentMap[a])?a:null};e.prototype.refreshParentMap=function(){this._resetParentMap();return this._mapParentItems(this._parentDS.items)};e.prototype.refreshChildMap=function(){this._resetChildMap();return this._mapChildren(this._childDS.items)};e.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,clearTimeout(this._changedTimeout),this._changedTimeout=null,this._changed={},this._unbindParentDS(),
this._unbindChildDS(),this._childFldInfos=this._parentFldInfos=this._childMap=this._parentMap=null,c.prototype.destroy.call(this))};e.prototype.toString=function(){return this._name};Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"parentToChildrenName",{get:function(){return this._parentToChildrenName},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"childToParentName",{get:function(){return this._childToParentName},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"parentDS",{get:function(){return this._parentDS},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"childDS",{get:function(){return this._childDS},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"parentFldInfos",{get:function(){return this._parentFldInfos},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"childFldInfos",{get:function(){return this._childFldInfos},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"onDeleteAction",{get:function(){return this._onDeleteAction},enumerable:!0,configurable:!0});return e}(a.BaseObject);c.Association=D;n=function(c){function e(f){c.call(this);f=d.extend(!1,{dataSource:null,fn_filter:null,fn_sort:null,fn_itemsProvider:null},f);if(!(f.dataSource&&f.dataSource instanceof g.BaseCollection))throw Error(a.ERRS.ERR_DATAVIEW_DATASRC_INVALID);if(!f.fn_filter||!d.check.isFunction(f.fn_filter))throw Error(a.ERRS.ERR_DATAVIEW_FILTER_INVALID);
this._objId="dvw"+b.getNewID();this._dataSource=f.dataSource;this._fn_filter=f.fn_filter;this._fn_sort=f.fn_sort;this._fn_itemsProvider=f.fn_itemsProvider;this._isAddingNew=this._isDSFilling=!1;var h=this,m=this._dataSource;m.getFieldNames().forEach(function(a){h._fieldMap[a]=d.extend(!1,{},m.getFieldInfo(a))});this._bindDS()}__extends(e,c);e.prototype._getEventNames=function(){var a=c.prototype._getEventNames.call(this);return["view_refreshed"].concat(a)};e.prototype.addOnViewRefreshed=function(a,
b){this._addHandler("view_refreshed",a,b)};e.prototype.removeOnViewRefreshed=function(a){this._removeHandler("view_refreshed",a)};e.prototype._filterForPaging=function(a){var b=0,c=0,d=-1,e=-1,f=[],b=this.pageSize*this.pageIndex,c=this.pageSize;a.forEach(function(a){e+=1;e<b||(d+=1,d<c&&f.push(a))});return f};e.prototype._onViewRefreshed=function(a){this.raiseEvent("view_refreshed",a)};e.prototype._clear=function(a){this.cancelEdit();this._EditingItem=null;this._newKey=0;this.currentItem=null;this._items=
[];this._itemsByKey={};this._errors={};this._onCollectionChanged({changeType:2,items:[]});a||(this.pageIndex=0);this._onCountChanged()};e.prototype._refresh=function(a){var b;if(b=this._dataSource)b=this._fn_itemsProvider?this._fn_itemsProvider(b):b.items,this._fn_filter&&(b=b.filter(this._fn_filter)),this._fn_sort&&(b=b.sort(this._fn_sort)),this._fillItems({items:b,isPageChanged:!!a,clear:!0,isAppend:!1}),this._onViewRefreshed({})};e.prototype._fillItems=function(a){a=d.extend(!1,{items:[],isPageChanged:!1,
clear:!0,isAppend:!1},a);var b=this,c,e=[],f=[],g=[];this._onFillStart({isBegin:!0,rowCount:a.items.length,time:new Date,isPageChanged:a.isPageChanged});try{a.clear&&this._clear(a.isPageChanged),c=this.isPagingEnabled&&!a.isAppend?this._filterForPaging(a.items):a.items,c.forEach(function(a){var c=b._itemsByKey[a._key];c?g.push(c):(b._itemsByKey[a._key]=a,e.push(a),f.push(b._items.length-1),b._items.push(a),g.push(a))}),0<e.length&&(this._onCollectionChanged({changeType:1,items:e,pos:f}),this._onCountChanged())}finally{this._onFillEnd({isBegin:!1,
rowCount:g.length,time:new Date,resetUI:!!a.clear,fetchedItems:g,newItems:e,isPageChanged:a.isPageChanged})}this.totalCount=a.clear?a.items.length:this.totalCount+e.length;this.moveFirst();return e};e.prototype._onDSCollectionChanged=function(c,d){var e=this,f;f=d.items;switch(d.changeType){case 2:this._isDSFilling||this._refresh(!1);break;case 1:this._isAddingNew||this._isDSFilling||(e._fn_filter&&(f=f.filter(e._fn_filter)),e.appendItems(f));break;case 0:f.forEach(function(a){(a=e._itemsByKey[a._key])&&
e.removeItem(a)});break;case 3:if(f=e._itemsByKey[d.old_key])delete e._itemsByKey[d.old_key],e._itemsByKey[d.new_key]=f,this._onCollectionChanged(d);break;default:throw Error(b.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,d.changeType));}};e.prototype._onDSFill=function(a,b){var c=b.fetchedItems;b.isBegin?this._isDSFilling=!0:(this._isDSFilling=!1,b.resetUI?this._refresh(!1):(this._fn_filter&&(c=c.filter(this._fn_filter)),this.appendItems(c)))};e.prototype._onDSStatusChanged=function(a,b){var c=
b.item,d=b.oldStatus,e=!!this._fn_filter;this._itemsByKey[b.key]?(this._onItemStatusChanged(c,d),e&&((d=this._fn_filter(c))||this.removeItem(c))):e&&(d=this._fn_filter(c))&&this.appendItems([c])};e.prototype._bindDS=function(){var a=this,b=this._dataSource;b&&(b.addOnCollChanged(a._onDSCollectionChanged,a._objId,a),b.addOnFill(a._onDSFill,a._objId,a),b.addOnBeginEdit(function(b,c){a._itemsByKey[c.item._key]&&a._onEditing(c.item,!0,!1)},a._objId),b.addOnEndEdit(function(b,c){var d,e=c.item;d=!!a._fn_filter;
a._itemsByKey[e._key]?(a._onEditing(e,!1,c.isCanceled),!c.isCanceled&&d&&((d=a._fn_filter(e))||a.removeItem(e))):!c.isCanceled&&d&&(d=a._fn_filter(e))&&a.appendItems([e])},a._objId),b.addOnErrorsChanged(function(b,c){a._itemsByKey[c.item._key]&&a._onErrorsChanged(c.item)},a._objId),b.addOnStatusChanged(a._onDSStatusChanged,a._objId,a),b.addOnItemDeleting(function(b,c){a._itemsByKey[c.item._key]&&a._onItemDeleting(c)},a._objId),b.addOnItemAdded(function(b,c){a._isAddingNew&&(a._itemsByKey[c.item._key]||
a._attach(c.item),a.currentItem=c.item,a._onEditing(c.item,!0,!1),a._onItemAdded(c.item))},a._objId),b.addOnItemAdding(function(b,c){a._isAddingNew&&a._onItemAdding(c.item)},a._objId))};e.prototype._unbindDS=function(){var a=this._dataSource;a&&a.removeNSHandlers(this._objId)};e.prototype._onCurrentChanging=function(b){var c=this._dataSource,d;try{(d=c._getInternal().getEditingItem())&&b!==d&&c.endEdit()}catch(e){c.cancelEdit(),a.reThrow(e,this.handleError(e,this))}};e.prototype._onPageChanged=function(){this._refresh(!0)};
e.prototype._getStrValue=function(a,b){return this._dataSource._getInternal().getStrValue(a,b)};e.prototype._getErrors=function(a){return this._dataSource._getInternal().getErrors(a)};e.prototype.getItemsWithErrors=function(){return this._dataSource.getItemsWithErrors()};e.prototype.appendItems=function(a){return this._isDestroyCalled?[]:this._fillItems({items:a,isPageChanged:!1,clear:!1,isAppend:!0})};e.prototype.addNew=function(){var a;this._isAddingNew=!0;try{a=this._dataSource.addNew()}finally{this._isAddingNew=
!1}return a};e.prototype.removeItem=function(b){if(null===b._key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);if(this._itemsByKey[b._key]){var c=d.removeFromArray(this._items,b);if(0>c)throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);delete this._itemsByKey[b._key];delete this._errors[b._key];--this.totalCount;this._onRemoved(b,c);b=this.getItemByPos(c);var e=this._currentPos;e===c&&(b||(this._currentPos=e-1),this._onCurrentChanged());e>c&&(this._currentPos=e-1,this._onCurrentChanged())}};e.prototype.sortLocal=
function(b,c){var e=1,f=a.global.parser,g=d.createDeferred();1===c&&(e=-1);var h=function(a,c){var d=0,g,h,m;g=0;for(h=b.length;g<h&&(m=b[g],d=f.resolvePath(a,m),m=f.resolvePath(c,m),d=d<m?-1*e:d>m?e:0,0===d);g+=1);return d};try{this.fn_sort=h,g.resolve()}catch(m){g.reject(m),this.handleError(m,this),a.throwDummy(m)}return g.promise()};e.prototype.getIsHasErrors=function(){return this._dataSource.getIsHasErrors()};e.prototype.clear=function(){this._clear(!1)};e.prototype.refresh=function(){this._refresh(!1)};
e.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._unbindDS(),this._fn_sort=this._fn_filter=this._dataSource=null,c.prototype.destroy.call(this))};Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isPagingEnabled",{get:function(){return this._options.enablePaging},set:function(a){this._options.enablePaging!==a&&(this._options.enablePaging=a,this.raisePropertyChanged("isPagingEnabled"),
this._refresh(!1))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"permissions",{get:function(){return this._dataSource.permissions},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fn_filter",{get:function(){return this._fn_filter},set:function(a){this._fn_filter!==a&&(this._fn_filter=a,this._refresh(!1))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fn_sort",{get:function(){return this._fn_sort},set:function(a){this._fn_sort!==a&&(this._fn_sort=
a,this._refresh(!1))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fn_itemsProvider",{get:function(){return this._fn_itemsProvider},set:function(a){this._fn_itemsProvider!==a&&(this._fn_itemsProvider=a,this._refresh(!1))},enumerable:!0,configurable:!0});return e}(g.BaseCollection);c.DataView=n;var E=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(n);c.TDataView=E;n=function(a){function b(c){this._refreshTimeout=this._parentItem=null;this._association=
c.association;var e=d.extend(!1,{dataSource:this._association.childDS,fn_filter:null,fn_sort:null,fn_itemsProvider:null},c),f=this,g=this._association,h=c.fn_filter;e.fn_filter=function(a){if(!f._parentItem)return!1;var b=g.getParentFKey(f._parentItem);if(!b)return!1;var c=g.getChildFKey(a);return c&&b===c?h?h(a):!0:!1};a.call(this,e)}__extends(b,a);b.prototype._refresh=function(a){if(this.dataSource){var b=this._association.getChildItems(this._parentItem);this.fn_filter&&(b=b.filter(this.fn_filter));
this.fn_sort&&(b=b.sort(this.fn_sort));this._fillItems({items:b,isPageChanged:!!a,clear:!0,isAppend:!1});this._onViewRefreshed({})}};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,clearTimeout(this._refreshTimeout),this._association=null,a.prototype.destroy.call(this))};b.prototype.toString=function(){return this._association?"ChildDataView for "+this._association.toString():"ChildDataView"};Object.defineProperty(b.prototype,"parentItem",{get:function(){return this._parentItem},
set:function(a){if(this._parentItem!==a){this._parentItem=a;this.raisePropertyChanged("parentItem");var b=this;0<this.items.length&&(this.clear(),this._onViewRefreshed({}));clearTimeout(b._refreshTimeout);b._refreshTimeout=setTimeout(function(){b._isDestroyCalled||b._refresh(!1)},250)}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"association",{get:function(){return this._association},enumerable:!0,configurable:!0});return b}(n);c.ChildDataView=n;n=function(a){function b(){a.apply(this,
arguments)}__extends(b,a);return b}(n);c.TChildDataView=n;n=function(b){function c(a){b.call(this);this._name=a}__extends(c,b);c.prototype._getFullPath=function(a){throw Error("Not Implemented");};c.prototype.getName=function(){return this._name};c.prototype.setValue=function(a,b){throw Error("Not Implemented");};c.prototype.getValue=function(a){throw Error("Not Implemented");};c.prototype.getFieldInfo=function(){throw Error("Not Implemented");};c.prototype.getProperties=function(){throw Error("Not Implemented");
};c.prototype.getFullPath=function(a){throw Error("Not Implemented");};c.prototype.getEntity=function(){throw Error("Not Implemented");};c.prototype.getPropertyByName=function(b){var c=this.getProperties().filter(function(a){return a.fieldName==b});if(!c||1!=c.length)throw Error(d.format(a.ERRS.ERR_ASSERTION_FAILED,"arrProps.length == 1"));return c[0]};c.prototype.getIsHasErrors=function(){return this.getEntity().getIsHasErrors()};c.prototype.addOnErrorsChanged=function(a,b,c){this.getEntity().addOnErrorsChanged(a,
b,c)};c.prototype.removeOnErrorsChanged=function(a){this.getEntity().removeOnErrorsChanged(a)};c.prototype.getFieldErrors=function(a){a=this.getFullPath(a);return this.getEntity().getFieldErrors(a)};c.prototype.getAllErrors=function(){return this.getEntity().getAllErrors()};c.prototype.getIErrorNotification=function(){return this};return c}(a.BaseObject);c.BaseComplexProperty=n;var F=function(a){function b(c,d){a.call(this,c);this._entity=d}__extends(b,a);b.prototype._getFullPath=function(a){return this.getName()+
"."+a};b.prototype.setValue=function(a,b){this._entity._setFieldVal(a,b)};b.prototype.getValue=function(a){return this._entity._getFieldVal(a)};b.prototype.getFieldInfo=function(){return this._entity.getFieldInfo(this.getName())};b.prototype.getProperties=function(){return this.getFieldInfo().nested};b.prototype.getEntity=function(){return this._entity};b.prototype.getFullPath=function(a){return this.getName()+"."+a};return b}(n);c.RootComplexProperty=F;n=function(b){function c(a,d){b.call(this,a);
this._parent=d}__extends(c,b);c.prototype._getFullPath=function(a){return this._parent._getFullPath(this.getName()+"."+a)};c.prototype.setValue=function(a,b){this.getEntity()._setFieldVal(a,b)};c.prototype.getValue=function(a){return this.getEntity()._getFieldVal(a)};c.prototype.getFieldInfo=function(){var a=this.getName();return this._parent.getPropertyByName(a)};c.prototype.getProperties=function(){return this.getFieldInfo().nested};c.prototype.getParent=function(){return this._parent};c.prototype.getRootProperty=
function(){for(var b=this._parent;b&&b instanceof c;)b=b.getParent();if(!(b&&b instanceof F))throw Error(d.format(a.ERRS.ERR_ASSERTION_FAILED,"parent instanceof RootComplexProperty"));return b};c.prototype.getFullPath=function(a){return this._parent._getFullPath(this.getName()+"."+a)};c.prototype.getEntity=function(){return this.getRootProperty().getEntity()};return c}(n);c.ChildComplexProperty=n;c._isModuleLoaded=!0})(t.db||(t.db={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){var t=a.consts,c=a.MOD.utils,q=a.MOD.binding,p=a.MOD.baseContent,k=a.MOD.dataform;a.global._getInternal().initialize();var g=a.global.utils,n=a.global.parser,l=function(h){function e(b){h.call(this);var c=this,m="default",f=[];this._options=null;b&&(this._options=b,b.application_name&&(m=b.application_name),b.user_modules&&(f=b.user_modules));if(a.global.findApp(m))throw Error(g.format(a.ERRS.ERR_APP_NAME_NOT_UNIQUE,m));this._app_name=m;this._objId="app:"+a.baseUtils.getNewID();this._objLifeTime=
null;this._ELV_STORE_KEY=t.DATA_ATTR.EL_VIEW_KEY+e._newInstanceNum;e._newInstanceNum+=1;this._contentFactory=new p.FactoryList(this);this._objMaps=[];this._exports={};this._modules={};this._elViewStore={};this._nextElViewStoreKey=0;this._userCode={};this._viewModels={};this._internal={getElView:function(a){return c._getElView(a)},createElementView:function(a,b){return c._createElementView(a,b)},setElView:function(a,b){c._setElView(a,b)},bindTemplateElements:function(a){return c._bindTemplateElements(a)},
bindElements:function(a,b,e,f){return c._bindElements(a,b,e,f)},getContentType:function(a){return c._contentFactory.getContentType(a)},addContentFactory:function(a){c._contentFactory.addFactory(a)}};this._initModules();this._initUserModules(f);a.global._getInternal().registerApp(this)}__extends(e,h);Object.defineProperty(e.prototype,"_DATA_BIND_SELECTOR",{get:function(){return["*[",t.DATA_ATTR.DATA_BIND,"]"].join("")},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"_DATA_VIEW_SELECTOR",
{get:function(){return["*[",t.DATA_ATTR.DATA_VIEW,"]"].join("")},enumerable:!0,configurable:!0});e.prototype._getEventNames=function(){var a=h.prototype._getEventNames.call(this);return["startup"].concat(a)};e.prototype._cleanUpObjMaps=function(){var b=this;this._objMaps.forEach(function(c){g.forEachProp(c,function(e){e=c[e];e instanceof a.BaseObject&&(e.getIsDestroyed()||e.removeNSHandlers(b.uniqueID))})});this._objMaps=[]};e.prototype._initModules=function(){var b=this,c=a.MOD;Object.keys(a.MOD).forEach(function(a){a=
c[a];a._isModuleLoaded&&a._initModule&&a._initModule(b)})};e.prototype._initUserModules=function(a){var c=this;a.forEach(function(a){c._modules[a.name]=a.initFn(c)})};e.prototype._destroyBindings=function(){this._objLifeTime&&(this._objLifeTime.destroy(),this._objLifeTime=null)};e.prototype._setUpBindings=function(){var a=this.appRoot;this._destroyBindings();this._objLifeTime=this._bindElements(a,this,!1,!1)};e.prototype._getElementViewInfo=function(a){var c=null,e=null;a.hasAttribute(t.DATA_ATTR.DATA_VIEW)&&
(a=a.getAttribute(t.DATA_ATTR.DATA_VIEW),(a=n.parseOptions(a))&&0<a.length&&(e=a[0],e.name&&"default"!=e.name&&(c=e.name),e=e.options));return{name:c,options:e}};e.prototype.handleError=function(b,c){if(a.checkIsDummy(b))return!0;var e=h.prototype.handleError.call(this,b,c);return e?e:a.global.handleError(b,c)};e.prototype._getElViewType=function(a){a="elvws."+a;var c=this.global,e=c._getInternal().getObject(this,a);e||(e=c._getInternal().getObject(c,a));return e};e.prototype._checkBindableElement=
function(b){for(var c=b.attributes,e,f={el:b,dataView:null,dataForm:null,expressions:[]},h=0,k=c.length;h<k;h++){e=c[h];if(g.str.startsWith(e.name,t.DATA_ATTR.DATA_BIND)){b=e.value.trim();if(!b)throw Error(g.format(a.ERRS.ERR_PARAM_INVALID,e.name,"empty"));"{"!=b[0]&&"}"!=b[b.length-1]&&(b="{"+b+"}");f.expressions.push(b)}g.str.startsWith(e.name,t.DATA_ATTR.DATA_FORM)&&(f.dataForm=e.value.trim());g.str.startsWith(e.name,t.DATA_ATTR.DATA_VIEW)&&(f.dataView=e.value.trim())}return f.dataView||0<f.expressions.length?
f:null};e.prototype._getAllBindableHtmlElements=function(b){var c=this,e=[];a.ArrayHelper.fromList(b.querySelectorAll("*")).forEach(function(a){(a=c._checkBindableElement(a))&&e.push(a)});return e};e.prototype._getElView=function(a){return(a=a.getAttribute(this._ELV_STORE_KEY))?this._elViewStore[a]:null};e.prototype._createElementView=function(b,c){var e;if(c.name&&(e=this._getElViewType(c.name),!e))throw Error(g.format(a.ERRS.ERR_ELVIEW_NOT_REGISTERED,c.name));if(!e){var f=b.nodeName.toLowerCase();
switch(f){case "input":e=b.getAttribute("type");f=f+":"+e;e=this._getElViewType(f);break;default:e=this._getElViewType(f)}if(!e)throw Error(g.format(a.ERRS.ERR_ELVIEW_NOT_CREATED,f));}return new e(this,b,c.options||{})};e.prototype._setElView=function(a,c){var e=a.getAttribute(this._ELV_STORE_KEY);e?c?this._elViewStore[e]=c:(a.removeAttribute(this._ELV_STORE_KEY),delete this._elViewStore[e]):c&&(e="s_"+this._nextElViewStoreKey,this._nextElViewStoreKey+=1,a.setAttribute(this._ELV_STORE_KEY,e),this._elViewStore[e]=
c)};e.prototype._bindTemplateElements=function(b){var d=this,e=this._getAllBindableHtmlElements(b),f=new c.LifeTimeScope,g=t.DATA_ATTR.DATA_FORM,h=d._checkBindableElement(b);h&&e.push(h);e.forEach(function(a){!a.dataForm&&k._isDataForm(a.el)&&(a.el.setAttribute(g,"yes"),a.dataForm="yes")});var l=e.filter(function(a,b,c){return!!a.dataForm}).map(function(a,b,c){return a.el});h&&h.dataForm&&(e=[h]);e.forEach(function(c){var e,g,h,m,p;if(!k._isInNestedForm(b,l,c.el)){try{h=d.getElementView(c.el)}catch(t){a.reThrow(t,
d.handleError(t,d))}f.addObj(h);k._setIsInsideTemplate(h);if(c=c.expressions.join(""))for(g=n.parseOptions(c),m=0,p=g.length;m<p;m+=1)c=q.getBindingOptions(d,g[m],h,null),e=d.bind(c),c.target=null,f.addObj(e)}});return f};e.prototype._bindElements=function(b,d,e,f){var g=this,h=g.global,l=t.DATA_ATTR.DATA_FORM;b=b||h.document;var h=this._getAllBindableHtmlElements(b),p=new c.LifeTimeScope;e||h.forEach(function(a){!a.dataForm&&k._isDataForm(a.el)&&(a.el.setAttribute(l,"yes"),a.dataForm="yes")});var v=
h.filter(function(a,b,c){return!!a.dataForm}).map(function(a,b,c){return a.el});h.forEach(function(c){var e="",h,m,l;if(!k._isInNestedForm(b,v,c.el)){try{h=g.getElementView(c.el)}catch(r){a.reThrow(r,g.handleError(r,g))}p.addObj(h);f&&k._setIsInsideTemplate(h);if(e=c.expressions.join(""))for(c=n.parseOptions(e),m=0,l=c.length;m<l;m+=1)e=q.getBindingOptions(g,c[m],h,d),p.addObj(g.bind(e))}});return p};e.prototype._getInternal=function(){return this._internal};e.prototype.addOnStartUp=function(a,c,
e){this._addHandler("startup",a,c,e)};e.prototype.removeOnStartUp=function(a){this._removeHandler("startup",a)};e.prototype.getExports=function(){return this._exports};e.prototype.registerElView=function(b,c){var e="elvws."+b,f=this.global;if(f._getInternal().getObject(this,e))throw Error(g.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,b));f._getInternal().registerObject(this,e,c)};e.prototype.getElementView=function(a){var c=this._getElView(a);if(c)return c;c=this._getElementViewInfo(a);return this._createElementView(a,
c)};e.prototype.bind=function(a){return new q.Binding(a,this.appName)};e.prototype.registerConverter=function(b,c){var e="converters."+b;if(a.global._getInternal().getObject(this,e))throw Error(g.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,b));a.global._getInternal().registerObject(this,e,c)};e.prototype.getConverter=function(b){var c="converters."+b,e=a.global._getInternal().getObject(this,c);e||(e=a.global._getInternal().getObject(a.global,c));if(!e)throw Error(g.format(a.ERRS.ERR_CONVERTER_NOTREGISTERED,
b));return e};e.prototype.registerType=function(b,c){var e="types."+b;return a.global._getInternal().registerObject(this,e,c)};e.prototype.getType=function(b){b="types."+b;var c=a.global._getInternal().getObject(this,b);c||(c=a.global._getInternal().getObject(a.global,b));return c};e.prototype.registerObject=function(b,c){var e=this,f="objects."+b;c instanceof a.BaseObject&&c.addOnDestroyed(function(b,c){a.global._getInternal().removeObject(e,f)},e.uniqueID);var g=a.global._getInternal().registerObject(this,
f,c);0>this._objMaps.indexOf(g)&&this._objMaps.push(g)};e.prototype.getObject=function(b){b="objects."+b;return a.global._getInternal().getObject(this,b)};e.prototype.onStartUp=function(){};e.prototype.startUp=function(b){var c=this,e=function(){try{c._contentFactory.init(),c.onStartUp(),c.raiseEvent("startup",{}),b&&b.apply(c,[c]),c._setUpBindings()}catch(e){a.reThrow(e,this.handleError(e,this))}};try{if(b&&!g.check.isFunction(b))throw Error(a.ERRS.ERR_APP_SETUP_INVALID);a.global._getInternal().waitForNotLoading(e,
null)}catch(f){a.reThrow(f,c.handleError(f,c))}};e.prototype.loadTemplates=function(a){this.loadTemplatesAsync(function(){return g.performAjaxGet(a)})};e.prototype.loadTemplatesAsync=function(b){a.global._getInternal().loadTemplatesAsync(b,this)};e.prototype.registerTemplateLoader=function(b,c){a.global._getInternal().registerTemplateLoader(this.appName+"."+b,{fn_loader:c})};e.prototype.getTemplateLoader=function(b){var c=a.global._getInternal().getTemplateLoader(this.appName+"."+b);c||(c=a.global._getInternal().getTemplateLoader(b));
return c};e.prototype.registerTemplateGroup=function(b,c){var e=g.extend(!1,{fn_loader:null,url:null,names:null,app:this},c);a.global._getInternal().registerTemplateGroup(this.appName+"."+b,e)};e.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;try{this._contentFactory=null,a.global._getInternal().unregisterApp(this),this._destroyBindings(),this._cleanUpObjMaps(),this._exports={},this._modules={},this._elViewStore={},this._userCode={},this._viewModels={},this._options=
null}finally{h.prototype.destroy.call(this)}}};e.prototype.toString=function(){return"Application: "+this.appName};Object.defineProperty(e.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"contentFactory",{get:function(){return this._contentFactory},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"appName",{get:function(){return this._app_name},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"appRoot",{get:function(){return this._options&&this._options.application_root?this._options.application_root:this.global.document},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"modules",{get:function(){return this._modules},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"global",{get:function(){return a.global},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"UC",{get:function(){return this._userCode},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"VM",{get:function(){return this._viewModels},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"app",{get:function(){return this},enumerable:!0,configurable:!0});e._newInstanceNum=1;return e}(a.BaseObject);a.Application=l})(RIAPP||(RIAPP={}));
